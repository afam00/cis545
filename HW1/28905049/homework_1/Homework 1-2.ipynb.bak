{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "71f9648285154a1f83aecdeb478d2b32",
     "grade": false,
     "grade_id": "cell-42502a1a777fc9df",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "## Step 4: Data Wrangling\n",
    "\n",
    "Start off by connecting to the database (as above), import pandas as pd, and then load back your DataFrames: airlines, airports, routes and incidents (not counting flights, which will take forever to load) from SQL, using the syntax:\n",
    "\n",
    "```\n",
    "    dataframe = pd.read_sql_query('select * from table_name', engine)\n",
    "```"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "73a3a19203d3316e87cc6a9da42604b4",
     "grade": false,
     "grade_id": "cell-c45c3ee70a69bff5",
     "locked": false,
     "schema_version": 1,
     "solution": true
    }
   },
   "outputs": [],
   "source": [
    "import sqlite3\n",
    "import pandas as pd\n",
    "\n",
    "engine = sqlite3.connect('HW1_DB')\n",
    "\n",
    "# TODO: Re-load dataframes from SQL\n",
    "\n",
    "# YOUR CODE HERE\n",
    "airlines_df = pd.read_sql_query('select * from airlines', engine)\n",
    "airports_df = pd.read_sql_query('select * from airports', engine)\n",
    "routes_df = pd.read_sql_query('select * from routes', engine)\n",
    "incidents_df = pd.read_sql_query('select * from incidents', engine)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "818adb04f09d0ddfe9aa7afcf18d13f7",
     "grade": true,
     "grade_id": "cell-4381b9b80fed03c6",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "if 'index' in airlines_df.columns:\n",
    "    raise ValueError('SQL added an index column -- shouldn''t have that plus the Pandas index')\n",
    "    \n",
    "if 'index' in airports_df.columns:\n",
    "    raise ValueError('SQL added an index column -- shouldn''t have that plus the Pandas index')\n",
    "\n",
    "if 'index' in routes_df.columns:\n",
    "    raise ValueError('SQL added an index column -- shouldn''t have that plus the Pandas index')\n",
    "\n",
    "if 'index' in incidents_df.columns:\n",
    "    raise ValueError('SQL added an index column -- shouldn''t have that plus the Pandas index')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "e86d9c3835dbaddd2dacdffb54c65838",
     "grade": false,
     "grade_id": "cell-bac42d1fd7cfa2ac",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "## Step 4.1: Understanding our data\n",
    "\n",
    "Take a look at the details of our dataframes..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "873950ef3ef4d355954d0e801fd23a19",
     "grade": false,
     "grade_id": "cell-a3270d5d328db1c2",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 6048 entries, 0 to 6047\n",
      "Data columns (total 8 columns):\n",
      "airline_id          6048 non-null int64\n",
      "airline_name        6048 non-null object\n",
      "airline_alias       6048 non-null object\n",
      "airline_iata        6048 non-null object\n",
      "airline_icao        6048 non-null object\n",
      "airline_callsign    6048 non-null object\n",
      "country             6048 non-null object\n",
      "active              6048 non-null object\n",
      "dtypes: int64(1), object(7)\n",
      "memory usage: 378.1+ KB\n"
     ]
    }
   ],
   "source": [
    "airlines_df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "5f76f3efd32b6573b8c074bfcb1e7823",
     "grade": false,
     "grade_id": "cell-30245808d993ecb9",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>airline_id</th>\n",
       "      <th>airline_name</th>\n",
       "      <th>airline_alias</th>\n",
       "      <th>airline_iata</th>\n",
       "      <th>airline_icao</th>\n",
       "      <th>airline_callsign</th>\n",
       "      <th>country</th>\n",
       "      <th>active</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Private flight</td>\n",
       "      <td></td>\n",
       "      <td>-</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>135 Airways</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>GNL</td>\n",
       "      <td>GENERAL</td>\n",
       "      <td>United States</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>1Time Airline</td>\n",
       "      <td></td>\n",
       "      <td>1T</td>\n",
       "      <td>RNX</td>\n",
       "      <td>NEXTIME</td>\n",
       "      <td>South Africa</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>2 Sqn No 1 Elementary Flying Training School</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>WYT</td>\n",
       "      <td></td>\n",
       "      <td>United Kingdom</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>213 Flight Unit</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>TFU</td>\n",
       "      <td></td>\n",
       "      <td>Russia</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>223 Flight Unit State Airline</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>CHD</td>\n",
       "      <td>CHKALOVSK-AVIA</td>\n",
       "      <td>Russia</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>224th Flight Unit</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>TTF</td>\n",
       "      <td>CARGO UNIT</td>\n",
       "      <td>Russia</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>247 Jet Ltd</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>TWF</td>\n",
       "      <td>CLOUD RUNNER</td>\n",
       "      <td>United Kingdom</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>3D Aviation</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>SEC</td>\n",
       "      <td>SECUREX</td>\n",
       "      <td>United States</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>40-Mile Air</td>\n",
       "      <td></td>\n",
       "      <td>Q5</td>\n",
       "      <td>MLA</td>\n",
       "      <td>MILE-AIR</td>\n",
       "      <td>United States</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>11</td>\n",
       "      <td>4D Air</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>QRT</td>\n",
       "      <td>QUARTET</td>\n",
       "      <td>Thailand</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>12</td>\n",
       "      <td>611897 Alberta Limited</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>THD</td>\n",
       "      <td>DONUT</td>\n",
       "      <td>Canada</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>13</td>\n",
       "      <td>Ansett Australia</td>\n",
       "      <td></td>\n",
       "      <td>AN</td>\n",
       "      <td>AAA</td>\n",
       "      <td>ANSETT</td>\n",
       "      <td>Australia</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>14</td>\n",
       "      <td>Abacus International</td>\n",
       "      <td></td>\n",
       "      <td>1B</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Singapore</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>15</td>\n",
       "      <td>Abelag Aviation</td>\n",
       "      <td></td>\n",
       "      <td>W9</td>\n",
       "      <td>AAB</td>\n",
       "      <td>ABG</td>\n",
       "      <td>Belgium</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>16</td>\n",
       "      <td>Army Air Corps</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>AAC</td>\n",
       "      <td>ARMYAIR</td>\n",
       "      <td>United Kingdom</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>17</td>\n",
       "      <td>Aero Aviation Centre Ltd.</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>AAD</td>\n",
       "      <td>SUNRISE</td>\n",
       "      <td>Canada</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>18</td>\n",
       "      <td>Aero Servicios Ejecutivos Internacionales</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>SII</td>\n",
       "      <td>ASEISA</td>\n",
       "      <td>Mexico</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>19</td>\n",
       "      <td>Aero Biniza</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>BZS</td>\n",
       "      <td>BINIZA</td>\n",
       "      <td>Mexico</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>20</td>\n",
       "      <td>Aero Albatros</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>ABM</td>\n",
       "      <td>ALBATROS ESPANA</td>\n",
       "      <td>Spain</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>21</td>\n",
       "      <td>Aigle Azur</td>\n",
       "      <td></td>\n",
       "      <td>ZI</td>\n",
       "      <td>AAF</td>\n",
       "      <td>AIGLE AZUR</td>\n",
       "      <td>France</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>22</td>\n",
       "      <td>Aloha Airlines</td>\n",
       "      <td></td>\n",
       "      <td>AQ</td>\n",
       "      <td>AAH</td>\n",
       "      <td>ALOHA</td>\n",
       "      <td>United States</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>23</td>\n",
       "      <td>Alaska Island Air</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>AAK</td>\n",
       "      <td>ALASKA ISLAND</td>\n",
       "      <td>United States</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>24</td>\n",
       "      <td>American Airlines</td>\n",
       "      <td></td>\n",
       "      <td>AA</td>\n",
       "      <td>AAL</td>\n",
       "      <td>AMERICAN</td>\n",
       "      <td>United States</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>25</td>\n",
       "      <td>Aviation Management Corporation</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>AAM</td>\n",
       "      <td>AM CORP</td>\n",
       "      <td>United States</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>26</td>\n",
       "      <td>Atlantis Airlines (USA)</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>AAO</td>\n",
       "      <td>ATLANTIS AIR</td>\n",
       "      <td>United States</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>27</td>\n",
       "      <td>Aerovista Airlines</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>AAP</td>\n",
       "      <td>AEROVISTA GROUP</td>\n",
       "      <td>United Arab Emirates</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>28</td>\n",
       "      <td>Asiana Airlines</td>\n",
       "      <td></td>\n",
       "      <td>OZ</td>\n",
       "      <td>AAR</td>\n",
       "      <td>ASIANA</td>\n",
       "      <td>Republic of Korea</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>29</td>\n",
       "      <td>Askari Aviation</td>\n",
       "      <td></td>\n",
       "      <td>4K</td>\n",
       "      <td>AAS</td>\n",
       "      <td>AL-AAS</td>\n",
       "      <td>Pakistan</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>30</td>\n",
       "      <td>Australia Asia Airlines</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>AAU</td>\n",
       "      <td>AUSTASIA</td>\n",
       "      <td>Australia</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6018</th>\n",
       "      <td>19651</td>\n",
       "      <td>CARICOM AIRWAYS (BARBADOS) INC.</td>\n",
       "      <td>CARICOM AIRWAYS</td>\n",
       "      <td></td>\n",
       "      <td>CCB</td>\n",
       "      <td></td>\n",
       "      <td>Barbados</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6019</th>\n",
       "      <td>19674</td>\n",
       "      <td>Rainbow Air (RAI)</td>\n",
       "      <td>Rainbow Air (RAI)</td>\n",
       "      <td>RN</td>\n",
       "      <td>RAB</td>\n",
       "      <td>Rainbow</td>\n",
       "      <td>United States</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6020</th>\n",
       "      <td>19675</td>\n",
       "      <td>Rainbow Air Canada</td>\n",
       "      <td>Rainbow Air CAN</td>\n",
       "      <td>RY</td>\n",
       "      <td>RAY</td>\n",
       "      <td>Rainbow CAN</td>\n",
       "      <td>Canada</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6021</th>\n",
       "      <td>19676</td>\n",
       "      <td>Rainbow Air Polynesia</td>\n",
       "      <td>Rainbow Air POL</td>\n",
       "      <td>RX</td>\n",
       "      <td>RPO</td>\n",
       "      <td>Rainbow Air</td>\n",
       "      <td>United States</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6022</th>\n",
       "      <td>19677</td>\n",
       "      <td>Rainbow Air Euro</td>\n",
       "      <td>Rainbow Air EU</td>\n",
       "      <td>RU</td>\n",
       "      <td>RUE</td>\n",
       "      <td>Rainbow Air</td>\n",
       "      <td>United Kingdom</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6023</th>\n",
       "      <td>19678</td>\n",
       "      <td>Rainbow Air US</td>\n",
       "      <td>Rainbow Air US</td>\n",
       "      <td>RM</td>\n",
       "      <td>RNY</td>\n",
       "      <td>Rainbow Air</td>\n",
       "      <td>United States</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6024</th>\n",
       "      <td>19745</td>\n",
       "      <td>Transilvania</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>TNS</td>\n",
       "      <td></td>\n",
       "      <td>Romania</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6025</th>\n",
       "      <td>19751</td>\n",
       "      <td>Dobrolet</td>\n",
       "      <td>Добролёт</td>\n",
       "      <td>QD</td>\n",
       "      <td>DOB</td>\n",
       "      <td>DOBROLET</td>\n",
       "      <td>Russia</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6026</th>\n",
       "      <td>19774</td>\n",
       "      <td>Spike Airlines</td>\n",
       "      <td>Aero Spike</td>\n",
       "      <td>S0</td>\n",
       "      <td>SAL</td>\n",
       "      <td>Spike Air</td>\n",
       "      <td>United States</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6027</th>\n",
       "      <td>19776</td>\n",
       "      <td>Grand Cru Airlines</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>GCA</td>\n",
       "      <td></td>\n",
       "      <td>Lithuania</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6028</th>\n",
       "      <td>19785</td>\n",
       "      <td>Go2Sky</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>RLX</td>\n",
       "      <td>RELAX</td>\n",
       "      <td>Slovakia</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6029</th>\n",
       "      <td>19803</td>\n",
       "      <td>All Argentina</td>\n",
       "      <td>All Argentina</td>\n",
       "      <td>L1</td>\n",
       "      <td>AL1</td>\n",
       "      <td></td>\n",
       "      <td>Argentina</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6030</th>\n",
       "      <td>19804</td>\n",
       "      <td>All America</td>\n",
       "      <td>All America</td>\n",
       "      <td>A2</td>\n",
       "      <td>AL2</td>\n",
       "      <td></td>\n",
       "      <td>United States</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6031</th>\n",
       "      <td>19805</td>\n",
       "      <td>All Asia</td>\n",
       "      <td>All Asia</td>\n",
       "      <td>L9</td>\n",
       "      <td>AL3</td>\n",
       "      <td></td>\n",
       "      <td>China</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6032</th>\n",
       "      <td>19806</td>\n",
       "      <td>All Africa</td>\n",
       "      <td>All Africa</td>\n",
       "      <td>9A</td>\n",
       "      <td>99F</td>\n",
       "      <td></td>\n",
       "      <td>South Africa</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6033</th>\n",
       "      <td>19807</td>\n",
       "      <td>Regionalia México</td>\n",
       "      <td>Regionalia México</td>\n",
       "      <td>N4</td>\n",
       "      <td>J88</td>\n",
       "      <td></td>\n",
       "      <td>Mexico</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6034</th>\n",
       "      <td>19808</td>\n",
       "      <td>All Europe</td>\n",
       "      <td>All Europe</td>\n",
       "      <td>N9</td>\n",
       "      <td>N99</td>\n",
       "      <td></td>\n",
       "      <td>United Kingdom</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6035</th>\n",
       "      <td>19809</td>\n",
       "      <td>All Spain</td>\n",
       "      <td>All Spain</td>\n",
       "      <td>N7</td>\n",
       "      <td>N77</td>\n",
       "      <td></td>\n",
       "      <td>Spain</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6036</th>\n",
       "      <td>19810</td>\n",
       "      <td>Regional Air Iceland</td>\n",
       "      <td>Regional Air Iceland</td>\n",
       "      <td>9N</td>\n",
       "      <td>N78</td>\n",
       "      <td></td>\n",
       "      <td>Iceland</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6037</th>\n",
       "      <td>19811</td>\n",
       "      <td>British Air Ferries</td>\n",
       "      <td></td>\n",
       "      <td>??</td>\n",
       "      <td>??!</td>\n",
       "      <td></td>\n",
       "      <td>United Kingdom</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6038</th>\n",
       "      <td>19812</td>\n",
       "      <td>Voestar</td>\n",
       "      <td>Voestar Brasil</td>\n",
       "      <td>8K</td>\n",
       "      <td>K88</td>\n",
       "      <td></td>\n",
       "      <td>Brazil</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6039</th>\n",
       "      <td>19813</td>\n",
       "      <td>All Colombia</td>\n",
       "      <td>All Colombia</td>\n",
       "      <td>7O</td>\n",
       "      <td>7KK</td>\n",
       "      <td></td>\n",
       "      <td>Colombia</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6040</th>\n",
       "      <td>19814</td>\n",
       "      <td>Regionalia Uruguay</td>\n",
       "      <td>Regionalia Uruguay</td>\n",
       "      <td>2X</td>\n",
       "      <td>2K2</td>\n",
       "      <td></td>\n",
       "      <td>Uruguay</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6041</th>\n",
       "      <td>19815</td>\n",
       "      <td>Regionalia Venezuela</td>\n",
       "      <td>Regionalia Venezuela</td>\n",
       "      <td>9X</td>\n",
       "      <td>9XX</td>\n",
       "      <td></td>\n",
       "      <td>Venezuela</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6042</th>\n",
       "      <td>19827</td>\n",
       "      <td>Regionalia Chile</td>\n",
       "      <td>Regionalia Chile</td>\n",
       "      <td>9J</td>\n",
       "      <td>CR1</td>\n",
       "      <td></td>\n",
       "      <td>Chile</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6043</th>\n",
       "      <td>19828</td>\n",
       "      <td>Vuela Cuba</td>\n",
       "      <td>Vuela Cuba</td>\n",
       "      <td>6C</td>\n",
       "      <td>6CC</td>\n",
       "      <td></td>\n",
       "      <td>Cuba</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6044</th>\n",
       "      <td>19830</td>\n",
       "      <td>All Australia</td>\n",
       "      <td>All Australia</td>\n",
       "      <td>88</td>\n",
       "      <td>8K8</td>\n",
       "      <td></td>\n",
       "      <td>Australia</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6045</th>\n",
       "      <td>19831</td>\n",
       "      <td>Fly Europa</td>\n",
       "      <td></td>\n",
       "      <td>ER</td>\n",
       "      <td>RWW</td>\n",
       "      <td></td>\n",
       "      <td>Spain</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6046</th>\n",
       "      <td>19834</td>\n",
       "      <td>FlyPortugal</td>\n",
       "      <td></td>\n",
       "      <td>PO</td>\n",
       "      <td>FPT</td>\n",
       "      <td>FlyPortugal</td>\n",
       "      <td>Portugal</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6047</th>\n",
       "      <td>19845</td>\n",
       "      <td>FTI Fluggesellschaft</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>FTI</td>\n",
       "      <td></td>\n",
       "      <td>Germany</td>\n",
       "      <td>N</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6048 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      airline_id                                  airline_name  \\\n",
       "0              1                                Private flight   \n",
       "1              2                                   135 Airways   \n",
       "2              3                                 1Time Airline   \n",
       "3              4  2 Sqn No 1 Elementary Flying Training School   \n",
       "4              5                               213 Flight Unit   \n",
       "5              6                 223 Flight Unit State Airline   \n",
       "6              7                             224th Flight Unit   \n",
       "7              8                                   247 Jet Ltd   \n",
       "8              9                                   3D Aviation   \n",
       "9             10                                   40-Mile Air   \n",
       "10            11                                        4D Air   \n",
       "11            12                        611897 Alberta Limited   \n",
       "12            13                              Ansett Australia   \n",
       "13            14                          Abacus International   \n",
       "14            15                               Abelag Aviation   \n",
       "15            16                                Army Air Corps   \n",
       "16            17                     Aero Aviation Centre Ltd.   \n",
       "17            18     Aero Servicios Ejecutivos Internacionales   \n",
       "18            19                                   Aero Biniza   \n",
       "19            20                                 Aero Albatros   \n",
       "20            21                                    Aigle Azur   \n",
       "21            22                                Aloha Airlines   \n",
       "22            23                             Alaska Island Air   \n",
       "23            24                             American Airlines   \n",
       "24            25               Aviation Management Corporation   \n",
       "25            26                       Atlantis Airlines (USA)   \n",
       "26            27                            Aerovista Airlines   \n",
       "27            28                               Asiana Airlines   \n",
       "28            29                               Askari Aviation   \n",
       "29            30                       Australia Asia Airlines   \n",
       "...          ...                                           ...   \n",
       "6018       19651               CARICOM AIRWAYS (BARBADOS) INC.   \n",
       "6019       19674                             Rainbow Air (RAI)   \n",
       "6020       19675                            Rainbow Air Canada   \n",
       "6021       19676                         Rainbow Air Polynesia   \n",
       "6022       19677                              Rainbow Air Euro   \n",
       "6023       19678                                Rainbow Air US   \n",
       "6024       19745                                  Transilvania   \n",
       "6025       19751                                      Dobrolet   \n",
       "6026       19774                                Spike Airlines   \n",
       "6027       19776                            Grand Cru Airlines   \n",
       "6028       19785                                        Go2Sky   \n",
       "6029       19803                                 All Argentina   \n",
       "6030       19804                                   All America   \n",
       "6031       19805                                      All Asia   \n",
       "6032       19806                                    All Africa   \n",
       "6033       19807                             Regionalia México   \n",
       "6034       19808                                    All Europe   \n",
       "6035       19809                                     All Spain   \n",
       "6036       19810                          Regional Air Iceland   \n",
       "6037       19811                           British Air Ferries   \n",
       "6038       19812                                       Voestar   \n",
       "6039       19813                                  All Colombia   \n",
       "6040       19814                            Regionalia Uruguay   \n",
       "6041       19815                          Regionalia Venezuela   \n",
       "6042       19827                              Regionalia Chile   \n",
       "6043       19828                                    Vuela Cuba   \n",
       "6044       19830                                 All Australia   \n",
       "6045       19831                                    Fly Europa   \n",
       "6046       19834                                   FlyPortugal   \n",
       "6047       19845                          FTI Fluggesellschaft   \n",
       "\n",
       "             airline_alias airline_iata airline_icao airline_callsign  \\\n",
       "0                                     -                                 \n",
       "1                                                GNL          GENERAL   \n",
       "2                                    1T          RNX          NEXTIME   \n",
       "3                                                WYT                    \n",
       "4                                                TFU                    \n",
       "5                                                CHD   CHKALOVSK-AVIA   \n",
       "6                                                TTF       CARGO UNIT   \n",
       "7                                                TWF     CLOUD RUNNER   \n",
       "8                                                SEC          SECUREX   \n",
       "9                                    Q5          MLA         MILE-AIR   \n",
       "10                                               QRT          QUARTET   \n",
       "11                                               THD            DONUT   \n",
       "12                                   AN          AAA           ANSETT   \n",
       "13                                   1B                                 \n",
       "14                                   W9          AAB              ABG   \n",
       "15                                               AAC          ARMYAIR   \n",
       "16                                               AAD          SUNRISE   \n",
       "17                                               SII           ASEISA   \n",
       "18                                               BZS           BINIZA   \n",
       "19                                               ABM  ALBATROS ESPANA   \n",
       "20                                   ZI          AAF       AIGLE AZUR   \n",
       "21                                   AQ          AAH            ALOHA   \n",
       "22                                               AAK    ALASKA ISLAND   \n",
       "23                                   AA          AAL         AMERICAN   \n",
       "24                                               AAM          AM CORP   \n",
       "25                                               AAO     ATLANTIS AIR   \n",
       "26                                               AAP  AEROVISTA GROUP   \n",
       "27                                   OZ          AAR           ASIANA   \n",
       "28                                   4K          AAS           AL-AAS   \n",
       "29                                               AAU         AUSTASIA   \n",
       "...                    ...          ...          ...              ...   \n",
       "6018       CARICOM AIRWAYS                       CCB                    \n",
       "6019     Rainbow Air (RAI)           RN          RAB          Rainbow   \n",
       "6020       Rainbow Air CAN           RY          RAY      Rainbow CAN   \n",
       "6021       Rainbow Air POL           RX          RPO      Rainbow Air   \n",
       "6022        Rainbow Air EU           RU          RUE      Rainbow Air   \n",
       "6023        Rainbow Air US           RM          RNY      Rainbow Air   \n",
       "6024                                             TNS                    \n",
       "6025              Добролёт           QD          DOB         DOBROLET   \n",
       "6026            Aero Spike           S0          SAL        Spike Air   \n",
       "6027                                             GCA                    \n",
       "6028                                             RLX            RELAX   \n",
       "6029         All Argentina           L1          AL1                    \n",
       "6030           All America           A2          AL2                    \n",
       "6031              All Asia           L9          AL3                    \n",
       "6032            All Africa           9A          99F                    \n",
       "6033     Regionalia México           N4          J88                    \n",
       "6034            All Europe           N9          N99                    \n",
       "6035             All Spain           N7          N77                    \n",
       "6036  Regional Air Iceland           9N          N78                    \n",
       "6037                                 ??          ??!                    \n",
       "6038        Voestar Brasil           8K          K88                    \n",
       "6039          All Colombia           7O          7KK                    \n",
       "6040    Regionalia Uruguay           2X          2K2                    \n",
       "6041  Regionalia Venezuela           9X          9XX                    \n",
       "6042      Regionalia Chile           9J          CR1                    \n",
       "6043            Vuela Cuba           6C          6CC                    \n",
       "6044         All Australia           88          8K8                    \n",
       "6045                                 ER          RWW                    \n",
       "6046                                 PO          FPT      FlyPortugal   \n",
       "6047                                             FTI                    \n",
       "\n",
       "                   country active  \n",
       "0                               Y  \n",
       "1            United States      N  \n",
       "2             South Africa      Y  \n",
       "3           United Kingdom      N  \n",
       "4                   Russia      N  \n",
       "5                   Russia      N  \n",
       "6                   Russia      N  \n",
       "7           United Kingdom      N  \n",
       "8            United States      N  \n",
       "9            United States      Y  \n",
       "10                Thailand      N  \n",
       "11                  Canada      N  \n",
       "12               Australia      Y  \n",
       "13               Singapore      Y  \n",
       "14                 Belgium      N  \n",
       "15          United Kingdom      N  \n",
       "16                  Canada      N  \n",
       "17                  Mexico      N  \n",
       "18                  Mexico      N  \n",
       "19                   Spain      N  \n",
       "20                  France      Y  \n",
       "21           United States      Y  \n",
       "22           United States      N  \n",
       "23           United States      Y  \n",
       "24           United States      N  \n",
       "25           United States      N  \n",
       "26    United Arab Emirates      N  \n",
       "27       Republic of Korea      Y  \n",
       "28                Pakistan      Y  \n",
       "29               Australia      N  \n",
       "...                    ...    ...  \n",
       "6018              Barbados      Y  \n",
       "6019         United States      Y  \n",
       "6020                Canada      Y  \n",
       "6021         United States      Y  \n",
       "6022        United Kingdom      Y  \n",
       "6023         United States      Y  \n",
       "6024               Romania      Y  \n",
       "6025                Russia      Y  \n",
       "6026         United States      Y  \n",
       "6027             Lithuania      Y  \n",
       "6028              Slovakia      Y  \n",
       "6029             Argentina      Y  \n",
       "6030         United States      Y  \n",
       "6031                 China      Y  \n",
       "6032          South Africa      Y  \n",
       "6033                Mexico      Y  \n",
       "6034        United Kingdom      Y  \n",
       "6035                 Spain      Y  \n",
       "6036               Iceland      Y  \n",
       "6037        United Kingdom      N  \n",
       "6038                Brazil      Y  \n",
       "6039              Colombia      Y  \n",
       "6040               Uruguay      Y  \n",
       "6041             Venezuela      Y  \n",
       "6042                 Chile      Y  \n",
       "6043                  Cuba      Y  \n",
       "6044             Australia      Y  \n",
       "6045                 Spain      Y  \n",
       "6046              Portugal      Y  \n",
       "6047               Germany      N  \n",
       "\n",
       "[6048 rows x 8 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "airlines_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "8c38cc4a7966798527d4a4d63c1aaa64",
     "grade": false,
     "grade_id": "cell-37cc23218e101cd7",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>airline_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>6048.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>3844.729167</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>3945.495487</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>-1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>1512.750000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>3025.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>4543.250000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>19845.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         airline_id\n",
       "count   6048.000000\n",
       "mean    3844.729167\n",
       "std     3945.495487\n",
       "min       -1.000000\n",
       "25%     1512.750000\n",
       "50%     3025.500000\n",
       "75%     4543.250000\n",
       "max    19845.000000"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "airlines_df.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "3181d0fd495601c80c172f3b06d29cd2",
     "grade": false,
     "grade_id": "cell-6ae9e38349d14e34",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 8107 entries, 0 to 8106\n",
      "Data columns (total 12 columns):\n",
      "airport_id      8107 non-null int64\n",
      "airport_name    8107 non-null object\n",
      "city            8107 non-null object\n",
      "country         8107 non-null object\n",
      "iata            8107 non-null object\n",
      "icao            8107 non-null object\n",
      "lat             8107 non-null float64\n",
      "lon             8107 non-null float64\n",
      "alt             8107 non-null int64\n",
      "timezone        8107 non-null float64\n",
      "dst             8107 non-null object\n",
      "tz              8107 non-null object\n",
      "dtypes: float64(3), int64(2), object(7)\n",
      "memory usage: 760.1+ KB\n"
     ]
    }
   ],
   "source": [
    "airports_df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "9779a92a9b22dffd53f2b3859d85d656",
     "grade": false,
     "grade_id": "cell-32854dca8eda6e9f",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>airport_id</th>\n",
       "      <th>airport_name</th>\n",
       "      <th>city</th>\n",
       "      <th>country</th>\n",
       "      <th>iata</th>\n",
       "      <th>icao</th>\n",
       "      <th>lat</th>\n",
       "      <th>lon</th>\n",
       "      <th>alt</th>\n",
       "      <th>timezone</th>\n",
       "      <th>dst</th>\n",
       "      <th>tz</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Goroka</td>\n",
       "      <td>Goroka</td>\n",
       "      <td>Papua New Guinea</td>\n",
       "      <td>GKA</td>\n",
       "      <td>AYGA</td>\n",
       "      <td>-6.081689</td>\n",
       "      <td>145.391881</td>\n",
       "      <td>5282</td>\n",
       "      <td>10.0</td>\n",
       "      <td>U</td>\n",
       "      <td>Pacific/Port_Moresby</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Madang</td>\n",
       "      <td>Madang</td>\n",
       "      <td>Papua New Guinea</td>\n",
       "      <td>MAG</td>\n",
       "      <td>AYMD</td>\n",
       "      <td>-5.207083</td>\n",
       "      <td>145.788700</td>\n",
       "      <td>20</td>\n",
       "      <td>10.0</td>\n",
       "      <td>U</td>\n",
       "      <td>Pacific/Port_Moresby</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Mount Hagen</td>\n",
       "      <td>Mount Hagen</td>\n",
       "      <td>Papua New Guinea</td>\n",
       "      <td>HGU</td>\n",
       "      <td>AYMH</td>\n",
       "      <td>-5.826789</td>\n",
       "      <td>144.295861</td>\n",
       "      <td>5388</td>\n",
       "      <td>10.0</td>\n",
       "      <td>U</td>\n",
       "      <td>Pacific/Port_Moresby</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Nadzab</td>\n",
       "      <td>Nadzab</td>\n",
       "      <td>Papua New Guinea</td>\n",
       "      <td>LAE</td>\n",
       "      <td>AYNZ</td>\n",
       "      <td>-6.569828</td>\n",
       "      <td>146.726242</td>\n",
       "      <td>239</td>\n",
       "      <td>10.0</td>\n",
       "      <td>U</td>\n",
       "      <td>Pacific/Port_Moresby</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Port Moresby Jacksons Intl</td>\n",
       "      <td>Port Moresby</td>\n",
       "      <td>Papua New Guinea</td>\n",
       "      <td>POM</td>\n",
       "      <td>AYPY</td>\n",
       "      <td>-9.443383</td>\n",
       "      <td>147.220050</td>\n",
       "      <td>146</td>\n",
       "      <td>10.0</td>\n",
       "      <td>U</td>\n",
       "      <td>Pacific/Port_Moresby</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Wewak Intl</td>\n",
       "      <td>Wewak</td>\n",
       "      <td>Papua New Guinea</td>\n",
       "      <td>WWK</td>\n",
       "      <td>AYWK</td>\n",
       "      <td>-3.583828</td>\n",
       "      <td>143.669186</td>\n",
       "      <td>19</td>\n",
       "      <td>10.0</td>\n",
       "      <td>U</td>\n",
       "      <td>Pacific/Port_Moresby</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Narsarsuaq</td>\n",
       "      <td>Narssarssuaq</td>\n",
       "      <td>Greenland</td>\n",
       "      <td>UAK</td>\n",
       "      <td>BGBW</td>\n",
       "      <td>61.160517</td>\n",
       "      <td>-45.425978</td>\n",
       "      <td>112</td>\n",
       "      <td>-3.0</td>\n",
       "      <td>E</td>\n",
       "      <td>America/Godthab</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Nuuk</td>\n",
       "      <td>Godthaab</td>\n",
       "      <td>Greenland</td>\n",
       "      <td>GOH</td>\n",
       "      <td>BGGH</td>\n",
       "      <td>64.190922</td>\n",
       "      <td>-51.678064</td>\n",
       "      <td>283</td>\n",
       "      <td>-3.0</td>\n",
       "      <td>E</td>\n",
       "      <td>America/Godthab</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>Sondre Stromfjord</td>\n",
       "      <td>Sondrestrom</td>\n",
       "      <td>Greenland</td>\n",
       "      <td>SFJ</td>\n",
       "      <td>BGSF</td>\n",
       "      <td>67.016969</td>\n",
       "      <td>-50.689325</td>\n",
       "      <td>165</td>\n",
       "      <td>-3.0</td>\n",
       "      <td>E</td>\n",
       "      <td>America/Godthab</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Thule Air Base</td>\n",
       "      <td>Thule</td>\n",
       "      <td>Greenland</td>\n",
       "      <td>THU</td>\n",
       "      <td>BGTL</td>\n",
       "      <td>76.531203</td>\n",
       "      <td>-68.703161</td>\n",
       "      <td>251</td>\n",
       "      <td>-4.0</td>\n",
       "      <td>E</td>\n",
       "      <td>America/Thule</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>11</td>\n",
       "      <td>Akureyri</td>\n",
       "      <td>Akureyri</td>\n",
       "      <td>Iceland</td>\n",
       "      <td>AEY</td>\n",
       "      <td>BIAR</td>\n",
       "      <td>65.659994</td>\n",
       "      <td>-18.072703</td>\n",
       "      <td>6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Atlantic/Reykjavik</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>12</td>\n",
       "      <td>Egilsstadir</td>\n",
       "      <td>Egilsstadir</td>\n",
       "      <td>Iceland</td>\n",
       "      <td>EGS</td>\n",
       "      <td>BIEG</td>\n",
       "      <td>65.283333</td>\n",
       "      <td>-14.401389</td>\n",
       "      <td>76</td>\n",
       "      <td>0.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Atlantic/Reykjavik</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>13</td>\n",
       "      <td>Hornafjordur</td>\n",
       "      <td>Hofn</td>\n",
       "      <td>Iceland</td>\n",
       "      <td>HFN</td>\n",
       "      <td>BIHN</td>\n",
       "      <td>64.295556</td>\n",
       "      <td>-15.227222</td>\n",
       "      <td>24</td>\n",
       "      <td>0.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Atlantic/Reykjavik</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>14</td>\n",
       "      <td>Husavik</td>\n",
       "      <td>Husavik</td>\n",
       "      <td>Iceland</td>\n",
       "      <td>HZK</td>\n",
       "      <td>BIHU</td>\n",
       "      <td>65.952328</td>\n",
       "      <td>-17.425978</td>\n",
       "      <td>48</td>\n",
       "      <td>0.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Atlantic/Reykjavik</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>15</td>\n",
       "      <td>Isafjordur</td>\n",
       "      <td>Isafjordur</td>\n",
       "      <td>Iceland</td>\n",
       "      <td>IFJ</td>\n",
       "      <td>BIIS</td>\n",
       "      <td>66.058056</td>\n",
       "      <td>-23.135278</td>\n",
       "      <td>8</td>\n",
       "      <td>0.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Atlantic/Reykjavik</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>16</td>\n",
       "      <td>Keflavik International Airport</td>\n",
       "      <td>Keflavik</td>\n",
       "      <td>Iceland</td>\n",
       "      <td>KEF</td>\n",
       "      <td>BIKF</td>\n",
       "      <td>63.985000</td>\n",
       "      <td>-22.605556</td>\n",
       "      <td>171</td>\n",
       "      <td>0.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Atlantic/Reykjavik</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>17</td>\n",
       "      <td>Patreksfjordur</td>\n",
       "      <td>Patreksfjordur</td>\n",
       "      <td>Iceland</td>\n",
       "      <td>PFJ</td>\n",
       "      <td>BIPA</td>\n",
       "      <td>65.555833</td>\n",
       "      <td>-23.965000</td>\n",
       "      <td>11</td>\n",
       "      <td>0.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Atlantic/Reykjavik</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>18</td>\n",
       "      <td>Reykjavik</td>\n",
       "      <td>Reykjavik</td>\n",
       "      <td>Iceland</td>\n",
       "      <td>RKV</td>\n",
       "      <td>BIRK</td>\n",
       "      <td>64.130000</td>\n",
       "      <td>-21.940556</td>\n",
       "      <td>48</td>\n",
       "      <td>0.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Atlantic/Reykjavik</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>19</td>\n",
       "      <td>Siglufjordur</td>\n",
       "      <td>Siglufjordur</td>\n",
       "      <td>Iceland</td>\n",
       "      <td>SIJ</td>\n",
       "      <td>BISI</td>\n",
       "      <td>66.133333</td>\n",
       "      <td>-18.916667</td>\n",
       "      <td>10</td>\n",
       "      <td>0.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Atlantic/Reykjavik</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>20</td>\n",
       "      <td>Vestmannaeyjar</td>\n",
       "      <td>Vestmannaeyjar</td>\n",
       "      <td>Iceland</td>\n",
       "      <td>VEY</td>\n",
       "      <td>BIVM</td>\n",
       "      <td>63.424303</td>\n",
       "      <td>-20.278875</td>\n",
       "      <td>326</td>\n",
       "      <td>0.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Atlantic/Reykjavik</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>21</td>\n",
       "      <td>Sault Ste Marie</td>\n",
       "      <td>Sault Sainte Marie</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YAM</td>\n",
       "      <td>CYAM</td>\n",
       "      <td>46.485001</td>\n",
       "      <td>-84.509445</td>\n",
       "      <td>630</td>\n",
       "      <td>-5.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Toronto</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>22</td>\n",
       "      <td>Winnipeg St Andrews</td>\n",
       "      <td>Winnipeg</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YAV</td>\n",
       "      <td>CYAV</td>\n",
       "      <td>50.056389</td>\n",
       "      <td>-97.032500</td>\n",
       "      <td>760</td>\n",
       "      <td>-6.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Winnipeg</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>23</td>\n",
       "      <td>Shearwater</td>\n",
       "      <td>Halifax</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YAW</td>\n",
       "      <td>CYAW</td>\n",
       "      <td>44.639721</td>\n",
       "      <td>-63.499444</td>\n",
       "      <td>167</td>\n",
       "      <td>-4.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Halifax</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>24</td>\n",
       "      <td>St Anthony</td>\n",
       "      <td>St. Anthony</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YAY</td>\n",
       "      <td>CYAY</td>\n",
       "      <td>51.391944</td>\n",
       "      <td>-56.083056</td>\n",
       "      <td>108</td>\n",
       "      <td>-3.5</td>\n",
       "      <td>A</td>\n",
       "      <td>America/St_Johns</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>25</td>\n",
       "      <td>Tofino</td>\n",
       "      <td>Tofino</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YAZ</td>\n",
       "      <td>CYAZ</td>\n",
       "      <td>49.082222</td>\n",
       "      <td>-125.772500</td>\n",
       "      <td>80</td>\n",
       "      <td>-8.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Vancouver</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>26</td>\n",
       "      <td>Kugaaruk</td>\n",
       "      <td>Pelly Bay</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YBB</td>\n",
       "      <td>CYBB</td>\n",
       "      <td>68.534444</td>\n",
       "      <td>-89.808056</td>\n",
       "      <td>56</td>\n",
       "      <td>-7.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Edmonton</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>27</td>\n",
       "      <td>Baie Comeau</td>\n",
       "      <td>Baie Comeau</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YBC</td>\n",
       "      <td>CYBC</td>\n",
       "      <td>49.132500</td>\n",
       "      <td>-68.204444</td>\n",
       "      <td>71</td>\n",
       "      <td>-5.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Toronto</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>28</td>\n",
       "      <td>Bagotville</td>\n",
       "      <td>Bagotville</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YBG</td>\n",
       "      <td>CYBG</td>\n",
       "      <td>48.330555</td>\n",
       "      <td>-70.996391</td>\n",
       "      <td>522</td>\n",
       "      <td>-5.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Toronto</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>29</td>\n",
       "      <td>Baker Lake</td>\n",
       "      <td>Baker Lake</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YBK</td>\n",
       "      <td>CYBK</td>\n",
       "      <td>64.298889</td>\n",
       "      <td>-96.077778</td>\n",
       "      <td>59</td>\n",
       "      <td>-6.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Winnipeg</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>30</td>\n",
       "      <td>Campbell River</td>\n",
       "      <td>Campbell River</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YBL</td>\n",
       "      <td>CYBL</td>\n",
       "      <td>49.950832</td>\n",
       "      <td>-125.270833</td>\n",
       "      <td>346</td>\n",
       "      <td>-8.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Vancouver</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8077</th>\n",
       "      <td>9512</td>\n",
       "      <td>Port of Seattle</td>\n",
       "      <td>Seattle</td>\n",
       "      <td>United States</td>\n",
       "      <td></td>\n",
       "      <td>PSEA</td>\n",
       "      <td>47.609178</td>\n",
       "      <td>-122.350605</td>\n",
       "      <td>0</td>\n",
       "      <td>-8.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Los_Angeles</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8078</th>\n",
       "      <td>9513</td>\n",
       "      <td>Ferry Terminal</td>\n",
       "      <td>Whittier</td>\n",
       "      <td>United States</td>\n",
       "      <td></td>\n",
       "      <td>WHIT</td>\n",
       "      <td>60.776566</td>\n",
       "      <td>-148.683367</td>\n",
       "      <td>0</td>\n",
       "      <td>-9.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Anchorage</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8079</th>\n",
       "      <td>9514</td>\n",
       "      <td>Ferry Terminal</td>\n",
       "      <td>Valdez</td>\n",
       "      <td>United States</td>\n",
       "      <td></td>\n",
       "      <td>VLDZ</td>\n",
       "      <td>61.123976</td>\n",
       "      <td>-146.365309</td>\n",
       "      <td>0</td>\n",
       "      <td>-9.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Anchorage</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8080</th>\n",
       "      <td>9515</td>\n",
       "      <td>Gare Routiere</td>\n",
       "      <td>Saint-Louis</td>\n",
       "      <td>Reunion</td>\n",
       "      <td></td>\n",
       "      <td>STLS</td>\n",
       "      <td>-21.289604</td>\n",
       "      <td>55.407269</td>\n",
       "      <td>103</td>\n",
       "      <td>4.0</td>\n",
       "      <td>E</td>\n",
       "      <td>Indian/Reunion</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8081</th>\n",
       "      <td>9516</td>\n",
       "      <td>Bus Stop</td>\n",
       "      <td>La Riviere</td>\n",
       "      <td>Reunion</td>\n",
       "      <td></td>\n",
       "      <td>LRIV</td>\n",
       "      <td>-21.272574</td>\n",
       "      <td>55.437706</td>\n",
       "      <td>190</td>\n",
       "      <td>4.0</td>\n",
       "      <td>E</td>\n",
       "      <td>Indian/Reunion</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8082</th>\n",
       "      <td>9517</td>\n",
       "      <td>Bus Stop</td>\n",
       "      <td>Cilaos</td>\n",
       "      <td>Reunion</td>\n",
       "      <td></td>\n",
       "      <td>CILS</td>\n",
       "      <td>-21.135518</td>\n",
       "      <td>55.472087</td>\n",
       "      <td>4000</td>\n",
       "      <td>4.0</td>\n",
       "      <td>E</td>\n",
       "      <td>Indian/Reunion</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8083</th>\n",
       "      <td>9518</td>\n",
       "      <td>Bus Stop</td>\n",
       "      <td>Hell-Bourg</td>\n",
       "      <td>Reunion</td>\n",
       "      <td></td>\n",
       "      <td>HLBG</td>\n",
       "      <td>-21.064020</td>\n",
       "      <td>55.518453</td>\n",
       "      <td>3000</td>\n",
       "      <td>4.0</td>\n",
       "      <td>E</td>\n",
       "      <td>Indian/Reunion</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8084</th>\n",
       "      <td>9519</td>\n",
       "      <td>Bus Stop</td>\n",
       "      <td>Salazie</td>\n",
       "      <td>Reunion</td>\n",
       "      <td></td>\n",
       "      <td>SLZI</td>\n",
       "      <td>-21.027485</td>\n",
       "      <td>55.538955</td>\n",
       "      <td>3000</td>\n",
       "      <td>4.0</td>\n",
       "      <td>E</td>\n",
       "      <td>Indian/Reunion</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8085</th>\n",
       "      <td>9520</td>\n",
       "      <td>Gare</td>\n",
       "      <td>St Andre</td>\n",
       "      <td>Reunion</td>\n",
       "      <td></td>\n",
       "      <td>ANDR</td>\n",
       "      <td>-20.963272</td>\n",
       "      <td>55.652508</td>\n",
       "      <td>100</td>\n",
       "      <td>4.0</td>\n",
       "      <td>E</td>\n",
       "      <td>Indian/Reunion</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8086</th>\n",
       "      <td>9521</td>\n",
       "      <td>L'Ocean Bus Terminal</td>\n",
       "      <td>Saint Denis</td>\n",
       "      <td>Reunion</td>\n",
       "      <td></td>\n",
       "      <td>SDNS</td>\n",
       "      <td>-20.877683</td>\n",
       "      <td>55.457393</td>\n",
       "      <td>0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>E</td>\n",
       "      <td>Indian/Reunion</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8087</th>\n",
       "      <td>9522</td>\n",
       "      <td>Gare Routiere</td>\n",
       "      <td>Saint Pierre</td>\n",
       "      <td>Reunion</td>\n",
       "      <td></td>\n",
       "      <td>STPR</td>\n",
       "      <td>-21.334240</td>\n",
       "      <td>55.471331</td>\n",
       "      <td>0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>E</td>\n",
       "      <td>Indian/Reunion</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8088</th>\n",
       "      <td>9523</td>\n",
       "      <td>Baie Ste Anne</td>\n",
       "      <td>Praslin</td>\n",
       "      <td>Seychelles</td>\n",
       "      <td></td>\n",
       "      <td>PLIN</td>\n",
       "      <td>-4.347119</td>\n",
       "      <td>55.765688</td>\n",
       "      <td>0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Indian/Mahe</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8089</th>\n",
       "      <td>9524</td>\n",
       "      <td>La Passe</td>\n",
       "      <td>La Digue</td>\n",
       "      <td>Seychelles</td>\n",
       "      <td></td>\n",
       "      <td>LADG</td>\n",
       "      <td>-4.347969</td>\n",
       "      <td>55.829069</td>\n",
       "      <td>0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Indian/Mahe</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8090</th>\n",
       "      <td>9525</td>\n",
       "      <td>Ferry Dock</td>\n",
       "      <td>Bainbridge Island</td>\n",
       "      <td>United States</td>\n",
       "      <td></td>\n",
       "      <td>BAIN</td>\n",
       "      <td>47.622237</td>\n",
       "      <td>-122.509362</td>\n",
       "      <td>0</td>\n",
       "      <td>-8.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Los_Angeles</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8091</th>\n",
       "      <td>9526</td>\n",
       "      <td>Bus</td>\n",
       "      <td>Phnom Penh</td>\n",
       "      <td>Cambodia</td>\n",
       "      <td></td>\n",
       "      <td>PNMP</td>\n",
       "      <td>11.561716</td>\n",
       "      <td>104.914276</td>\n",
       "      <td>0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Asia/Phnom_Penh</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8092</th>\n",
       "      <td>9527</td>\n",
       "      <td>Bus</td>\n",
       "      <td>Siem Reap</td>\n",
       "      <td>Cambodia</td>\n",
       "      <td></td>\n",
       "      <td>SMRP</td>\n",
       "      <td>13.361002</td>\n",
       "      <td>103.859543</td>\n",
       "      <td>0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Asia/Phnom_Penh</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8093</th>\n",
       "      <td>9528</td>\n",
       "      <td>Bus</td>\n",
       "      <td>Sihanoukville</td>\n",
       "      <td>Cambodia</td>\n",
       "      <td></td>\n",
       "      <td>SNKV</td>\n",
       "      <td>10.607220</td>\n",
       "      <td>103.524886</td>\n",
       "      <td>0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Asia/Phnom_Penh</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8094</th>\n",
       "      <td>9529</td>\n",
       "      <td>Bus</td>\n",
       "      <td>Kampot</td>\n",
       "      <td>Cambodia</td>\n",
       "      <td></td>\n",
       "      <td>KMPT</td>\n",
       "      <td>10.614922</td>\n",
       "      <td>104.177724</td>\n",
       "      <td>0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Asia/Phnom_Penh</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8095</th>\n",
       "      <td>9530</td>\n",
       "      <td>Bus</td>\n",
       "      <td>Kep</td>\n",
       "      <td>Cambodia</td>\n",
       "      <td></td>\n",
       "      <td>KEPC</td>\n",
       "      <td>10.480174</td>\n",
       "      <td>104.294228</td>\n",
       "      <td>0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Asia/Phnom_Penh</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8096</th>\n",
       "      <td>9531</td>\n",
       "      <td>Main Station</td>\n",
       "      <td>Taipei</td>\n",
       "      <td>Taiwan</td>\n",
       "      <td></td>\n",
       "      <td>TPEI</td>\n",
       "      <td>25.046176</td>\n",
       "      <td>121.517532</td>\n",
       "      <td>0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>N</td>\n",
       "      <td>Asia/Taipei</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8097</th>\n",
       "      <td>9532</td>\n",
       "      <td>Prominent Hill</td>\n",
       "      <td>Prominent Hill</td>\n",
       "      <td>Australia</td>\n",
       "      <td>PXH</td>\n",
       "      <td>YPMH</td>\n",
       "      <td>-29.716667</td>\n",
       "      <td>135.521667</td>\n",
       "      <td>734</td>\n",
       "      <td>9.5</td>\n",
       "      <td>O</td>\n",
       "      <td>Australia/Adelaide</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8098</th>\n",
       "      <td>9533</td>\n",
       "      <td>Chatsworth Station</td>\n",
       "      <td>Chatsworth</td>\n",
       "      <td>United States</td>\n",
       "      <td>CWT</td>\n",
       "      <td></td>\n",
       "      <td>34.256944</td>\n",
       "      <td>-118.598889</td>\n",
       "      <td>978</td>\n",
       "      <td>-8.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Los_Angeles</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8099</th>\n",
       "      <td>9534</td>\n",
       "      <td>Algerciras Port</td>\n",
       "      <td>Algerciras</td>\n",
       "      <td>Spain</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>36.136000</td>\n",
       "      <td>-5.435000</td>\n",
       "      <td>0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>E</td>\n",
       "      <td>Europe/Madrid</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8100</th>\n",
       "      <td>9535</td>\n",
       "      <td>Ganges Water Aerodrome</td>\n",
       "      <td>Ganges</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YGG</td>\n",
       "      <td></td>\n",
       "      <td>48.850000</td>\n",
       "      <td>-123.500000</td>\n",
       "      <td>0</td>\n",
       "      <td>-8.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Vancouver</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8101</th>\n",
       "      <td>9536</td>\n",
       "      <td>Pender Harbour Water Aerodrome</td>\n",
       "      <td>Pender Harbour</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YPT</td>\n",
       "      <td></td>\n",
       "      <td>49.616667</td>\n",
       "      <td>-124.016667</td>\n",
       "      <td>0</td>\n",
       "      <td>-8.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Vancouver</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8102</th>\n",
       "      <td>9537</td>\n",
       "      <td>Mansons Landing Water Aerodrome</td>\n",
       "      <td>Mansons Landing</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YMU</td>\n",
       "      <td></td>\n",
       "      <td>50.066667</td>\n",
       "      <td>-124.983333</td>\n",
       "      <td>0</td>\n",
       "      <td>-8.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Vancouver</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8103</th>\n",
       "      <td>9538</td>\n",
       "      <td>Port McNeill Airport</td>\n",
       "      <td>Port McNeill</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YMP</td>\n",
       "      <td></td>\n",
       "      <td>50.575556</td>\n",
       "      <td>-127.028611</td>\n",
       "      <td>225</td>\n",
       "      <td>-8.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Vancouver</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8104</th>\n",
       "      <td>9539</td>\n",
       "      <td>Sullivan Bay Water Aerodrome</td>\n",
       "      <td>Sullivan Bay</td>\n",
       "      <td>Canada</td>\n",
       "      <td>YTG</td>\n",
       "      <td></td>\n",
       "      <td>50.883333</td>\n",
       "      <td>-126.833333</td>\n",
       "      <td>0</td>\n",
       "      <td>-8.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Vancouver</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8105</th>\n",
       "      <td>9540</td>\n",
       "      <td>Deer Harbor Seaplane</td>\n",
       "      <td>Deer Harbor</td>\n",
       "      <td>United States</td>\n",
       "      <td>DHB</td>\n",
       "      <td></td>\n",
       "      <td>48.618397</td>\n",
       "      <td>-123.005960</td>\n",
       "      <td>0</td>\n",
       "      <td>-8.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Los_Angeles</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8106</th>\n",
       "      <td>9541</td>\n",
       "      <td>San Diego Old Town Transit Center</td>\n",
       "      <td>San Diego</td>\n",
       "      <td>United States</td>\n",
       "      <td>OLT</td>\n",
       "      <td></td>\n",
       "      <td>32.755200</td>\n",
       "      <td>-117.199500</td>\n",
       "      <td>0</td>\n",
       "      <td>-8.0</td>\n",
       "      <td>A</td>\n",
       "      <td>America/Los_Angeles</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8107 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      airport_id                       airport_name                city  \\\n",
       "0              1                             Goroka              Goroka   \n",
       "1              2                             Madang              Madang   \n",
       "2              3                        Mount Hagen         Mount Hagen   \n",
       "3              4                             Nadzab              Nadzab   \n",
       "4              5         Port Moresby Jacksons Intl        Port Moresby   \n",
       "5              6                         Wewak Intl               Wewak   \n",
       "6              7                         Narsarsuaq        Narssarssuaq   \n",
       "7              8                               Nuuk            Godthaab   \n",
       "8              9                  Sondre Stromfjord         Sondrestrom   \n",
       "9             10                     Thule Air Base               Thule   \n",
       "10            11                           Akureyri            Akureyri   \n",
       "11            12                        Egilsstadir         Egilsstadir   \n",
       "12            13                       Hornafjordur                Hofn   \n",
       "13            14                            Husavik             Husavik   \n",
       "14            15                         Isafjordur          Isafjordur   \n",
       "15            16     Keflavik International Airport            Keflavik   \n",
       "16            17                     Patreksfjordur      Patreksfjordur   \n",
       "17            18                          Reykjavik           Reykjavik   \n",
       "18            19                       Siglufjordur        Siglufjordur   \n",
       "19            20                     Vestmannaeyjar      Vestmannaeyjar   \n",
       "20            21                    Sault Ste Marie  Sault Sainte Marie   \n",
       "21            22                Winnipeg St Andrews            Winnipeg   \n",
       "22            23                         Shearwater             Halifax   \n",
       "23            24                         St Anthony         St. Anthony   \n",
       "24            25                             Tofino              Tofino   \n",
       "25            26                           Kugaaruk           Pelly Bay   \n",
       "26            27                        Baie Comeau         Baie Comeau   \n",
       "27            28                         Bagotville          Bagotville   \n",
       "28            29                         Baker Lake          Baker Lake   \n",
       "29            30                     Campbell River      Campbell River   \n",
       "...          ...                                ...                 ...   \n",
       "8077        9512                    Port of Seattle             Seattle   \n",
       "8078        9513                     Ferry Terminal            Whittier   \n",
       "8079        9514                     Ferry Terminal              Valdez   \n",
       "8080        9515                      Gare Routiere         Saint-Louis   \n",
       "8081        9516                           Bus Stop          La Riviere   \n",
       "8082        9517                           Bus Stop              Cilaos   \n",
       "8083        9518                           Bus Stop          Hell-Bourg   \n",
       "8084        9519                           Bus Stop             Salazie   \n",
       "8085        9520                               Gare            St Andre   \n",
       "8086        9521               L'Ocean Bus Terminal         Saint Denis   \n",
       "8087        9522                      Gare Routiere        Saint Pierre   \n",
       "8088        9523                      Baie Ste Anne             Praslin   \n",
       "8089        9524                           La Passe            La Digue   \n",
       "8090        9525                         Ferry Dock   Bainbridge Island   \n",
       "8091        9526                                Bus          Phnom Penh   \n",
       "8092        9527                                Bus           Siem Reap   \n",
       "8093        9528                                Bus       Sihanoukville   \n",
       "8094        9529                                Bus              Kampot   \n",
       "8095        9530                                Bus                 Kep   \n",
       "8096        9531                       Main Station              Taipei   \n",
       "8097        9532                     Prominent Hill      Prominent Hill   \n",
       "8098        9533                 Chatsworth Station          Chatsworth   \n",
       "8099        9534                    Algerciras Port          Algerciras   \n",
       "8100        9535             Ganges Water Aerodrome              Ganges   \n",
       "8101        9536     Pender Harbour Water Aerodrome      Pender Harbour   \n",
       "8102        9537    Mansons Landing Water Aerodrome     Mansons Landing   \n",
       "8103        9538               Port McNeill Airport        Port McNeill   \n",
       "8104        9539       Sullivan Bay Water Aerodrome        Sullivan Bay   \n",
       "8105        9540               Deer Harbor Seaplane         Deer Harbor   \n",
       "8106        9541  San Diego Old Town Transit Center           San Diego   \n",
       "\n",
       "               country iata  icao        lat         lon   alt  timezone dst  \\\n",
       "0     Papua New Guinea  GKA  AYGA  -6.081689  145.391881  5282      10.0   U   \n",
       "1     Papua New Guinea  MAG  AYMD  -5.207083  145.788700    20      10.0   U   \n",
       "2     Papua New Guinea  HGU  AYMH  -5.826789  144.295861  5388      10.0   U   \n",
       "3     Papua New Guinea  LAE  AYNZ  -6.569828  146.726242   239      10.0   U   \n",
       "4     Papua New Guinea  POM  AYPY  -9.443383  147.220050   146      10.0   U   \n",
       "5     Papua New Guinea  WWK  AYWK  -3.583828  143.669186    19      10.0   U   \n",
       "6            Greenland  UAK  BGBW  61.160517  -45.425978   112      -3.0   E   \n",
       "7            Greenland  GOH  BGGH  64.190922  -51.678064   283      -3.0   E   \n",
       "8            Greenland  SFJ  BGSF  67.016969  -50.689325   165      -3.0   E   \n",
       "9            Greenland  THU  BGTL  76.531203  -68.703161   251      -4.0   E   \n",
       "10             Iceland  AEY  BIAR  65.659994  -18.072703     6       0.0   N   \n",
       "11             Iceland  EGS  BIEG  65.283333  -14.401389    76       0.0   N   \n",
       "12             Iceland  HFN  BIHN  64.295556  -15.227222    24       0.0   N   \n",
       "13             Iceland  HZK  BIHU  65.952328  -17.425978    48       0.0   N   \n",
       "14             Iceland  IFJ  BIIS  66.058056  -23.135278     8       0.0   N   \n",
       "15             Iceland  KEF  BIKF  63.985000  -22.605556   171       0.0   N   \n",
       "16             Iceland  PFJ  BIPA  65.555833  -23.965000    11       0.0   N   \n",
       "17             Iceland  RKV  BIRK  64.130000  -21.940556    48       0.0   N   \n",
       "18             Iceland  SIJ  BISI  66.133333  -18.916667    10       0.0   N   \n",
       "19             Iceland  VEY  BIVM  63.424303  -20.278875   326       0.0   N   \n",
       "20              Canada  YAM  CYAM  46.485001  -84.509445   630      -5.0   A   \n",
       "21              Canada  YAV  CYAV  50.056389  -97.032500   760      -6.0   A   \n",
       "22              Canada  YAW  CYAW  44.639721  -63.499444   167      -4.0   A   \n",
       "23              Canada  YAY  CYAY  51.391944  -56.083056   108      -3.5   A   \n",
       "24              Canada  YAZ  CYAZ  49.082222 -125.772500    80      -8.0   A   \n",
       "25              Canada  YBB  CYBB  68.534444  -89.808056    56      -7.0   A   \n",
       "26              Canada  YBC  CYBC  49.132500  -68.204444    71      -5.0   A   \n",
       "27              Canada  YBG  CYBG  48.330555  -70.996391   522      -5.0   A   \n",
       "28              Canada  YBK  CYBK  64.298889  -96.077778    59      -6.0   A   \n",
       "29              Canada  YBL  CYBL  49.950832 -125.270833   346      -8.0   A   \n",
       "...                ...  ...   ...        ...         ...   ...       ...  ..   \n",
       "8077     United States       PSEA  47.609178 -122.350605     0      -8.0   A   \n",
       "8078     United States       WHIT  60.776566 -148.683367     0      -9.0   A   \n",
       "8079     United States       VLDZ  61.123976 -146.365309     0      -9.0   A   \n",
       "8080           Reunion       STLS -21.289604   55.407269   103       4.0   E   \n",
       "8081           Reunion       LRIV -21.272574   55.437706   190       4.0   E   \n",
       "8082           Reunion       CILS -21.135518   55.472087  4000       4.0   E   \n",
       "8083           Reunion       HLBG -21.064020   55.518453  3000       4.0   E   \n",
       "8084           Reunion       SLZI -21.027485   55.538955  3000       4.0   E   \n",
       "8085           Reunion       ANDR -20.963272   55.652508   100       4.0   E   \n",
       "8086           Reunion       SDNS -20.877683   55.457393     0       4.0   E   \n",
       "8087           Reunion       STPR -21.334240   55.471331     0       4.0   E   \n",
       "8088        Seychelles       PLIN  -4.347119   55.765688     0       4.0   N   \n",
       "8089        Seychelles       LADG  -4.347969   55.829069     0       4.0   N   \n",
       "8090     United States       BAIN  47.622237 -122.509362     0      -8.0   A   \n",
       "8091          Cambodia       PNMP  11.561716  104.914276     0       7.0   N   \n",
       "8092          Cambodia       SMRP  13.361002  103.859543     0       7.0   N   \n",
       "8093          Cambodia       SNKV  10.607220  103.524886     0       7.0   N   \n",
       "8094          Cambodia       KMPT  10.614922  104.177724     0       7.0   N   \n",
       "8095          Cambodia       KEPC  10.480174  104.294228     0       7.0   N   \n",
       "8096            Taiwan       TPEI  25.046176  121.517532     0       8.0   N   \n",
       "8097         Australia  PXH  YPMH -29.716667  135.521667   734       9.5   O   \n",
       "8098     United States  CWT        34.256944 -118.598889   978      -8.0   A   \n",
       "8099             Spain             36.136000   -5.435000     0       1.0   E   \n",
       "8100            Canada  YGG        48.850000 -123.500000     0      -8.0   A   \n",
       "8101            Canada  YPT        49.616667 -124.016667     0      -8.0   A   \n",
       "8102            Canada  YMU        50.066667 -124.983333     0      -8.0   A   \n",
       "8103            Canada  YMP        50.575556 -127.028611   225      -8.0   A   \n",
       "8104            Canada  YTG        50.883333 -126.833333     0      -8.0   A   \n",
       "8105     United States  DHB        48.618397 -123.005960     0      -8.0   A   \n",
       "8106     United States  OLT        32.755200 -117.199500     0      -8.0   A   \n",
       "\n",
       "                        tz  \n",
       "0     Pacific/Port_Moresby  \n",
       "1     Pacific/Port_Moresby  \n",
       "2     Pacific/Port_Moresby  \n",
       "3     Pacific/Port_Moresby  \n",
       "4     Pacific/Port_Moresby  \n",
       "5     Pacific/Port_Moresby  \n",
       "6          America/Godthab  \n",
       "7          America/Godthab  \n",
       "8          America/Godthab  \n",
       "9            America/Thule  \n",
       "10      Atlantic/Reykjavik  \n",
       "11      Atlantic/Reykjavik  \n",
       "12      Atlantic/Reykjavik  \n",
       "13      Atlantic/Reykjavik  \n",
       "14      Atlantic/Reykjavik  \n",
       "15      Atlantic/Reykjavik  \n",
       "16      Atlantic/Reykjavik  \n",
       "17      Atlantic/Reykjavik  \n",
       "18      Atlantic/Reykjavik  \n",
       "19      Atlantic/Reykjavik  \n",
       "20         America/Toronto  \n",
       "21        America/Winnipeg  \n",
       "22         America/Halifax  \n",
       "23        America/St_Johns  \n",
       "24       America/Vancouver  \n",
       "25        America/Edmonton  \n",
       "26         America/Toronto  \n",
       "27         America/Toronto  \n",
       "28        America/Winnipeg  \n",
       "29       America/Vancouver  \n",
       "...                    ...  \n",
       "8077   America/Los_Angeles  \n",
       "8078     America/Anchorage  \n",
       "8079     America/Anchorage  \n",
       "8080        Indian/Reunion  \n",
       "8081        Indian/Reunion  \n",
       "8082        Indian/Reunion  \n",
       "8083        Indian/Reunion  \n",
       "8084        Indian/Reunion  \n",
       "8085        Indian/Reunion  \n",
       "8086        Indian/Reunion  \n",
       "8087        Indian/Reunion  \n",
       "8088           Indian/Mahe  \n",
       "8089           Indian/Mahe  \n",
       "8090   America/Los_Angeles  \n",
       "8091       Asia/Phnom_Penh  \n",
       "8092       Asia/Phnom_Penh  \n",
       "8093       Asia/Phnom_Penh  \n",
       "8094       Asia/Phnom_Penh  \n",
       "8095       Asia/Phnom_Penh  \n",
       "8096           Asia/Taipei  \n",
       "8097    Australia/Adelaide  \n",
       "8098   America/Los_Angeles  \n",
       "8099         Europe/Madrid  \n",
       "8100     America/Vancouver  \n",
       "8101     America/Vancouver  \n",
       "8102     America/Vancouver  \n",
       "8103     America/Vancouver  \n",
       "8104     America/Vancouver  \n",
       "8105   America/Los_Angeles  \n",
       "8106   America/Los_Angeles  \n",
       "\n",
       "[8107 rows x 12 columns]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "airports_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "edbe279e4eaf27550f4eb3d311769095",
     "grade": false,
     "grade_id": "cell-e5196090092d563c",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>airport_id</th>\n",
       "      <th>lat</th>\n",
       "      <th>lon</th>\n",
       "      <th>alt</th>\n",
       "      <th>timezone</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>8107.000000</td>\n",
       "      <td>8107.000000</td>\n",
       "      <td>8107.000000</td>\n",
       "      <td>8107.000000</td>\n",
       "      <td>8107.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>4766.361046</td>\n",
       "      <td>26.817720</td>\n",
       "      <td>-3.921969</td>\n",
       "      <td>933.449365</td>\n",
       "      <td>0.169236</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>2943.205193</td>\n",
       "      <td>27.866953</td>\n",
       "      <td>85.900873</td>\n",
       "      <td>1624.740899</td>\n",
       "      <td>5.737326</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>-89.999997</td>\n",
       "      <td>-179.877000</td>\n",
       "      <td>-1266.000000</td>\n",
       "      <td>-12.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>2091.500000</td>\n",
       "      <td>8.824928</td>\n",
       "      <td>-79.022498</td>\n",
       "      <td>38.000000</td>\n",
       "      <td>-5.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>4257.000000</td>\n",
       "      <td>34.987800</td>\n",
       "      <td>5.292028</td>\n",
       "      <td>272.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>7508.500000</td>\n",
       "      <td>47.957599</td>\n",
       "      <td>49.785821</td>\n",
       "      <td>1020.000000</td>\n",
       "      <td>4.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>9541.000000</td>\n",
       "      <td>82.517778</td>\n",
       "      <td>179.951000</td>\n",
       "      <td>14472.000000</td>\n",
       "      <td>13.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        airport_id          lat          lon           alt     timezone\n",
       "count  8107.000000  8107.000000  8107.000000   8107.000000  8107.000000\n",
       "mean   4766.361046    26.817720    -3.921969    933.449365     0.169236\n",
       "std    2943.205193    27.866953    85.900873   1624.740899     5.737326\n",
       "min       1.000000   -89.999997  -179.877000  -1266.000000   -12.000000\n",
       "25%    2091.500000     8.824928   -79.022498     38.000000    -5.000000\n",
       "50%    4257.000000    34.987800     5.292028    272.000000     1.000000\n",
       "75%    7508.500000    47.957599    49.785821   1020.000000     4.000000\n",
       "max    9541.000000    82.517778   179.951000  14472.000000    13.000000"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "airports_df.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "a54ea773513509058fc8051004744326",
     "grade": false,
     "grade_id": "cell-48618264136ec94a",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 66548 entries, 0 to 66547\n",
      "Data columns (total 9 columns):\n",
      "airline_iata        66548 non-null object\n",
      "airline_id          66548 non-null int64\n",
      "src_iata_icao       66548 non-null object\n",
      "source_id           66548 non-null int64\n",
      "target_iata_icao    66548 non-null object\n",
      "target_id           66548 non-null int64\n",
      "code_share          66548 non-null object\n",
      "stops               66548 non-null int64\n",
      "equipment           66548 non-null object\n",
      "dtypes: int64(4), object(5)\n",
      "memory usage: 4.6+ MB\n"
     ]
    }
   ],
   "source": [
    "routes_df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "54ba6293cded542791688ac63c171767",
     "grade": false,
     "grade_id": "cell-27e3e47504b11e67",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>airline_iata</th>\n",
       "      <th>airline_id</th>\n",
       "      <th>src_iata_icao</th>\n",
       "      <th>source_id</th>\n",
       "      <th>target_iata_icao</th>\n",
       "      <th>target_id</th>\n",
       "      <th>code_share</th>\n",
       "      <th>stops</th>\n",
       "      <th>equipment</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>AER</td>\n",
       "      <td>2965</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>ASF</td>\n",
       "      <td>2966</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>ASF</td>\n",
       "      <td>2966</td>\n",
       "      <td>MRV</td>\n",
       "      <td>2962</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>CEK</td>\n",
       "      <td>2968</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>CEK</td>\n",
       "      <td>2968</td>\n",
       "      <td>OVB</td>\n",
       "      <td>4078</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>DME</td>\n",
       "      <td>4029</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>DME</td>\n",
       "      <td>4029</td>\n",
       "      <td>NBC</td>\n",
       "      <td>6969</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>DME</td>\n",
       "      <td>4029</td>\n",
       "      <td>UUA</td>\n",
       "      <td>6160</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>EGO</td>\n",
       "      <td>6156</td>\n",
       "      <td>KGD</td>\n",
       "      <td>2952</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>EGO</td>\n",
       "      <td>6156</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>GYD</td>\n",
       "      <td>2922</td>\n",
       "      <td>NBC</td>\n",
       "      <td>6969</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>KGD</td>\n",
       "      <td>2952</td>\n",
       "      <td>EGO</td>\n",
       "      <td>6156</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td>AER</td>\n",
       "      <td>2965</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td>ASF</td>\n",
       "      <td>2966</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td>CEK</td>\n",
       "      <td>2968</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td>DME</td>\n",
       "      <td>4029</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td>EGO</td>\n",
       "      <td>6156</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td>LED</td>\n",
       "      <td>2948</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td>SVX</td>\n",
       "      <td>2975</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>LED</td>\n",
       "      <td>2948</td>\n",
       "      <td>KZN</td>\n",
       "      <td>2990</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>LED</td>\n",
       "      <td>2948</td>\n",
       "      <td>NBC</td>\n",
       "      <td>6969</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>LED</td>\n",
       "      <td>2948</td>\n",
       "      <td>UUA</td>\n",
       "      <td>6160</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>MRV</td>\n",
       "      <td>2962</td>\n",
       "      <td>ASF</td>\n",
       "      <td>2966</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>NBC</td>\n",
       "      <td>6969</td>\n",
       "      <td>DME</td>\n",
       "      <td>4029</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>NBC</td>\n",
       "      <td>6969</td>\n",
       "      <td>GYD</td>\n",
       "      <td>2922</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>NBC</td>\n",
       "      <td>6969</td>\n",
       "      <td>LED</td>\n",
       "      <td>2948</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>NBC</td>\n",
       "      <td>6969</td>\n",
       "      <td>SVX</td>\n",
       "      <td>2975</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>NJC</td>\n",
       "      <td>2972</td>\n",
       "      <td>SVX</td>\n",
       "      <td>2975</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>NJC</td>\n",
       "      <td>2972</td>\n",
       "      <td>UUA</td>\n",
       "      <td>6160</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>2B</td>\n",
       "      <td>410</td>\n",
       "      <td>NUX</td>\n",
       "      <td>4364</td>\n",
       "      <td>SVX</td>\n",
       "      <td>2975</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CR2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66518</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>ABX</td>\n",
       "      <td>3333</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66519</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>ARM</td>\n",
       "      <td>4062</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66520</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>BHQ</td>\n",
       "      <td>6241</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66521</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>BHS</td>\n",
       "      <td>6249</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66522</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>BNK</td>\n",
       "      <td>4291</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66523</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>DBO</td>\n",
       "      <td>3358</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66524</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>GFF</td>\n",
       "      <td>6271</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66525</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>LSY</td>\n",
       "      <td>6287</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66526</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>MIM</td>\n",
       "      <td>6294</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66527</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>MQL</td>\n",
       "      <td>6298</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66528</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>MYA</td>\n",
       "      <td>6302</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66529</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>NRA</td>\n",
       "      <td>6307</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66530</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>NTL</td>\n",
       "      <td>4320</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66531</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>OAG</td>\n",
       "      <td>6793</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66532</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>PKE</td>\n",
       "      <td>6317</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66533</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>TRO</td>\n",
       "      <td>6794</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66534</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td>WGA</td>\n",
       "      <td>3363</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66535</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>TRO</td>\n",
       "      <td>6794</td>\n",
       "      <td>GFN</td>\n",
       "      <td>6792</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66536</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>TRO</td>\n",
       "      <td>6794</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66537</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>TSV</td>\n",
       "      <td>3330</td>\n",
       "      <td>ISA</td>\n",
       "      <td>3324</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66538</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>TSV</td>\n",
       "      <td>3330</td>\n",
       "      <td>WIN</td>\n",
       "      <td>6337</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66539</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>WGA</td>\n",
       "      <td>3363</td>\n",
       "      <td>MEL</td>\n",
       "      <td>3339</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66540</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>WGA</td>\n",
       "      <td>3363</td>\n",
       "      <td>SYD</td>\n",
       "      <td>3361</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66541</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>WIN</td>\n",
       "      <td>6337</td>\n",
       "      <td>LRE</td>\n",
       "      <td>6289</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66542</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>WIN</td>\n",
       "      <td>6337</td>\n",
       "      <td>TSV</td>\n",
       "      <td>3330</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66543</th>\n",
       "      <td>ZL</td>\n",
       "      <td>4178</td>\n",
       "      <td>WYA</td>\n",
       "      <td>6334</td>\n",
       "      <td>ADL</td>\n",
       "      <td>3341</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>SF3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66544</th>\n",
       "      <td>ZM</td>\n",
       "      <td>19016</td>\n",
       "      <td>DME</td>\n",
       "      <td>4029</td>\n",
       "      <td>FRU</td>\n",
       "      <td>2912</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>734</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66545</th>\n",
       "      <td>ZM</td>\n",
       "      <td>19016</td>\n",
       "      <td>FRU</td>\n",
       "      <td>2912</td>\n",
       "      <td>DME</td>\n",
       "      <td>4029</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>734</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66546</th>\n",
       "      <td>ZM</td>\n",
       "      <td>19016</td>\n",
       "      <td>FRU</td>\n",
       "      <td>2912</td>\n",
       "      <td>OSS</td>\n",
       "      <td>2913</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>734</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66547</th>\n",
       "      <td>ZM</td>\n",
       "      <td>19016</td>\n",
       "      <td>OSS</td>\n",
       "      <td>2913</td>\n",
       "      <td>FRU</td>\n",
       "      <td>2912</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>734</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>66548 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      airline_iata  airline_id src_iata_icao  source_id target_iata_icao  \\\n",
       "0               2B         410           AER       2965              KZN   \n",
       "1               2B         410           ASF       2966              KZN   \n",
       "2               2B         410           ASF       2966              MRV   \n",
       "3               2B         410           CEK       2968              KZN   \n",
       "4               2B         410           CEK       2968              OVB   \n",
       "5               2B         410           DME       4029              KZN   \n",
       "6               2B         410           DME       4029              NBC   \n",
       "7               2B         410           DME       4029              UUA   \n",
       "8               2B         410           EGO       6156              KGD   \n",
       "9               2B         410           EGO       6156              KZN   \n",
       "10              2B         410           GYD       2922              NBC   \n",
       "11              2B         410           KGD       2952              EGO   \n",
       "12              2B         410           KZN       2990              AER   \n",
       "13              2B         410           KZN       2990              ASF   \n",
       "14              2B         410           KZN       2990              CEK   \n",
       "15              2B         410           KZN       2990              DME   \n",
       "16              2B         410           KZN       2990              EGO   \n",
       "17              2B         410           KZN       2990              LED   \n",
       "18              2B         410           KZN       2990              SVX   \n",
       "19              2B         410           LED       2948              KZN   \n",
       "20              2B         410           LED       2948              NBC   \n",
       "21              2B         410           LED       2948              UUA   \n",
       "22              2B         410           MRV       2962              ASF   \n",
       "23              2B         410           NBC       6969              DME   \n",
       "24              2B         410           NBC       6969              GYD   \n",
       "25              2B         410           NBC       6969              LED   \n",
       "26              2B         410           NBC       6969              SVX   \n",
       "27              2B         410           NJC       2972              SVX   \n",
       "28              2B         410           NJC       2972              UUA   \n",
       "29              2B         410           NUX       4364              SVX   \n",
       "...            ...         ...           ...        ...              ...   \n",
       "66518           ZL        4178           SYD       3361              ABX   \n",
       "66519           ZL        4178           SYD       3361              ARM   \n",
       "66520           ZL        4178           SYD       3361              BHQ   \n",
       "66521           ZL        4178           SYD       3361              BHS   \n",
       "66522           ZL        4178           SYD       3361              BNK   \n",
       "66523           ZL        4178           SYD       3361              DBO   \n",
       "66524           ZL        4178           SYD       3361              GFF   \n",
       "66525           ZL        4178           SYD       3361              LSY   \n",
       "66526           ZL        4178           SYD       3361              MIM   \n",
       "66527           ZL        4178           SYD       3361              MQL   \n",
       "66528           ZL        4178           SYD       3361              MYA   \n",
       "66529           ZL        4178           SYD       3361              NRA   \n",
       "66530           ZL        4178           SYD       3361              NTL   \n",
       "66531           ZL        4178           SYD       3361              OAG   \n",
       "66532           ZL        4178           SYD       3361              PKE   \n",
       "66533           ZL        4178           SYD       3361              TRO   \n",
       "66534           ZL        4178           SYD       3361              WGA   \n",
       "66535           ZL        4178           TRO       6794              GFN   \n",
       "66536           ZL        4178           TRO       6794              SYD   \n",
       "66537           ZL        4178           TSV       3330              ISA   \n",
       "66538           ZL        4178           TSV       3330              WIN   \n",
       "66539           ZL        4178           WGA       3363              MEL   \n",
       "66540           ZL        4178           WGA       3363              SYD   \n",
       "66541           ZL        4178           WIN       6337              LRE   \n",
       "66542           ZL        4178           WIN       6337              TSV   \n",
       "66543           ZL        4178           WYA       6334              ADL   \n",
       "66544           ZM       19016           DME       4029              FRU   \n",
       "66545           ZM       19016           FRU       2912              DME   \n",
       "66546           ZM       19016           FRU       2912              OSS   \n",
       "66547           ZM       19016           OSS       2913              FRU   \n",
       "\n",
       "       target_id code_share  stops equipment  \n",
       "0           2990                 0       CR2  \n",
       "1           2990                 0       CR2  \n",
       "2           2962                 0       CR2  \n",
       "3           2990                 0       CR2  \n",
       "4           4078                 0       CR2  \n",
       "5           2990                 0       CR2  \n",
       "6           6969                 0       CR2  \n",
       "7           6160                 0       CR2  \n",
       "8           2952                 0       CR2  \n",
       "9           2990                 0       CR2  \n",
       "10          6969                 0       CR2  \n",
       "11          6156                 0       CR2  \n",
       "12          2965                 0       CR2  \n",
       "13          2966                 0       CR2  \n",
       "14          2968                 0       CR2  \n",
       "15          4029                 0       CR2  \n",
       "16          6156                 0       CR2  \n",
       "17          2948                 0       CR2  \n",
       "18          2975                 0       CR2  \n",
       "19          2990                 0       CR2  \n",
       "20          6969                 0       CR2  \n",
       "21          6160                 0       CR2  \n",
       "22          2966                 0       CR2  \n",
       "23          4029                 0       CR2  \n",
       "24          2922                 0       CR2  \n",
       "25          2948                 0       CR2  \n",
       "26          2975                 0       CR2  \n",
       "27          2975                 0       CR2  \n",
       "28          6160                 0       CR2  \n",
       "29          2975                 0       CR2  \n",
       "...          ...        ...    ...       ...  \n",
       "66518       3333                 0       SF3  \n",
       "66519       4062                 0       SF3  \n",
       "66520       6241                 0       SF3  \n",
       "66521       6249                 0       SF3  \n",
       "66522       4291                 0       SF3  \n",
       "66523       3358                 0       SF3  \n",
       "66524       6271                 0       SF3  \n",
       "66525       6287                 0       SF3  \n",
       "66526       6294                 0       SF3  \n",
       "66527       6298                 0       SF3  \n",
       "66528       6302                 0       SF3  \n",
       "66529       6307                 0       SF3  \n",
       "66530       4320                 0       SF3  \n",
       "66531       6793                 0       SF3  \n",
       "66532       6317                 0       SF3  \n",
       "66533       6794                 0       SF3  \n",
       "66534       3363                 0       SF3  \n",
       "66535       6792                 0       SF3  \n",
       "66536       3361                 0       SF3  \n",
       "66537       3324                 0       SF3  \n",
       "66538       6337                 0       SF3  \n",
       "66539       3339                 0       SF3  \n",
       "66540       3361                 0       SF3  \n",
       "66541       6289                 0       SF3  \n",
       "66542       3330                 0       SF3  \n",
       "66543       3341                 0       SF3  \n",
       "66544       2912                 0       734  \n",
       "66545       4029                 0       734  \n",
       "66546       2913                 0       734  \n",
       "66547       2912                 0       734  \n",
       "\n",
       "[66548 rows x 9 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "routes_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "d2cd50befd4ff9ffc9f7ee3a042ae040",
     "grade": false,
     "grade_id": "cell-ef6edc822d2e3cdd",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>airline_id</th>\n",
       "      <th>source_id</th>\n",
       "      <th>target_id</th>\n",
       "      <th>stops</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>66548.000000</td>\n",
       "      <td>66548.000000</td>\n",
       "      <td>66548.000000</td>\n",
       "      <td>66548.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>3367.569754</td>\n",
       "      <td>2660.201929</td>\n",
       "      <td>2662.088192</td>\n",
       "      <td>0.000165</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>3182.024330</td>\n",
       "      <td>1577.965637</td>\n",
       "      <td>1578.661433</td>\n",
       "      <td>0.012856</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>10.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>1317.000000</td>\n",
       "      <td>1382.000000</td>\n",
       "      <td>1382.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>2942.000000</td>\n",
       "      <td>2958.000000</td>\n",
       "      <td>2958.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>4608.000000</td>\n",
       "      <td>3670.000000</td>\n",
       "      <td>3670.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>19676.000000</td>\n",
       "      <td>9327.000000</td>\n",
       "      <td>9327.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         airline_id     source_id     target_id         stops\n",
       "count  66548.000000  66548.000000  66548.000000  66548.000000\n",
       "mean    3367.569754   2660.201929   2662.088192      0.000165\n",
       "std     3182.024330   1577.965637   1578.661433      0.012856\n",
       "min       10.000000      1.000000      1.000000      0.000000\n",
       "25%     1317.000000   1382.000000   1382.000000      0.000000\n",
       "50%     2942.000000   2958.000000   2958.000000      0.000000\n",
       "75%     4608.000000   3670.000000   3670.000000      0.000000\n",
       "max    19676.000000   9327.000000   9327.000000      1.000000"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "routes_df.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "65ec6e0684189cd59e523d6b826553f0",
     "grade": false,
     "grade_id": "cell-78f83d34a9a2b2f5",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 322 entries, 0 to 321\n",
      "Data columns (total 3 columns):\n",
      "Date         322 non-null object\n",
      "Airline      322 non-null object\n",
      "FlightNum    322 non-null object\n",
      "dtypes: object(3)\n",
      "memory usage: 7.6+ KB\n"
     ]
    }
   ],
   "source": [
    "incidents_df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "a04e1cd5cd56002da5c560ca7911c7dc",
     "grade": false,
     "grade_id": "cell-fdac57e7d2989f50",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>Airline</th>\n",
       "      <th>FlightNum</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1997-01-09 00:00:00</td>\n",
       "      <td>Comair</td>\n",
       "      <td>3272</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1997-03-18 00:00:00</td>\n",
       "      <td>Stavropolskaya Aktsionernaya Avia</td>\n",
       "      <td>1023</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1997-04-19 00:00:00</td>\n",
       "      <td>Merpati Nusantara Airlines</td>\n",
       "      <td>106</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1997-05-08 00:00:00</td>\n",
       "      <td>China Southern Airlines</td>\n",
       "      <td>3456</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1997-07-31 00:00:00</td>\n",
       "      <td>FedEx Express</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1997-07-17 00:00:00</td>\n",
       "      <td>Sempati Air</td>\n",
       "      <td>304</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1997-08-06 00:00:00</td>\n",
       "      <td>Korean Air</td>\n",
       "      <td>801</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1997-08-10 00:00:00</td>\n",
       "      <td>Formosa Airlines</td>\n",
       "      <td>7601</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>1997-09-03 00:00:00</td>\n",
       "      <td>Vietnam Airlines</td>\n",
       "      <td>815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1997-09-06 00:00:00</td>\n",
       "      <td>Royal Brunei Airlines</td>\n",
       "      <td>238</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1997-09-26 00:00:00</td>\n",
       "      <td>Garuda Indonesia</td>\n",
       "      <td>152</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>1997-10-10 00:00:00</td>\n",
       "      <td>Austral Líneas Aéreas</td>\n",
       "      <td>2553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>1997-12-15 00:00:00</td>\n",
       "      <td>Tajikistan Airlines</td>\n",
       "      <td>3183</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>1997-12-17 00:00:00</td>\n",
       "      <td>Aerosvit</td>\n",
       "      <td>241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>1997-12-19 00:00:00</td>\n",
       "      <td>SilkAir</td>\n",
       "      <td>185</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>1997-12-28 00:00:00</td>\n",
       "      <td>United Airlines</td>\n",
       "      <td>826</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>1998-02-02 00:00:00</td>\n",
       "      <td>Cebu Pacific</td>\n",
       "      <td>387</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>1998-02-16 00:00:00</td>\n",
       "      <td>China Airlines</td>\n",
       "      <td>676</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>1998-03-22 00:00:00</td>\n",
       "      <td>Philippine Airlines</td>\n",
       "      <td>137</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>1998-04-20 00:00:00</td>\n",
       "      <td>Air France</td>\n",
       "      <td>422</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>1998-05-25 00:00:00</td>\n",
       "      <td>PIA</td>\n",
       "      <td>544</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>1998-06-18 00:00:00</td>\n",
       "      <td>Propair</td>\n",
       "      <td>420</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>1998-07-30 00:00:00</td>\n",
       "      <td>Proteus Airlines</td>\n",
       "      <td>706</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1998-08-24 00:00:00</td>\n",
       "      <td>Myanma Airways</td>\n",
       "      <td>635</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>1998-08-29 00:00:00</td>\n",
       "      <td>Aviación</td>\n",
       "      <td>389</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>1998-09-02 00:00:00</td>\n",
       "      <td>Swissair</td>\n",
       "      <td>111</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>1998-09-25 00:00:00</td>\n",
       "      <td>PauknAir</td>\n",
       "      <td>4101</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>1998-09-29 00:00:00</td>\n",
       "      <td>Lionair</td>\n",
       "      <td>602</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>1998-12-11 00:00:00</td>\n",
       "      <td>Thai Airways International</td>\n",
       "      <td>261</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>1999-02-24 00:00:00</td>\n",
       "      <td>China Southwest Airlines</td>\n",
       "      <td>4509</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>292</th>\n",
       "      <td>2015-09-05 00:00:00</td>\n",
       "      <td>Ceiba Intercontinental Airlines</td>\n",
       "      <td>71</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>293</th>\n",
       "      <td>2015-09-08 00:00:00</td>\n",
       "      <td>British Airways</td>\n",
       "      <td>2276</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>294</th>\n",
       "      <td>2015-10-02 00:00:00</td>\n",
       "      <td>Aviastar</td>\n",
       "      <td>7503</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>295</th>\n",
       "      <td>2015-10-29 00:00:00</td>\n",
       "      <td>Dynamic Airways</td>\n",
       "      <td>405</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>296</th>\n",
       "      <td>2015-10-31 00:00:00</td>\n",
       "      <td>Metrojet</td>\n",
       "      <td>9268</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>297</th>\n",
       "      <td>2016-01-08 00:00:00</td>\n",
       "      <td>West Air Sweden</td>\n",
       "      <td>294</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>298</th>\n",
       "      <td>2016-02-02 00:00:00</td>\n",
       "      <td>Daallo Airlines</td>\n",
       "      <td>159</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>299</th>\n",
       "      <td>2016-02-24 00:00:00</td>\n",
       "      <td>Tara Air</td>\n",
       "      <td>193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>300</th>\n",
       "      <td>2016-03-19 00:00:00</td>\n",
       "      <td>Flydubai</td>\n",
       "      <td>981</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>301</th>\n",
       "      <td>2016-03-29 00:00:00</td>\n",
       "      <td>EgyptAir</td>\n",
       "      <td>181</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>302</th>\n",
       "      <td>2016-04-04 00:00:00</td>\n",
       "      <td>Batik Air</td>\n",
       "      <td>7703</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>303</th>\n",
       "      <td>2016-05-19 00:00:00</td>\n",
       "      <td>EgyptAir</td>\n",
       "      <td>804</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>304</th>\n",
       "      <td>2016-05-27 00:00:00</td>\n",
       "      <td>Korean Air</td>\n",
       "      <td>2708</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>305</th>\n",
       "      <td>2016-06-27 00:00:00</td>\n",
       "      <td>Singapore Airlines</td>\n",
       "      <td>368</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306</th>\n",
       "      <td>2016-08-03 00:00:00</td>\n",
       "      <td>Emirates</td>\n",
       "      <td>521</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>307</th>\n",
       "      <td>2016-08-05 00:00:00</td>\n",
       "      <td>ASL Airlines Hungary</td>\n",
       "      <td>7332</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>308</th>\n",
       "      <td>2016-08-27 00:00:00</td>\n",
       "      <td>Southwest Airlines</td>\n",
       "      <td>3472</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>309</th>\n",
       "      <td>2016-10-28 00:00:00</td>\n",
       "      <td>American Airlines</td>\n",
       "      <td>383</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>310</th>\n",
       "      <td>2016-10-28 00:00:00</td>\n",
       "      <td>FedEx Express</td>\n",
       "      <td>910</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>311</th>\n",
       "      <td>2016-11-28 00:00:00</td>\n",
       "      <td>LaMia Airlines</td>\n",
       "      <td>2933</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>312</th>\n",
       "      <td>2016-12-07 00:00:00</td>\n",
       "      <td>Pakistan International Airlines</td>\n",
       "      <td>661</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>313</th>\n",
       "      <td>2016-12-20 00:00:00</td>\n",
       "      <td>Aerosucre</td>\n",
       "      <td>4544</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>314</th>\n",
       "      <td>2016-12-23 00:00:00</td>\n",
       "      <td>Afriqiyah Airways</td>\n",
       "      <td>209</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>315</th>\n",
       "      <td>2017-01-16 00:00:00</td>\n",
       "      <td>Turkish Airlines</td>\n",
       "      <td>6491</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>316</th>\n",
       "      <td>2017-03-28 00:00:00</td>\n",
       "      <td>Peruvian Airlines</td>\n",
       "      <td>112</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>317</th>\n",
       "      <td>2017-05-27 00:00:00</td>\n",
       "      <td>Summit Air</td>\n",
       "      <td>409</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>318</th>\n",
       "      <td>2017-07-07 00:00:00</td>\n",
       "      <td>Air Canada</td>\n",
       "      <td>759</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>319</th>\n",
       "      <td>2017-09-30 00:00:00</td>\n",
       "      <td>Air France</td>\n",
       "      <td>66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>320</th>\n",
       "      <td>2017-12-13 00:00:00</td>\n",
       "      <td>West Wind Aviation</td>\n",
       "      <td>280</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>321</th>\n",
       "      <td>2018-01-13 00:00:00</td>\n",
       "      <td>Pegasus Airlines</td>\n",
       "      <td>8622</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>322 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                    Date                            Airline FlightNum\n",
       "0    1997-01-09 00:00:00                             Comair      3272\n",
       "1    1997-03-18 00:00:00  Stavropolskaya Aktsionernaya Avia      1023\n",
       "2    1997-04-19 00:00:00         Merpati Nusantara Airlines       106\n",
       "3    1997-05-08 00:00:00            China Southern Airlines      3456\n",
       "4    1997-07-31 00:00:00                      FedEx Express        14\n",
       "5    1997-07-17 00:00:00                        Sempati Air       304\n",
       "6    1997-08-06 00:00:00                         Korean Air       801\n",
       "7    1997-08-10 00:00:00                   Formosa Airlines      7601\n",
       "8    1997-09-03 00:00:00                   Vietnam Airlines       815\n",
       "9    1997-09-06 00:00:00              Royal Brunei Airlines       238\n",
       "10   1997-09-26 00:00:00                   Garuda Indonesia       152\n",
       "11   1997-10-10 00:00:00              Austral Líneas Aéreas      2553\n",
       "12   1997-12-15 00:00:00                Tajikistan Airlines      3183\n",
       "13   1997-12-17 00:00:00                           Aerosvit       241\n",
       "14   1997-12-19 00:00:00                            SilkAir       185\n",
       "15   1997-12-28 00:00:00                    United Airlines       826\n",
       "16   1998-02-02 00:00:00                       Cebu Pacific       387\n",
       "17   1998-02-16 00:00:00                     China Airlines       676\n",
       "18   1998-03-22 00:00:00                Philippine Airlines       137\n",
       "19   1998-04-20 00:00:00                         Air France       422\n",
       "20   1998-05-25 00:00:00                                PIA       544\n",
       "21   1998-06-18 00:00:00                            Propair       420\n",
       "22   1998-07-30 00:00:00                   Proteus Airlines       706\n",
       "23   1998-08-24 00:00:00                     Myanma Airways       635\n",
       "24   1998-08-29 00:00:00                           Aviación       389\n",
       "25   1998-09-02 00:00:00                           Swissair       111\n",
       "26   1998-09-25 00:00:00                           PauknAir      4101\n",
       "27   1998-09-29 00:00:00                            Lionair       602\n",
       "28   1998-12-11 00:00:00         Thai Airways International       261\n",
       "29   1999-02-24 00:00:00           China Southwest Airlines      4509\n",
       "..                   ...                                ...       ...\n",
       "292  2015-09-05 00:00:00    Ceiba Intercontinental Airlines        71\n",
       "293  2015-09-08 00:00:00                    British Airways      2276\n",
       "294  2015-10-02 00:00:00                           Aviastar      7503\n",
       "295  2015-10-29 00:00:00                    Dynamic Airways       405\n",
       "296  2015-10-31 00:00:00                           Metrojet      9268\n",
       "297  2016-01-08 00:00:00                    West Air Sweden       294\n",
       "298  2016-02-02 00:00:00                    Daallo Airlines       159\n",
       "299  2016-02-24 00:00:00                           Tara Air       193\n",
       "300  2016-03-19 00:00:00                           Flydubai       981\n",
       "301  2016-03-29 00:00:00                           EgyptAir       181\n",
       "302  2016-04-04 00:00:00                          Batik Air      7703\n",
       "303  2016-05-19 00:00:00                           EgyptAir       804\n",
       "304  2016-05-27 00:00:00                         Korean Air      2708\n",
       "305  2016-06-27 00:00:00                 Singapore Airlines       368\n",
       "306  2016-08-03 00:00:00                           Emirates       521\n",
       "307  2016-08-05 00:00:00               ASL Airlines Hungary      7332\n",
       "308  2016-08-27 00:00:00                 Southwest Airlines      3472\n",
       "309  2016-10-28 00:00:00                  American Airlines       383\n",
       "310  2016-10-28 00:00:00                      FedEx Express       910\n",
       "311  2016-11-28 00:00:00                     LaMia Airlines      2933\n",
       "312  2016-12-07 00:00:00    Pakistan International Airlines       661\n",
       "313  2016-12-20 00:00:00                          Aerosucre      4544\n",
       "314  2016-12-23 00:00:00                  Afriqiyah Airways       209\n",
       "315  2017-01-16 00:00:00                   Turkish Airlines      6491\n",
       "316  2017-03-28 00:00:00                  Peruvian Airlines       112\n",
       "317  2017-05-27 00:00:00                         Summit Air       409\n",
       "318  2017-07-07 00:00:00                         Air Canada       759\n",
       "319  2017-09-30 00:00:00                         Air France        66\n",
       "320  2017-12-13 00:00:00                 West Wind Aviation       280\n",
       "321  2018-01-13 00:00:00                   Pegasus Airlines      8622\n",
       "\n",
       "[322 rows x 3 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "incidents_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "022be4fb200336540a8b5d60bb1a2dcf",
     "grade": false,
     "grade_id": "cell-0afe444d09ba7d44",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>Airline</th>\n",
       "      <th>FlightNum</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>322</td>\n",
       "      <td>322</td>\n",
       "      <td>322</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>309</td>\n",
       "      <td>237</td>\n",
       "      <td>302</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>2001-09-11 00:00:00</td>\n",
       "      <td>American Airlines</td>\n",
       "      <td>103</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>4</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                       Date            Airline FlightNum\n",
       "count                   322                322       322\n",
       "unique                  309                237       302\n",
       "top     2001-09-11 00:00:00  American Airlines       103\n",
       "freq                      4                  7         3"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "incidents_df.describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "e21a8afcddc6b1152f387bcb7dbe936e",
     "grade": false,
     "grade_id": "cell-c15e08eb5e3c4132",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "\n",
    "We would expect certain characteristics, such as every airport to have flights, and every airport to be a source and a destination. (Otherwise we’d have a situation where some airports pile up airplanes, and others have no planes!)\n",
    "\n",
    "Take a look at our data and compute:\n",
    "* How many airports are origins in a route?\n",
    "* How many airports are destinations in a route?\n",
    "* How many cities are in the list of airports?\n",
    "\n",
    "\n",
    "Output these in a dictionary called results with three keys: {'airports’: _, 'destinations': _, 'sources’: _}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "# YOUR CODE HERE\n",
    "nOrigins = len(routes_df['source_id'].unique()) # number of origin airports\n",
    "nDests = len(routes_df['target_id'].unique()) # number of destination airports\n",
    "nCities = len(airports_df['city'].unique()) # number of cities in airport list"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "00351130117bb379b41ce41616246ea7",
     "grade": true,
     "grade_id": "cell-24599a4a23496e35",
     "locked": false,
     "points": 0,
     "schema_version": 1,
     "solution": true
    }
   },
   "outputs": [],
   "source": [
    "# This is for any scratch work you'd like to do"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "# TODO: output dictionary results {‘airports’: ___, ‘destinations’: ___, ‘sources’: ___}\n",
    "\n",
    "# YOUR CODE HERE\n",
    "results = {\n",
    "  \"airports\": nCities,\n",
    "  \"destinations\": nDests,\n",
    "  \"origins\": nOrigins\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "65b0f236284f4f8bf77065285cc8be17",
     "grade": true,
     "grade_id": "cell-1a27dd951d5c02d5",
     "locked": true,
     "points": 2,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "if 'origins' not in results:\n",
    "    raise KeyError('Missing key ''origins'' from dictionary')\n",
    "    \n",
    "if 'destinations' not in results:\n",
    "    raise KeyError('Missing key ''origins'' from dictionary')\n",
    "\n",
    "if 'airports' not in results:\n",
    "    raise KeyError('Missing key ''origins'' from dictionary')\n",
    "\n",
    "### BEGIN HIDDEN TESTS\n",
    "if results['airports'] <= results['origins']:\n",
    "    raise ValueError('Unexpected that airports are all origins')\n",
    "\n",
    "if results['airports'] <= results['destinations']:\n",
    "    raise ValueError('Unexpected that airports are all destinations')  \n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "303fef20c218968982624277ef1d2b70",
     "grade": true,
     "grade_id": "cell-9b9513c14f308bbd",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Wrong number of airports",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-19-db78f33602a7>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;31m### BEGIN HIDDEN TESTS\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mresults\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'airports'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m!=\u001b[0m \u001b[0;36m8107\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m     \u001b[0;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'Wrong number of airports'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      4\u001b[0m \u001b[0;31m### END HIDDEN TESTS\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mValueError\u001b[0m: Wrong number of airports"
     ]
    }
   ],
   "source": [
    "### BEGIN HIDDEN TESTS\n",
    "if results['airports'] != 8107:\n",
    "    raise ValueError('Wrong number of airports')\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "7ec6176808759383e4417b85f3886d2f",
     "grade": true,
     "grade_id": "cell-d8e98706fcc495c5",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "### BEGIN HIDDEN TESTS\n",
    "if results['origins'] != 3167:\n",
    "    raise ValueError('Wrong number of origins')\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "1491278ba93be8062f82126c1a4da4a2",
     "grade": true,
     "grade_id": "cell-14a029a24d1efbed",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "### BEGIN HIDDEN TESTS\n",
    "if results['destinations'] != 3170:\n",
    "    raise ValueError('Wrong number of destinations')\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "e645374996c68c750d1c07f540c8980e",
     "grade": false,
     "grade_id": "cell-75270c5f77f61f7f",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "# 4.2 Looking at Joint Data\n",
    "\n",
    "Now let's combine information from the different sources!"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "411382f3a648be91266265f7840fdfaa",
     "grade": false,
     "grade_id": "cell-a1b27b8ca7d3fd49",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "## Step 4.2.1 Combining DataFrames via Merge (also known as Join)\n",
    "\n",
    "The first question is which airports are in the data as destinations, but not as sources.  Set the variable `flyable_df` to a dataframe containing the airports you can fly to, but not from.  Be sure to eliminate duplicates.\n",
    "\n",
    "You’ll need to do a merge (join) with the original `airports_df` DataFrame.  Note that `dataframe.merge()` can be called with a second DataFrame, as well as the columns to match (`left_on`, `right_on`)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "af8668159b765ff0f3fc16c837060c27",
     "grade": false,
     "grade_id": "cell-7ddb688c03c82bfa",
     "locked": false,
     "schema_version": 1,
     "solution": true
    }
   },
   "outputs": [],
   "source": [
    "# TODO: Compute airports you can fly to by not from, in the variable flyable_df\n",
    "\n",
    "# YOUR CODE HERE\n",
    "sources = routes_df['source_id'].to_frame()\n",
    "destinations = routes_df['target_id'].to_frame()\n",
    "flights = sources.merge(destinations,left_on='source_id',right_on='target_id',how='right')\n",
    "ind = pd.isnull(flights['source_id']) # find rows where there is only destination ID (source ID = NaN)\n",
    "flyable_df = flights['target_id']\n",
    "flyable_df = flyable_df[ind].to_frame().drop_duplicates()\n",
    "\n",
    "flyable_df = flyable_df.merge(airports_df, left_on='target_id', right_on='airport_id')\n",
    "# flyable_df = flyable_df[['airport_name']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "fe5e55a6de00a6de6ca2ff67e5eaadcd",
     "grade": true,
     "grade_id": "cell-f26ec8b22ff837fd",
     "locked": true,
     "points": 3,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "if not type(flyable_df) is pd.DataFrame:\n",
    "    raise ValueError(\"wrong variable type\")\n",
    "\n",
    "if not 'airport_name' in flyable_df.columns:\n",
    "    raise ValueError(\"wrong field name\")\n",
    "    \n",
    "### BEGIN HIDDEN TESTS\n",
    "if len(flyable_df) != 15:\n",
    "    raise ValueError(\"Don't have the expected number of entries\")\n",
    "    \n",
    "if flyable_df.duplicated().sum() != 0:\n",
    "    raise ValueError(\"You probably didn't remove duplicates\")\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "e5f5158464ff22574377f6ed7f81fe81",
     "grade": true,
     "grade_id": "cell-71bd83d12a248c81",
     "locked": true,
     "points": 2,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "### BEGIN HIDDEN TESTs\n",
    "if sum(list(flyable_df['airport_name'] == 'Punta Gorda Airport')) != 1:\n",
    "    raise ValueError(\"You probably lost an airport\")\n",
    "\n",
    "if sum(list(flyable_df['airport_name'] == 'El Porvenir')) != 1:\n",
    "    raise ValueError(\"You probably lost an airport\")\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "84c3bca689aea8ddfdee0d2d8c293658",
     "grade": false,
     "grade_id": "cell-8cba1318eb6277e5",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "## Step 4.2.2: Top-k Destinations\n",
    "\n",
    "Next let’s consider what destination airports are most-trafficked, by the airport's **city name**.  Recall that we have the frequencies of arrivals for each airport by its ID. You may also find the `.reset_index()` method useful.\n",
    "\n",
    "Collect the top-k elements into a dataframe called `topk`, with the city and count."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "#TODO: top 10 most popular airports\n",
    "\n",
    "# YOUR CODE HERE\n",
    "topk = routes_df['target_id'].value_counts().rename_axis('airport_id').reset_index(name='count')[0:10] # rename column used as index as 'airport_id', create column of number of values of each target_id named \"count\", & select first 10\n",
    "topk = topk.merge(airports_df, left_on='airport_id', right_on='airport_id') # merge based on 'airport_id' to get additional info\n",
    "\n",
    "topk = topk[['city','count']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "d30200d819e7a835c5ba6602375d3e3d",
     "grade": true,
     "grade_id": "cell-a3f932510b997079",
     "locked": true,
     "points": 5,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "if len(topk) != 10:\n",
    "    raise ValueError(\"unexpected number of entries\")\n",
    "\n",
    "### BEGIN HIDDEN TESTS\n",
    "if not ((topk.iloc[0]['city'] == 'Atlanta') & (topk.iloc[0]['count'] == 905)):\n",
    "    raise ValueError(\"The 1st most popular city is not correct(city or count)\")\n",
    "\n",
    "if not ((topk.iloc[9]['city'] == 'Amsterdam') & (topk.iloc[9]['count'] == 450)):\n",
    "    raise ValueError(\"The 10th most popular city is not correct(city or count)\")\n",
    "\n",
    "if not ((topk.iloc[4]['city'] == 'Paris') & (topk.iloc[4]['count'] == 517)):\n",
    "    raise ValueError(\"You probably got incorrect cities or counts\")\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "32b06463df6453efd92c4b3545df184a",
     "grade": false,
     "grade_id": "cell-94010b7112eab7f2",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "## Step 4.3: Visualizing the Data\n",
    "\n",
    "Let’s try to find out how “reliable” an airline is by comparing the number of flight routes it has and the number of incidents it has had in the last 20 years.  Look for airlines with **more than 2 incidents**.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>airline_iata</th>\n",
       "      <th>flight_count</th>\n",
       "      <th>airline</th>\n",
       "      <th>incident_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AA</td>\n",
       "      <td>2354</td>\n",
       "      <td>American Airlines</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>TK</td>\n",
       "      <td>652</td>\n",
       "      <td>Turkish Airlines</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>WN</td>\n",
       "      <td>1146</td>\n",
       "      <td>Southwest Airlines</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>QF</td>\n",
       "      <td>430</td>\n",
       "      <td>Qantas</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>MS</td>\n",
       "      <td>205</td>\n",
       "      <td>EgyptAir</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>AF</td>\n",
       "      <td>1071</td>\n",
       "      <td>Air France</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>BA</td>\n",
       "      <td>549</td>\n",
       "      <td>British Airways</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>CI</td>\n",
       "      <td>172</td>\n",
       "      <td>China Airlines</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>GA</td>\n",
       "      <td>248</td>\n",
       "      <td>Garuda Indonesia</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>UA</td>\n",
       "      <td>2180</td>\n",
       "      <td>United Airlines</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>OZ</td>\n",
       "      <td>524</td>\n",
       "      <td>Asiana Airlines</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>AH</td>\n",
       "      <td>228</td>\n",
       "      <td>Air Algerie</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   airline_iata  flight_count             airline  incident_count\n",
       "0            AA          2354   American Airlines               7\n",
       "1            TK           652    Turkish Airlines               6\n",
       "2            WN          1146  Southwest Airlines               5\n",
       "3            QF           430              Qantas               5\n",
       "4            MS           205            EgyptAir               5\n",
       "5            AF          1071          Air France               5\n",
       "6            BA           549     British Airways               4\n",
       "7            CI           172      China Airlines               4\n",
       "8            GA           248    Garuda Indonesia               3\n",
       "9            UA          2180     United Airlines               3\n",
       "10           OZ           524     Asiana Airlines               3\n",
       "11           AH           228         Air Algerie               3"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# TODO: Create dataframe of airline_iata, number of incidents, number of routes\n",
    "\n",
    "# YOUR CODE HERE\n",
    "# === calculate number of incidents & keep airlines with > 2 incidents ===\n",
    "pd.set_option('mode.chained_assignment', None) # turn off warning for SettingWithCopy\n",
    "inc = incidents_df['Airline'].value_counts().rename_axis('airline').reset_index(name='incident_count')\n",
    "inc = inc[inc['incident_count'] > 2] # keep airlines with more than 2 incidents\n",
    "inc['airline'][inc['airline']=='Air Algérie'] = 'Air Algerie' # replace accented letters\n",
    "inc['airline'][inc['airline']=='Aviación'] = 'Aviacion'\n",
    "inc['airline_lower'] = inc['airline'].str.lower() # use lower case to match airline names across tables (for handling cases like \"EgyptAir\"/\"Egyptair\")\n",
    "airlines_df['airline_name_lower'] = airlines_df['airline_name'].str.lower()\n",
    "inc_merged = inc.merge(airlines_df, left_on='airline_lower', right_on='airline_name_lower')\n",
    "\n",
    "# === calculate number of routes ===\n",
    "merged_df = routes_df.merge(airlines_df, left_on='airline_iata', right_on='airline_iata')\n",
    "nRoutes = merged_df['airline_iata'].value_counts().rename_axis('airline_iata').reset_index(name='flight_count')\n",
    "\n",
    "# === merge everything together ===\n",
    "merged_df = inc_merged.merge(nRoutes, left_on='airline_iata', right_on='airline_iata')\n",
    "merged_df\n",
    "\n",
    "# === remove lowercase col's ===\n",
    "del airlines_df['airline_name_lower']\n",
    "\n",
    "merged_df[['airline_iata','flight_count','airline','incident_count']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "049aae83880dcef652e897ebfba4f111",
     "grade": true,
     "grade_id": "cell-c9d1306dd6150498",
     "locked": true,
     "points": 5,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "incorrect number of incidents for some airlines",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-28-3bda880a6c18>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     10\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     11\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmerged_df\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mairline\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlower\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m'cubana de aviación'\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m&\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mmerged_df\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mincident_count\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;36m3\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0many\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 12\u001b[0;31m     \u001b[0;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"incorrect number of incidents for some airlines\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     13\u001b[0m \u001b[0;31m### END HIDDEN TESTS\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mValueError\u001b[0m: incorrect number of incidents for some airlines"
     ]
    }
   ],
   "source": [
    "if len(merged_df) != 12 & len(merged_df) != 11:\n",
    "    raise ValueError(\"unexpected number of entries\")\n",
    "\n",
    "### BEGIN HIDDEN TESTS\n",
    "if not ((merged_df.airline_iata.str.upper() == 'AA') & (merged_df.incident_count == 7)).any():\n",
    "    raise ValueError(\"incorrect number of flight counts for some airlines\")\n",
    "    \n",
    "if not ((merged_df.airline_iata.str.upper() == 'QF') & (merged_df.incident_count == 5)).any():\n",
    "    raise ValueError(\"incorrect number of incidents for some airlines\")\n",
    "\n",
    "if not ((merged_df.airline.str.lower() == 'cubana de aviación') & (merged_df.incident_count == 3)).any():\n",
    "    raise ValueError(\"incorrect number of incidents for some airlines\")\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "0651a12895fa896722b4cd81e7277f62",
     "grade": true,
     "grade_id": "cell-bbab0844db1fcc4a",
     "locked": false,
     "points": 5,
     "schema_version": 1,
     "solution": true
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYUAAAEKCAYAAAD9xUlFAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4wLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvqOYd8AAAIABJREFUeJzt3Xt8FeW97/HPl4AS8IIgbRVBqAJu6yVKFEHsLroRaz2C4j4bW7eXVj22oni8VJF9KrZa7dEqtruvtm7RqrWh2gOIl0KxeENQdyKRSwW5GISgCCpgJALG3/ljTZZJCMkCsrII+b5fr3mtmWeeeeY3k5X8MrdnFBGYmZkBtMl1AGZmtvtwUjAzszQnBTMzS3NSMDOzNCcFMzNLc1IwM7M0JwUzM0tzUjAzszQnBTMzS2ub6wB21IEHHhg9e/bMdRhmZi1KSUnJuojo2li9FpcUevbsSXFxca7DMDNrUSStyKSeTx+ZmVmak4KZWQszZcoUJLFo0aJa5ePHj6d9+/Zs2LBhp9t2UjAza2GKiooYNGgQRUVF25SfcMIJTJo0aafbdlIwM2tBKioqmDVrFhMmTGDixInp8mXLllFRUcFtt922TbLYEU4KZmYtyJNPPskZZ5xBnz596NKlCyUlJQBMnDiRkSNHcsopp7B48WLWrFmzU+1nLSlI6iuptMawUdI1depI0q8kLZU0T9Lx2YrHzGxPUFRUxMiRIwEYOXJk+qigurxNmzaMGDGCJ554Yqfaz9otqRGxGCgAkJQHlAOT61T7NtA7GfoDv00+zcwsMWVuOXdNX8zK9z6g/G/P8XpJKR32bktVVRWSuOiii1iyZAlDhgwBYMuWLfTq1YtRo0bt8Lqa6/TRacCyiKh7n+ww4JFIeRXoJOmgZorJzGy3N2VuOWMmzad8fSWfLn6FDkcOpsulDzB+8iusXLmSXr16MXr0aMaNG0dZWRllZWWsXr2a1atXs2JFRo8m1NJcSWEkUN+Vj27AyhrTq5IyMzMD7pq+mMqtVQB8+taLdOgzgMqtVdw1fTEAI0aM4J133uGcc86ptdw555xT60J0phQRux51QyuQ9gJWA9+IiDV15j0N3BkRs5LpvwM3RkRxnXqXA5cD9OjRo9/OZD8zs5ao103PUN9faQHv3PmdjNuRVBIRhY3Va44jhW8Db9RNCIlyoHuN6UOSsloi4v6IKIyIwq5dG+26w8xsj3Fwp/wdKt9VzZEUzqf+U0cAU4ELk7uQTgI2RMR7zRCTmVmLcMPQvuS3y6tVlt8ujxuG9s3K+rLaIZ6kjsAQ4H/VKLsCICJ+BzwLnAksBTYBl2QzHjOzlmb4canLrHdNX8zq9ZUc3CmfG4b2TZc3taxfU2hqhYWF4V5Szcx2zO50TcHMzFoIJwUzM0tzUjAzszQnBTMzS3NSMDOzNCcFMzNLc1IwM7M0JwUzM0tzUjAzszQnBTMzS3NSMDOzNCcFMzNLc1IwM7M0JwUzM0tzUjAzszQnBTMzS8tqUpDUSdJfJC2S9JakAXXmf0vSBkmlyfCTbMZjZmYNy+rrOIH7gGkRcZ6kvYAO9dR5OSLOynIcZmaWgawlBUn7A98ELgaIiC3Almytz8zMdl02Tx/1AtYCD0maK+kBSR3rqTdA0puS/irpG/U1JOlyScWSiteuXZvFkM3MWrdsJoW2wPHAbyPiOOBT4KY6dd4ADo2IY4FfA1Pqaygi7o+Iwogo7Nq1axZDNjNr3bKZFFYBqyLitWT6L6SSRFpEbIyIimT8WaCdpAOzGJOZmTUga0khIt4HVkrqmxSdBvyjZh1JX5OkZPzEJJ4PsxWTmZk1LNt3H10FPJbcebQcuETSFQAR8TvgPOCHkj4HKoGRERFZjsnMzLZDLe1vcGFhYRQXF+c6DDOzFkVSSUQUNlbPTzSbmVmak4KZmaU5KZiZWZqTgpmZpTkpmJlZmpOCmZmlOSmYmVmak4KZmaU5KZiZWZqTgpmZpTkpmJlZmpNCK/Xhhx9SUFBAQUEBX/va1+jWrVt6ukOHL9+a+uyzz9KnTx9WrFiRw2jNrLlku5dU20116dKF0tJSAMaNG8c+++zD9ddfD8A+++wDwN///neuvvpqpk+fzqGHHpqzWM2s+TgpWL1eeuklLrvsMp599lkOO+ywXIdjZs3EScG2sXnzZoYPH84LL7zAEUccketwzKwZZfWagqROkv4iaZGktyQNqDNfkn4laamkeZKO315b1nzatWvHwIEDmTBhQq5DMbNmlu0LzfcB0yLiCOBY4K06878N9E6Gy4HfZjmeVm/K3HJOvnMmvW56hpPvnMmUueXb1GnTpg2PP/44r7/+Oj//+c9zEKWZ5UrWkoKk/YFvAhMAImJLRKyvU20Y8EikvAp0knRQtmJq7abMLWfMpPmUr68kgPL1lYyZNJ9F723cpm6HDh145plneOyxx3zEYNaKZPNIoRewFnhI0lxJD0jqWKdON2BljelVSZllwV3TF1O5tapWWeXWKl5Z9mG99Tt37sy0adO47bbbmDp1anOEaGY5ls0LzW2B44GrIuI1SfcBNwH/Z0cbknQ5qdNL9OjRo0mDbE1Wr6+st7xt4f/k+uu/k56uqKhIj3fv3p133nkn67GZ2e6h0SMFSaMl7ZdcFJ4g6Q1Jp2fQ9ipgVUS8lkz/hVSSqKkc6F5j+pCkrJaIuD8iCiOisGvXrhms2upzcKf8HSo3s9Ynk9NH34+IjcDpwAHAvwN3NrZQRLwPrJTUNyk6DfhHnWpTgQuThHMSsCEi3ss4etshNwztS367vFpl+e3yuGFo3+0sYWatTSanj5R8ngk8GhELJamhBWq4CnhM0l7AcuASSVcARMTvgGeTdpcCm4BLdiR42zHDj0tdrrlr+mJWr6/k4E753DC0b7rczEwR0XAF6SFSF397kbqtNA94ISL6ZT+8bRUWFkZxcXEuVm1m1mJJKomIwsbqZXKk8AOgAFgeEZskdcH/0ZuZ7ZEyuaYwIyLeqH7GICI+BO7NblhmZpYL2z1SkNQe6AAcKOkAvry2sB9+lsDMbI/U0Omj/wVcAxwMlPBlUtgI/GeW4zIzsxzYblKIiPuA+yRdFRG/bsaYzMwsRxq90BwRv5Y0EOhZs35EPJLFuMzMLAcaTQqSHgUOA0qB6o5zAnBSMDPbw2RyS2ohcGQ09kCDmZm1eJnckroA+Fq2AzEzs9zL5EjhQOAfkl4HNlcXRsTZWYvKzMxyIpOkMC7bQZiZ2e4hk7uPXpR0KNA7Ip6T1IFU/0dmZraHyeR9CpeRehfC75OibsCUbAZlZma5kcmF5iuBk0k9yUxELAG+ks2gzMwsNzJJCpsjYkv1hKS2pJ5TMDOzPUwmSeFFSTcD+ZKGAE8AT2U3LDMzy4VMksJNwFpgPqlO8p4F/iOTxiWVSZovqVTSNm/GkfQtSRuS+aWSfrIjwZuZWdPK5O6jL4D/SoadMTgi1jUw/+WIOGsn2zYzsybU0PsU5tPAtYOIOCYrEZmZWc40dKRQ/d/7lcnno8nnBWR+oTmAv0kK4PcRcX89dQZIehNYDVwfEQszbNvMzJpYQ+9TWAEgaUhEHFdj1o2S3iB1raExgyKiXNJXgBmSFkXESzXmvwEcGhEVks4k9fxD77qNSLocuBygR48eGazWzMx2RiYXmiXp5BoTAzNcjogoTz4/ACYDJ9aZvzEiKpLxZ4F2kg6sp537I6IwIgq7du2ayarNzGwnZNL30Q+AByXtT+qVnB8D329sIUkdgTYR8Ukyfjrw0zp1vgasiYiQdCKpZPPhDm6DmZk1kUzuPioBjk2SAhGxIcO2vwpMllS9nj9FxDRJVyTt/A44D/ihpM+BSmCk39tgZpY7Dd19dEFE/FHStXXKAYiIexpqOCKWA8fWU/67GuP/CfznDsZsZmZZ0tCRQsfkc9/mCMTMzHKvobuPfp983tp84ZiZWS5l0nX2w5I61Zg+QNKD2Q3LzMxyIZNbS4+JiPXVExHxMXBcA/XNzKyFyiQptJF0QPWEpM5kdiurmZm1MJn8cf8lMEfSE6SeUzgPuD2rUZmZWU5k8pzCI5JKgMFJ0bkR8Y/shmVmZrmQ6WmgRaSeZG4LIKlHRLybtajMzCwnGk0Kkq4CbgHWAFWkTiEF4K6zzcz2MJkcKYwG+kaE+yQyM9vDZXL30Uog0/6OzMysBcskKSwHXpA0RtK11UO2A2tOkrjgggvS059//jldu3blrLNS7xlas2YNZ511FsceeyxHHnkkZ555ZpOuf9WqVQwbNozevXvz9a9/nVGjRrF582ZeeOEF9t9/fwoKCigoKOBf/uVfmnS9rc2UKVOQxKJFiwAoKysjPz8/vX8LCgq4+uqrGT9+fHqZoUOHcumll6anr7vuOu655x4k8etf/zpdPmrUKP7whz8027aYZUsmSeFdYAawF6l+kKqHPUbHjh1ZsGABlZWVAMyYMYNu3bql5//kJz9hyJAhvPnmm/zjH//gzjvvbLJ1RwTnnnsuw4cPZ8mSJSxZsoTKykp+/OMfA3DKKadQWlpKaWkpzz33XJOttzUqKipi0KBBFBUVpcsOO+yw9P4tLS3lm9/8JrNnzwbgiy++YN26dSxc+OXLAGfPns3AgQP5yle+wn333ceWLVuafTvMsqnRpBARt9Y3NEdwzenMM8/kmWeeAVJ/PM4///z0vPfee49DDjkkPX3MMU13jX3mzJm0b9+eSy65BIC8vDzuvfdeHnnkESoqKppsPa1dRUUFs2bNYsKECUycOHG79QYOHMicOXMAWLhwIUcddRT77rsvH3/8MZs3b+att96ic+fOdO3aldNOO42HH364uTbBrFlsNylIGp98PiVpat2h+UJsHiNHjmTixIl89tlnzJs3j/79+6fnXXnllfzgBz9g8ODB3H777axevbrJ1rtw4UL69etXq2y//fajZ8+eLF26lJdffjl9auP22/3M4M568sknOeOMM+jTpw9dunShpKQEgGXLlqX375VXXsnBBx9M27Zteffdd5k9ezYDBgygf//+zJkzh+LiYo4++mj22msvAG688UbuvvtuqqqqcrlpZk2qobuPHk0+797ZxiWVAZ+QupX184gorDNfwH3AmcAm4OKIeGNn17crjjnmGMrKyigqKtrmmsHQoUNZvnw506ZN469//SvHHXccCxYsoDleDXrKKafw9NNPZ309e7qioiJGjx4NpP4BKCoqYtSoUenTRzUNHDiQ2bNnM3v2bK699lrKy8uZPXs2+++/PyefnH4zLV//+tfp378/f/rTn5p1W8yyqaGus0uSzxd3cR2DI2LdduZ9G+idDP2B3yafWTdlbjl3TV/M6vWVVG6tYsrccs4++2yuv/56XnjhBT78sPYduJ07d+a73/0u3/3udznrrLN46aWXGDFixC6vu8O6zfDGnFrzN27cyPvvv0/fvn19HWEXVO/nle99QPnfnuP1klI67N2WqqoqJHHllVfWqrd6fSUHd8rnqB7fYPbs2cyfP5+jjjqK7t2788tf/pL99tsvfZqv2s0338x5553HP//zP+diE82aXCYXmrNpGPBIpLwKdJJ0ULZXOmVuOWMmzad8fSUBRMCYSfM5+MRvc8stt3D00UfXqj9z5kw2bdoEwCeffMKyZcvo0aNHk6y7oss/sfz9jxj9s/sAqKqq4rrrrmPUqFHk5+fvyma2ajX386eLX6HDkYPpcukDjJ/8CitXrqRXr16sXLmSjZ99XuvnUb6+kr+t25/HJz1J586dycvLo3Pnzqxfv545c+YwcODAWus54ogjOPLII3nqqadys6FmTSzbSSGAv0kqkXR5PfO7kXoOotqqpCyr7pq+mMqttc8DV26t4qHST7j66qu3qV9SUkJhYSHHHHMMAwYM4NJLL+WEE05oknVLosvwm3m06M/07t2bLl260KZNG8aOHbtT7VtKzf386Vsv0qHPACq3VnHX9MUAjBgxgjvuuIN1FZu3+S58cUB31q1bx0knnZQuO/roo9l///058MADt1nX2LFjWbVqVRa3xqz5KCLqnyE9GhH/Lml0RNy3U41L3SKiXNJXSN3WelVEvFRj/tPAnRExK5n+O3BjRBTXaedy4HKAHj169FuxYsXOhJPW66ZnqG+rBbxz53d2qe1dXffs2bM5//zzmTx5Mscff3xWY9mTZfozzuV3waw5SSqpe123Pg0dKfSTdDDw/eRta51rDpkEERHlyecHwGTgxDpVyoHuNaYPScrqtnN/RBRGRGFTXNw9uFP9p2W2V96UGlv3wIEDWbFihRPCLsr0Z5zL74LZ7qihpPA74O/AEUBJnaG4geUAkNRR0r7V48DpwII61aYCFyrlJGBDRLy3w1uxg24Y2pf8dnm1yvLb5XHD0L7ZXnVO192aZLqf/fMwq62hu49+BfxK0m8j4oc70fZXgcmpu05pC/wpIqZJuiJp/3fAs6RuR11K6pbUS7bTVpMaflzqskXNO05uGNo3Xb6nrrs1yXQ/++dhVtt2rynUqiQdC5ySTL4UEfOyGlUDCgsLo7i40QMVMzOroSmuKVQ3dDXwGPCVZHgseceCmZntYTJ5n8KlQP+I+BRA0i+AOcCvG1zKzMxanEyeUxCpbiqqVb99zczM9jCZHCk8BLwmaXIyPRyYkL2QzMwsVxpNChFxj6QXgEFJ0SURMTerUZmZWU5kcqRA0nNpTnovNTOz5pPrDvHMzGw34qRgZmZpDSYFSXmSnm+uYMzMLLcaTAoRUQV8IWn/ZorHzMxyKJMLzRXAfEkzgE+rCyNi2xcPmJlZi5ZJUpiUDGZmtofL5DmFhyXlAz0iYnEzxGRmZjmSSYd4/wMoBaYl0wWSpmY7MDMza36Z3JI6jtQb09YDREQp8PUsxmRmZjmSSVLYGhEb6pR9kY1gzMwstzJJCgslfRfIk9Rb0q+B2ZmuIHnWYa6kp+uZd7GktZJKk+HSHYjdzMyaWCZJ4SrgG8BmoAjYCFyzA+sYDbzVwPw/R0RBMjywA+2amVkTazQpRMSmiBgLnAYMjoixEfFZJo1LOgT4DuA/9mZmLUAmdx+dIGk+MI/UQ2xvSuqXYfvjgR/T8DWIEZLmSfqLpO4ZtmtmZlmQyemjCcCPIqJnRPQEriT14p0GSToL+CAiShqo9hTQMyKOAWYAD2+nrcslFUsqXrt2bQYhm5nZzsgkKVRFxMvVExExC/g8g+VOBs6WVAZMBE6V9MeaFSLiw4jYnEw+ANR7BBIR90dEYUQUdu3aNYNVm5nZztjuE82Sjk9GX5T0e1IXmQP4N+CFxhqOiDHAmKStbwHXR8QFddZxUES8l0yeTcMXpM3MLMsa6ubil3Wmb6kxHju7Qkk/BYojYipwtaSzSR15fARcvLPtmpnZrlPETv99z4nCwsIoLi7OdRhmZi2KpJKIKGysXqMd4knqBFwI9KxZ311nm5nteTLpOvtZ4FVgPu7ewsxsj5ZJUmgfEddmPRIzM8u5TG5JfVTSZZIOktS5esh6ZGZm1uwyOVLYAtwFjOXLu44Cd59tZrbHySQpXAccHhHrsh2MmZnlVianj5YCm7IdiJmZ5V4mRwqfAqWSnifVfTbgW1LNzPZEmSSFKclgZmZ7uEaTQkTU23OpmZnteTJ5ovkd6unrKCJ895GZ2R4mkwvNhcAJyXAK8Cvgjw0usZt7//33GTlyJIcddhj9+vXjzDPP5O233+aoo47KdWg7JS8vj4KCAo499liOP/54Zs+u/Qrt8ePH0759ezZs2JCjCM2spcjkdZwf1hjKI2I8qVdstkgRwTnnnMO3vvUtli1bRklJCXfccQdr1qzJdWg7LT8/n9LSUt58803uuOMOxowZU2t+UVERJ5xwApMmTcpRhGbWUmTyOs7jawyFkq4gswvUu6Xnn3+edu3accUVV6TLjj32WLp33zPeBLpx40YOOOCA9PSyZcuoqKjgtttuo6ioKIeRmVlLkMkf95rvVfgcKAP+Z1aiaQYLFiygX79MXzHdMlRWVlJQUMBnn33Ge++9x8yZM9PzJk6cyMiRIznllFNYvHgxa9as4atf/WoOozWz3Vkmp48G1xiGRMRlEbE40xVIypM0V9LT9czbW9KfJS2V9JqknjsWvsGXp48WLVrEtGnTuPDCC6l+T0ZRUREjR46kTZs2jBgxgieeeCLH0ZrZ7iyTu4/2Bkaw7fsUfprhOkaTes3mfvXM+wHwcUQcLmkk8AtSr/tsUlPmlnPX9MWsXl9Jh3Vb4I05Tb2KZldzmyq3VjFlbjnDj+vGgAEDWLduHWvXrmXNmjUsWbKEIUOGALBlyxZ69erFqFGjchy9me2uMrn76ElgGKlTR5/WGBol6RBSF6Uf2E6VYUD1cxB/AU6TpEzaztSUueWMmTSf8vWVBFDR5QiWr1nPj/7jF+k68+bNY+XKlU252qyqu00RMGbSfKbMLWfRokVUVVXRpUsXioqKGDduHGVlZZSVlbF69WpWr17NihUrcr0JZrabyuSawiERccZOtj8e+DGw73bmdwNWAkTE55I2AF2AJut8767pi6ncWpWelkSX4Tfz+NQHmV50P+3bt6dnz56MHz++qVaZdXW3KT7fwrL7f8T3JrTh8K4defjhh8nLy2PixIk8++yztZY955xzmDhxIjfeeGNzh21mLUAmSWG2pKMjYv6ONCzpLOCDiCiR9K2diu7Lti4HLgfo0aPHDi27en3lNmVt9+3CvmfewLI7a99Zu2DBgp0PshnV3aZDfzwVAAFv1tim5cuXb7PsPffck9XYzKxly+T00SCgRNJiSfMkzZc0L4PlTgbOllQGTAROlVT3obdyoDuApLbA/sCHdRuKiPsjojAiCrt27ZrBqr90cKf8HSpvCfbEbTKz3UMmSeHbQG/gdOB/AGclnw2KiDERcUhE9ARGAjMj4oI61aYCFyXj5yV1tulSY1fcMLQv+e3yapXlt8vjhqF9m3I1zWpP3CYz2z1k0iFek16VlPRToDgipgITSL3ucynwEank0aSGH9cNIH2nzsGd8rlhaN90eUu0J26Tme0e1MT/mGddYWFhFBcX5zoMM7MWRVJJRBQ2Vi+T00dmZtZKOCmYmVmak4KZmaU5KZiZWZqTgpmZpTkpmJlZmpOCmZmlOSmYmVmak4KZmaU5KZiZWZqTgpmZpTkpmJlZmpOCmZmlOSmYmVmak4KZmaU5KZiZWVrWkoKk9pJel/SmpIWSbq2nzsWS1koqTYZLsxWPmZk1rtHXce6CzcCpEVEhqR0wS9JfI+LVOvX+HBGjshiHmZllKGtJIVLv+axIJtslQ8t696eZWSuT1WsKkvIklQIfADMi4rV6qo2QNE/SXyR1z2Y8ZmbWsKwmhYioiogC4BDgRElH1anyFNAzIo4BZgAP19eOpMslFUsqXrt2bTZDNjNr1Zrl7qOIWA88D5xRp/zDiNicTD4A9NvO8vdHRGFEFHbt2jW7wZqZtWLZvPuoq6ROyXg+MARYVKfOQTUmzwbeylY8ZmbWuGzefXQQ8LCkPFLJ5/GIeFrST4HiiJgKXC3pbOBz4CPg4izGY2ZmjVDqJqGWo7CwMIqLi3MdhplZiyKpJCIKG6vnJ5rNzCzNScHMzNKcFMzMLM1JwczM0pwUzMwszUnBzMzSnBTMzCzNScHMzNKcFMzMLM1JwczM0pwUzMwszUnBzMzSnBTqMWXKFCSxaNEi1qxZw9lnn81ee+1Fv379GDBgAJMnT2bcuHHcfffdXHPNNXTr1o0vvviiWWNctWoVw4YNo3fv3hx22GGMHj2aLVu2MHbsWAoKCtJDnz59yMvLo6KiovFGzWyXlJWVcdRRtd8lVv23AuDzzz+na9eu3HTTTbkILyNOCvUoKipi0KBB/OlPf2L48OH079+fPn36UFJSwsSJE1m1ahUAEcHkyZPp3r07L774YrPFFxGce+65DB8+nCVLlvD2229TUVHB2LFjuf322yktLU0PJ5xwAmPGjGGfffZptvjMrH4zZsygT58+PPHEE+yuPVQ7KdRRUVHBrFmzmDBhAg899BB77bUX3/ve99LzDz30UK666ioAli1bxje+8Q1++MMfUlRU1Gwxzpw5k/bt23PJJZcAkJeXx7333suDDz7Ipk2b0vX++Mc/snTpUsaNG9dssZnZ9hUVFTF69Gh69OjBnDlzch1OvbL5kp0W6cknn+SMM86gT58+tG3blm7dugGpBFBQUJCu9/7773PooYcyatQohg0bxs0338zWrVtp165d1mNcuHAh/frVfnPpfvvtR48ePVi6dCnHHHMMZWVl3HTTTbzwwgu0besfs1muffbZZzz33HP8/ve/Z/369RQVFTFw4MBch7WNbL6Os72k1yW9KWmhpFvrqbO3pD9LWirpNUk9sxVPQ6bMLefkO2fS66Zn+NFPf8ULWw+n103PsLHjIbw2dwEAhx12GCeffDIRQbt27bjssstYtGgRw4cPZ7/99qN///5Mnz69WeK8depC/vzfK5kyt7zeelVVVVxwwQX87Gc/4/DDD89qTGb25e/mKb94nuXrPt3md1MSTz/9NIMHDyY/P58RI0YwZcoUqqqqchTx9mXzX8jNwKkRUSGpHTBL0l8j4tUadX4AfBwRh0saCfwC+LcsxrSNKXPLGTNpPpVbq6iq/IRPlr/Jp++/A4jY+hkfb6lk+oL3APjNb37DunXrKCwsZOnSpVRWVnL00UcDsGnTJvLz8znrrLOyHmfbA3vw0SuvMGbSfACGH9eNjRs38u6773L44Ydz2223cdBBB6VPL5lZ9tT83VT+vmz5dGOt382PPvqIXr16UVRUxKxZs+jZsycAH374ITNnzmTIkCE5jH5bWTtSiJTqW17aJUPdKyvDgIeT8b8Ap0lStmKqz13TF1O5NZWtNy1+hY7fGMwhP3yIQ374IIdc9RjkteXWO+9J168+Z79gwQL+9V//lbKyMsrKynjnnXeYMWNGrXP62Yqz/aHHEp9vZu3cv3HX9MVUVVVx3XXXcfHFFzNv3jz+8Ic/cP/992clDjOrrebvZpu98snbpzMfLX2Du6Yv5qOPPmLatGkUFBTw8ssv8+6776b/ZvzmN79p1muRmcrqhWZJeZJKgQ+AGRHxWp0q3YCVABGY9ZDcAAAIrklEQVTxObAB6FJPO5dLKpZUvHbt2iaNcfX6yvT4p2+9SIc+A2qul/1OHMGa0r/z9ttvc+KJJ3LRRRdx6623snTpUv7pn/4pXbdjx44MGjSIp556qknjqy9OSXQ9ZyybFs3i9f97AX369KF9+/b8/Oc/55ZbbmHTpk0MHjy41q2py5Yty0pcZq1dzd9NgC7fuZYNsyfy3/deyqmnnsott9xCaWkpp556KnvvvXe63rBhw3jqqafYvHlzc4fcIDXHbVGSOgGTgasiYkGN8gXAGRGxKpleBvSPiHXba6uwsDCKi4ubLLaT75xJeZ0fal3dOuXzyk2nNtk6d8b24twdYjNrzVrK76akkogobKxes9ySGhHrgeeBM+rMKge6A0hqC+wPfNgcMVW7YWhf8tvlbXd+frs8bhjatxkjql99ce4usZm1Znva72Y27z7qmhwhICkfGAIsqlNtKnBRMn4eMDOa+YmO4cd1445zj6Zbp3wEHNChHZ3y2yFSmf6Oc49m+HHdmjOketWNc3eKzaw129N+N7N2+kjSMaQuIueRSj6PR8RPJf0UKI6IqZLaA48CxwEfASMjYnlD7Tb16SMzs9Yg09NHWbslNSLmkfpjX7f8JzXGPwP+NVsxmJnZjnE3F2ZmluakYGZmaU4KZmaW5qRgZmZpTgpmZpbWLE80NyVJa4EVuY6jmR0IbPcp71bM+6V+3i/b8j6BQyOia2OVWlxSaI0kFWdyf3Fr4/1SP++XbXmfZM6nj8zMLM1JwczM0pwUWga/HKF+3i/1837ZlvdJhnxNwczM0nykYGZmaU4KuwlJZZLmSyqVVJyUdZY0Q9KS5POApFySfiVpqaR5ko7PbfRNQ9KDkj5IXr5UXbbD+0DSRUn9JZIuqm9dLcl29ss4SeXJ96VU0pk15o1J9stiSUNrlJ+RlC2VdFNzb0dTk9Rd0vOS/iFpoaTRSXmr/87skojwsBsMQBlwYJ2y/wvclIzfBPwiGT8T+Csg4CTgtVzH30T74JvA8cCCnd0HQGdgefJ5QDJ+QK63LQv7ZRxwfT11jwTeBPYGegHLSHVfn5eMfx3YK6lzZK63bRf3y0HA8cn4vsDbyfa3+u/Mrgw+Uti9DSP1TgqSz+E1yh+JlFeBTpIOykWATSkiXiL1Xo2adnQfDCX1PvCPIuJjYAbbvvGvRdnOftmeYcDEiNgcEe8AS4ETk2FpRCyPiC3AxKRuixUR70XEG8n4J8BbpN773uq/M7vCSWH3EcDfJJVIujwp+2pEvJeMvw98NRnvBqysseyqpGxPtKP7oDXtm1HJaZAHq0+R0Er3i6SepN7f8hr+zuwSJ4Xdx6CIOB74NnClpG/WnBmp49xWfauY90EtvwUOAwqA94Bf5jac3JG0D/D/gGsiYmPNef7O7Dgnhd1ERJQnnx8Ak0kd7q+pPi2UfH6QVC8HutdY/JCkbE+0o/ugVeybiFgTEVUR8QXwX6S+L9DK9oukdqQSwmMRMSkp9ndmFzgp7AYkdZS0b/U4cDqwAJgKVN8JcRHwZDI+FbgwuZviJGBDjcPlPc2O7oPpwOmSDkhOqZyelO1R6lxDOofU9wVS+2WkpL0l9QJ6A68D/w30ltRL0l7AyKRuiyVJwATgrYi4p8Ysf2d2Ra6vdHsISN0R8mYyLATGJuVdgL8DS4DngM5JuYDfkLqbZD5QmOttaKL9UETqVMhWUud1f7Az+wD4PqkLrEuBS3K9XVnaL48m2z2P1B+7g2rUH5vsl8XAt2uUn0nqDp1l1d+xljwAg0idGpoHlCbDmf7O7NrgJ5rNzCzNp4/MzCzNScHMzNKcFMzMLM1JwczM0pwUzMwszUnBWi1JL0jK+nt7JV0t6S1Jj2Wh7WskdWjqdq31clIw2wmS2u5A9R8BQyLie03UXk3XAE4K1mScFGy3Jqln8l/2fyV95v9NUn4yL/2fvqQDJZUl4xdLmpL0pV8maZSkayXNlfSqpM41VvHvyfsIFkg6MVm+Y9LJ3OvJMsNqtDtV0kxSD0fVjfXapJ0Fkq5Jyn5H6uHEv0r633Xq12ovedL2rmT5+ZL+Lan3LUlP11juP5NlrwYOBp6X9Hwy73RJcyS9IemJpF8gJN2p1HsH5km6e9d/Mran2tn/TsyaU2/g/Ii4TNLjwAjgj40scxSpXjPbk3pK9caIOE7SvcCFwPikXoeIKEg6IHwwWW4sMDMivi+pE/C6pOeS+scDx0REra6sJfUDLgH6k3py9jVJL0bEFZLOAAZHxLp64ky3J2kEqQ7ujgUOBP5b0kvb28CI+JWka6vblnQg8B/Av0TEp5JuBK6V9BtSXWEcERGRbJNZvZwUrCV4JyJKk/ESoGcGyzwfqT72P5G0AXgqKZ8PHFOjXhGk3lkgab/kD+bpwNmSrk/qtAd6JOMz6iaExCBgckR8CiBpEnAKMLeROGu2NwgoiogqUp26vQicAGzc7tK1nUTqJTOvpLoFYi9gDrAB+AyYkBxxPL3dFqzVc1KwlmBzjfEqID8Z/5wvT4G2b2CZL2pMf0Ht733dfl6C1H/6IyJicc0ZkvoDn+5Q5I3LpL2a2wnbbms1kUoy528zI3Vq7DTgPGAUcOoOxmmthK8pWEtWBvRLxs/byTaqz9sPItVr5gZSPWRelfTCiaTjMmjnZWC4pA5K9XR7TlK2I14G/k1SnqSupF7D+TqwAjgy6fm0E6k/7tU+IfUqSoBXgZMlHZ7E3VFSn+S6wv4R8Szwv0mdnjKrl48UrCW7G3hcqTfVPbOTbXwmaS7QjlRPmQA/I3XNYZ6kNsA7wFkNNRIRb0j6A6k/4gAPRERjp47qmgwMINVbbgA/joj3AZJrKQuSWGq2ez8wTdLqiBgs6WKgSNLeyfz/IJU4npTUntTRxLU7GJe1Iu4l1czM0nz6yMzM0pwUzMwszUnBzMzSnBTMzCzNScHMzNKcFMzMLM1JwczM0pwUzMws7f8DiTS/64OztAAAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# TODO: Scatter plot of number of routes vs. number of incidents\n",
    "# ! pip install matplotlib --user\n",
    "%matplotlib inline\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# YOUR CODE HERE\n",
    "x = merged_df['flight_count']   # number of routes\n",
    "y = merged_df['incident_count'] # number of incidents\n",
    "plt.scatter(x, y)\n",
    "plt.xlabel('number of routes')\n",
    "plt.ylabel('number of incidents')\n",
    "s = merged_df['airline_iata']\n",
    "for label in range(0,len(s)):\n",
    "    plt.text(x[label], y[label], s[label])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "b4ce25b091c0bb21189bc6cbcf25bc35",
     "grade": false,
     "grade_id": "cell-644c72453e81b256",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "# Step 5: Integrating Data\n",
    "\n",
    "Data wrangling typically refers to the process of importing, remapping, and converting data.  On the other hand, data integration typically refers to linking data across heterogeneous sources.  We have an integration problem (in its simplest form) when we want to combine the on-time information (what was originally `flights_df`, and is now in the SQL database) and the route information (`routes_df`).\n",
    "\n",
    "## 5.1 Relating Routes and Flights: Schema Matching\n",
    "Now we’ll make use of the on-time flight performance table…  Recall that we put this into an SQL table.\n",
    "\n",
    "Re-read the flight information into `flights_df`.\n",
    "\n",
    "Now let’s see if we can actually detect what fields (columns) “match” between `routes_df` and `flights_df` DataFrames.  \n",
    "\n",
    "To do this, let’s note that we only care about the “categorical” (string-valued) columns.  What we want is, e.g., to find fields that have lots of common values (for instance, airline abbreviations or airport codes).  To measure this in a principled way, we’ll use a measure called the Jaccard distance (or Jaccard index or Jaccard measure).  The Jaccard distance measures similarity between two sets A and B, and is merely:\n",
    "\n",
    "\\begin{equation*}\n",
    "| A \\cap B | / |A \\cup B|\n",
    "\\end{equation*}\n",
    "\n",
    "Let’s compute the Jaccard distances between (the values of) all pairs of attributes in `routes_df` and `flights_df`. This will tell us which attributes include similar values - and thus which might represent the same concept. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "ddfdb93ce64fdc320e99a96d0c3ed1bb",
     "grade": false,
     "grade_id": "cell-2d84cd9aaa3525c4",
     "locked": false,
     "schema_version": 1,
     "solution": true
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>YEAR</th>\n",
       "      <th>MONTH</th>\n",
       "      <th>DAY_OF_MONTH</th>\n",
       "      <th>CARRIER</th>\n",
       "      <th>FL_NUM</th>\n",
       "      <th>ORIGIN</th>\n",
       "      <th>DEST</th>\n",
       "      <th>ARR_DELAY_NEW</th>\n",
       "      <th>CANCELLED</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>1325</td>\n",
       "      <td>SJU</td>\n",
       "      <td>MCO</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5159</td>\n",
       "      <td>SJU</td>\n",
       "      <td>MCO</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5890</td>\n",
       "      <td>SJU</td>\n",
       "      <td>MCO</td>\n",
       "      <td>9.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6618</td>\n",
       "      <td>SJU</td>\n",
       "      <td>MCO</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>1701</td>\n",
       "      <td>SJU</td>\n",
       "      <td>MDW</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>844</td>\n",
       "      <td>SJU</td>\n",
       "      <td>TPA</td>\n",
       "      <td>23.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>4679</td>\n",
       "      <td>SJU</td>\n",
       "      <td>TPA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6294</td>\n",
       "      <td>SLC</td>\n",
       "      <td>BUR</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5245</td>\n",
       "      <td>SLC</td>\n",
       "      <td>DAL</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>2278</td>\n",
       "      <td>SLC</td>\n",
       "      <td>DEN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5125</td>\n",
       "      <td>SLC</td>\n",
       "      <td>DEN</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6215</td>\n",
       "      <td>SLC</td>\n",
       "      <td>DEN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6913</td>\n",
       "      <td>SLC</td>\n",
       "      <td>DEN</td>\n",
       "      <td>23.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>3731</td>\n",
       "      <td>SLC</td>\n",
       "      <td>HOU</td>\n",
       "      <td>94.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5549</td>\n",
       "      <td>SLC</td>\n",
       "      <td>LAS</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5810</td>\n",
       "      <td>SLC</td>\n",
       "      <td>LAS</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6556</td>\n",
       "      <td>SLC</td>\n",
       "      <td>LAS</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6599</td>\n",
       "      <td>SLC</td>\n",
       "      <td>LAS</td>\n",
       "      <td>27.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5673</td>\n",
       "      <td>SLC</td>\n",
       "      <td>LAX</td>\n",
       "      <td>25.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6819</td>\n",
       "      <td>SLC</td>\n",
       "      <td>LAX</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5053</td>\n",
       "      <td>SLC</td>\n",
       "      <td>MDW</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5911</td>\n",
       "      <td>SLC</td>\n",
       "      <td>MDW</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6622</td>\n",
       "      <td>SLC</td>\n",
       "      <td>OAK</td>\n",
       "      <td>29.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6671</td>\n",
       "      <td>SLC</td>\n",
       "      <td>OAK</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6799</td>\n",
       "      <td>SLC</td>\n",
       "      <td>OAK</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>1315</td>\n",
       "      <td>SLC</td>\n",
       "      <td>PHX</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5007</td>\n",
       "      <td>SLC</td>\n",
       "      <td>PHX</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5218</td>\n",
       "      <td>SLC</td>\n",
       "      <td>PHX</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5913</td>\n",
       "      <td>SLC</td>\n",
       "      <td>PHX</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6909</td>\n",
       "      <td>SLC</td>\n",
       "      <td>PHX</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570088</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>734</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>101.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570089</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>744</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570090</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>1163</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570091</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>3527</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>124.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570092</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5294</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>75.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570093</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5421</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>60.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570094</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6225</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570095</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6499</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>80.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570096</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6519</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>64.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570097</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6562</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>176.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570098</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6783</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>45.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570099</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6816</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570100</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6850</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570101</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6889</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SAN</td>\n",
       "      <td>68.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570102</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>4257</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SEA</td>\n",
       "      <td>57.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570103</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6211</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SEA</td>\n",
       "      <td>113.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570104</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6493</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SEA</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570105</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6796</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SEA</td>\n",
       "      <td>83.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570106</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6988</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SEA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570107</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5125</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SLC</td>\n",
       "      <td>112.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570108</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>29</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SNA</td>\n",
       "      <td>89.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570109</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>1420</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SNA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570110</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5390</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SNA</td>\n",
       "      <td>107.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570111</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5453</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SNA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570112</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5598</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SNA</td>\n",
       "      <td>15.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570113</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>5671</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SNA</td>\n",
       "      <td>11.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570114</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6065</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SNA</td>\n",
       "      <td>76.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570115</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6185</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SNA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570116</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6456</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SNA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570117</th>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>WN</td>\n",
       "      <td>6937</td>\n",
       "      <td>SJC</td>\n",
       "      <td>SNA</td>\n",
       "      <td>25.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>570118 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        YEAR  MONTH  DAY_OF_MONTH CARRIER  FL_NUM ORIGIN DEST  ARR_DELAY_NEW  \\\n",
       "0       2018      1             2      WN    1325    SJU  MCO            0.0   \n",
       "1       2018      1             2      WN    5159    SJU  MCO            0.0   \n",
       "2       2018      1             2      WN    5890    SJU  MCO            9.0   \n",
       "3       2018      1             2      WN    6618    SJU  MCO            0.0   \n",
       "4       2018      1             2      WN    1701    SJU  MDW            8.0   \n",
       "5       2018      1             2      WN     844    SJU  TPA           23.0   \n",
       "6       2018      1             2      WN    4679    SJU  TPA            0.0   \n",
       "7       2018      1             2      WN    6294    SLC  BUR           20.0   \n",
       "8       2018      1             2      WN    5245    SLC  DAL            0.0   \n",
       "9       2018      1             2      WN    2278    SLC  DEN            0.0   \n",
       "10      2018      1             2      WN    5125    SLC  DEN            7.0   \n",
       "11      2018      1             2      WN    6215    SLC  DEN            0.0   \n",
       "12      2018      1             2      WN    6913    SLC  DEN           23.0   \n",
       "13      2018      1             2      WN    3731    SLC  HOU           94.0   \n",
       "14      2018      1             2      WN    5549    SLC  LAS            0.0   \n",
       "15      2018      1             2      WN    5810    SLC  LAS            0.0   \n",
       "16      2018      1             2      WN    6556    SLC  LAS            0.0   \n",
       "17      2018      1             2      WN    6599    SLC  LAS           27.0   \n",
       "18      2018      1             2      WN    5673    SLC  LAX           25.0   \n",
       "19      2018      1             2      WN    6819    SLC  LAX            0.0   \n",
       "20      2018      1             2      WN    5053    SLC  MDW            0.0   \n",
       "21      2018      1             2      WN    5911    SLC  MDW            0.0   \n",
       "22      2018      1             2      WN    6622    SLC  OAK           29.0   \n",
       "23      2018      1             2      WN    6671    SLC  OAK            4.0   \n",
       "24      2018      1             2      WN    6799    SLC  OAK            0.0   \n",
       "25      2018      1             2      WN    1315    SLC  PHX            0.0   \n",
       "26      2018      1             2      WN    5007    SLC  PHX           20.0   \n",
       "27      2018      1             2      WN    5218    SLC  PHX            0.0   \n",
       "28      2018      1             2      WN    5913    SLC  PHX            0.0   \n",
       "29      2018      1             2      WN    6909    SLC  PHX            0.0   \n",
       "...      ...    ...           ...     ...     ...    ...  ...            ...   \n",
       "570088  2018      1             2      WN     734    SJC  SAN          101.0   \n",
       "570089  2018      1             2      WN     744    SJC  SAN            7.0   \n",
       "570090  2018      1             2      WN    1163    SJC  SAN            0.0   \n",
       "570091  2018      1             2      WN    3527    SJC  SAN          124.0   \n",
       "570092  2018      1             2      WN    5294    SJC  SAN           75.0   \n",
       "570093  2018      1             2      WN    5421    SJC  SAN           60.0   \n",
       "570094  2018      1             2      WN    6225    SJC  SAN            0.0   \n",
       "570095  2018      1             2      WN    6499    SJC  SAN           80.0   \n",
       "570096  2018      1             2      WN    6519    SJC  SAN           64.0   \n",
       "570097  2018      1             2      WN    6562    SJC  SAN          176.0   \n",
       "570098  2018      1             2      WN    6783    SJC  SAN           45.0   \n",
       "570099  2018      1             2      WN    6816    SJC  SAN            7.0   \n",
       "570100  2018      1             2      WN    6850    SJC  SAN            4.0   \n",
       "570101  2018      1             2      WN    6889    SJC  SAN           68.0   \n",
       "570102  2018      1             2      WN    4257    SJC  SEA           57.0   \n",
       "570103  2018      1             2      WN    6211    SJC  SEA          113.0   \n",
       "570104  2018      1             2      WN    6493    SJC  SEA            6.0   \n",
       "570105  2018      1             2      WN    6796    SJC  SEA           83.0   \n",
       "570106  2018      1             2      WN    6988    SJC  SEA            0.0   \n",
       "570107  2018      1             2      WN    5125    SJC  SLC          112.0   \n",
       "570108  2018      1             2      WN      29    SJC  SNA           89.0   \n",
       "570109  2018      1             2      WN    1420    SJC  SNA            0.0   \n",
       "570110  2018      1             2      WN    5390    SJC  SNA          107.0   \n",
       "570111  2018      1             2      WN    5453    SJC  SNA            0.0   \n",
       "570112  2018      1             2      WN    5598    SJC  SNA           15.0   \n",
       "570113  2018      1             2      WN    5671    SJC  SNA           11.0   \n",
       "570114  2018      1             2      WN    6065    SJC  SNA           76.0   \n",
       "570115  2018      1             2      WN    6185    SJC  SNA            0.0   \n",
       "570116  2018      1             2      WN    6456    SJC  SNA            0.0   \n",
       "570117  2018      1             2      WN    6937    SJC  SNA           25.0   \n",
       "\n",
       "        CANCELLED  \n",
       "0             0.0  \n",
       "1             0.0  \n",
       "2             0.0  \n",
       "3             0.0  \n",
       "4             0.0  \n",
       "5             0.0  \n",
       "6             0.0  \n",
       "7             0.0  \n",
       "8             0.0  \n",
       "9             0.0  \n",
       "10            0.0  \n",
       "11            0.0  \n",
       "12            0.0  \n",
       "13            0.0  \n",
       "14            0.0  \n",
       "15            0.0  \n",
       "16            0.0  \n",
       "17            0.0  \n",
       "18            0.0  \n",
       "19            0.0  \n",
       "20            0.0  \n",
       "21            0.0  \n",
       "22            0.0  \n",
       "23            0.0  \n",
       "24            0.0  \n",
       "25            0.0  \n",
       "26            0.0  \n",
       "27            0.0  \n",
       "28            0.0  \n",
       "29            0.0  \n",
       "...           ...  \n",
       "570088        0.0  \n",
       "570089        0.0  \n",
       "570090        0.0  \n",
       "570091        0.0  \n",
       "570092        0.0  \n",
       "570093        0.0  \n",
       "570094        0.0  \n",
       "570095        0.0  \n",
       "570096        0.0  \n",
       "570097        0.0  \n",
       "570098        0.0  \n",
       "570099        0.0  \n",
       "570100        0.0  \n",
       "570101        0.0  \n",
       "570102        0.0  \n",
       "570103        0.0  \n",
       "570104        0.0  \n",
       "570105        0.0  \n",
       "570106        0.0  \n",
       "570107        0.0  \n",
       "570108        0.0  \n",
       "570109        0.0  \n",
       "570110        0.0  \n",
       "570111        0.0  \n",
       "570112        0.0  \n",
       "570113        0.0  \n",
       "570114        0.0  \n",
       "570115        0.0  \n",
       "570116        0.0  \n",
       "570117        0.0  \n",
       "\n",
       "[570118 rows x 9 columns]"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# TODO: get flights from SQL\n",
    "\n",
    "# YOUR CODE HERE\n",
    "flights_df = pd.read_sql_query('select * from flights', engine)\n",
    "\n",
    "flights_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "15669cd0fc9fae05d8602c738a43d4e1",
     "grade": true,
     "grade_id": "cell-3c2563c42a358dbb",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "if len(flights_df) != 570118:\n",
    "    raise ValueError('Expected a different number of flights')\n",
    "    \n",
    "if len(flights_df.columns) != 9:\n",
    "    raise ValueError('Perhaps you forgot to remove a column? Number of columns isn''t as expected')\n",
    "    \n",
    "### BEGIN HIDDEN TESTS\n",
    "if set(flights_df.columns) != set(['ARR_DELAY_NEW','CANCELLED','CARRIER','DAY_OF_MONTH','DEST',\n",
    "                                   'FL_NUM','MONTH','ORIGIN','YEAR']):\n",
    "    raise ValueError(\"incorrect names of fields\")\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "393d355d32e815b299346ad70d54496d",
     "grade": false,
     "grade_id": "cell-1710b51fbf291c26",
     "locked": true,
     "schema_version": 1,
     "solution": false
    },
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 570118 entries, 0 to 570117\n",
      "Data columns (total 9 columns):\n",
      "YEAR             570118 non-null int64\n",
      "MONTH            570118 non-null int64\n",
      "DAY_OF_MONTH     570118 non-null int64\n",
      "CARRIER          570118 non-null object\n",
      "FL_NUM           570118 non-null int64\n",
      "ORIGIN           570118 non-null object\n",
      "DEST             570118 non-null object\n",
      "ARR_DELAY_NEW    551498 non-null float64\n",
      "CANCELLED        570118 non-null float64\n",
      "dtypes: float64(2), int64(4), object(3)\n",
      "memory usage: 39.1+ MB\n"
     ]
    }
   ],
   "source": [
    "flights_df.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "e8d5dc3b0df756921232d3de10cf6730",
     "grade": false,
     "grade_id": "cell-bd671825cfe0b5d6",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "## Step 5.1: Column / Schema Matches\n",
    "\n",
    "Create a Cell with an algorithm that iterates over all `routes_df` keys (columns) and all `flights_df` keys.  In a nested map {r → {p → distance}}, the algorithm should store the Jaccard distance between the values in routes column r to the values in performance column p (for distances that are non-zero and only for non-numeric columns).  Remember, since there may be duplicates, you’ll need to convert columns into sets of unique values through `drop_duplicates()`.  \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'airline_iata': {'CARRIER': 0.02197802197802198},\n",
       " 'code_share': {},\n",
       " 'equipment': {'DEST': 0.00023529411764705883,\n",
       "  'ORIGIN': 0.00023529411764705883},\n",
       " 'src_iata_icao': {'DEST': 0.10163624921334173, 'ORIGIN': 0.10163624921334173},\n",
       " 'target_iata_icao': {'DEST': 0.1018867924528302,\n",
       "  'ORIGIN': 0.1018867924528302}}"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# TODO: create nested map of Jaccard distance\n",
    "\n",
    "best_match = {}\n",
    "\n",
    "# YOUR CODE HERE\n",
    "\n",
    "def jaccard_sim(col_1, col_2):\n",
    "    intersection = col_1.intersection(col_2)\n",
    "    union = col_1.union(col_2)\n",
    "    jaccard = len(intersection)/float(len(union))\n",
    "    return jaccard\n",
    "\n",
    "for r in range(0,len(routes_df.columns)):\n",
    "    if routes_df[routes_df.columns[r]].dtype == 'O': # only for non-numeric col's\n",
    "        best_match[routes_df.columns[r]] = {} # initialize nested dictionary\n",
    "        route_data = routes_df[routes_df.columns[r]].drop_duplicates() # convert to set of unique values\n",
    "        for p in range(0,len(flights_df.columns)):\n",
    "            if flights_df[flights_df.columns[p]].dtype == 'O':\n",
    "                flight_data = flights_df[flights_df.columns[p]].drop_duplicates()\n",
    "                jaccard = jaccard_sim(set(route_data), set(flight_data)) # compute jaccard\n",
    "                if jaccard != 0:\n",
    "                    best_match[routes_df.columns[r]][flights_df.columns[p]] = jaccard # store value if it's not 0\n",
    "best_match"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "02a1a92596b2dd1972623369989fe74c",
     "grade": true,
     "grade_id": "cell-ddeaa95f7ea56d51",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "incorrect Jaccard distance between two columns",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-34-1fc7dada8e6a>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0;31m### BEGIN HIDDEN TESTS\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      7\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mabs\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mbest_match\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'airline_iata'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'CARRIER'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0;36m0.021505376344086023\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m>\u001b[0m \u001b[0;36m10\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m5\u001b[0m \u001b[0;32mor\u001b[0m    \u001b[0mabs\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mbest_match\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'src_iata_icao'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'ORIGIN'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0;36m0.09225935447015139\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m>\u001b[0m \u001b[0;36m10\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m5\u001b[0m \u001b[0;32mor\u001b[0m    \u001b[0mabs\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mbest_match\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'equipment'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'DEST'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0;36m0.0002352387673488591\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m>\u001b[0m \u001b[0;36m10\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m6\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 8\u001b[0;31m     \u001b[0;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"incorrect Jaccard distance between two columns\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      9\u001b[0m \u001b[0;31m### END HIDDEN TESTS\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mValueError\u001b[0m: incorrect Jaccard distance between two columns"
     ]
    }
   ],
   "source": [
    "if len(best_match) != 5:\n",
    "    raise ValueError(\"unexpected number of entries\")\n",
    "if 'airline_iata' not in best_match:\n",
    "    raise KeyError('Missing airline_iata')\n",
    "    \n",
    "### BEGIN HIDDEN TESTS\n",
    "if abs(best_match['airline_iata']['CARRIER'] - 0.021505376344086023) > 10**-5 or \\\n",
    "   abs(best_match['src_iata_icao']['ORIGIN'] - 0.09225935447015139) > 10**-5 or \\\n",
    "   abs(best_match['equipment']['DEST'] - 0.0002352387673488591) > 10**-6:\n",
    "    raise ValueError(\"incorrect Jaccard distance between two columns\")\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "46c7852c56216438b8e5c93a175c1cea",
     "grade": true,
     "grade_id": "cell-41dec223e5669445",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "### BEGIN HIDDEN TESTS\n",
    "if bool(best_match['code_share']) == True:\n",
    "    raise ValueError(\"incorrect Jaccard distance between code_share and other column\")\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "ca64f37f8f7e18c641221702f2b4fa48",
     "grade": false,
     "grade_id": "cell-82c08d8cf3602cbe",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "The above map should help you decide which pairs of columns (one in each DataFrame) are “semantically equivalent.”  You should be able to find a very clear match between non-numeric codes for airlines in the two DataFrames.  The origin and destination codes will also have corresponding pairs (but if you only look at the Jaccard distances, there will be some ambiguity, since both origin and destination cities have values from the same domain; you will need to use your own knowledge of the semantics of the fields to disambiguate which pairs are correct).\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "# YOUR CODE HERE\n",
    "mapping = {'airline_iata':'CARRIER', 'src_iata_icao':'ORIGIN','target_iata_icao':'DEST'}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "30f145e29b52aec2039d36cd114306bc",
     "grade": true,
     "grade_id": "cell-c60c5adb2ada3571",
     "locked": true,
     "points": 0,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "if 'airline_iata' not in mapping:\n",
    "    raise ValueError('You seem to have dropped something from the dictionary')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "9349e4fe8124ae57f874bf87bf5c4f5b",
     "grade": true,
     "grade_id": "cell-710bcc86abca2ffe",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "### BEGIN HIDDEN TESTS\n",
    "if mapping['airline_iata'] != 'CARRIER':\n",
    "    raise ValueError('Your airline IATA is not correct')\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "de45f9b96ded127fcef7e0f8c4436092",
     "grade": true,
     "grade_id": "cell-2eb4edf8b9ce7dc8",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "### BEGIN HIDDEN TESTS\n",
    "if mapping['src_iata_icao'] != 'ORIGIN':\n",
    "    raise ValueError('Your source IATA is not correct')\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "89f50a20bd5c39c78030d3787c32e37e",
     "grade": true,
     "grade_id": "cell-81937392954fd2b4",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "### BEGIN HIDDEN TESTS\n",
    "if mapping['target_iata_icao'] != 'DEST':\n",
    "    raise ValueError('Your target IATA is not correct')\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "a7a2183dc14f42ef4182358d1256d7cd",
     "grade": false,
     "grade_id": "cell-52316b23d2e6e0d7",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "# Step 5.2 Creating Detailed Flights, Filtered by OpenFlight Routes\n",
    "\n",
    "Now that you know how routes_df and flights_df data relate, let’s see how the routes and flights actually relate.  Note that each data source (and thus DataFrame) is in fact incomplete.  For this step we’ll want to only consider the flight information and route information that “intersects.”\n",
    "\n",
    "## 5.2.1 Flights by Airline and Destination\n",
    "\n",
    "Create a joint DataFrame `flights_s_df` by merging the two DataFrames on the fields that correspond to flight information.  Use `routes_df.merge` as well as `left_on` and `right_on`.  Note that OpenFlight only has information about certain routes, and we want to focus on the flights corresponding to routes in OpenFlight.\n",
    "\n",
    "*Hint: you’ll need to pass lists for left_on and right_on in order to merge on the 3 fields between `routes_df` and `flights_df` that you found to “match” in the previous part. These 3 fields should effectively correspond to flights in `flights_df`.*"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "28157790935544e5dd587afa4ed07ab6",
     "grade": false,
     "grade_id": "cell-3c0471cacf1fda43",
     "locked": false,
     "schema_version": 1,
     "solution": true
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>airline_iata</th>\n",
       "      <th>airline_id</th>\n",
       "      <th>src_iata_icao</th>\n",
       "      <th>source_id</th>\n",
       "      <th>target_iata_icao</th>\n",
       "      <th>target_id</th>\n",
       "      <th>code_share</th>\n",
       "      <th>stops</th>\n",
       "      <th>equipment</th>\n",
       "      <th>YEAR</th>\n",
       "      <th>MONTH</th>\n",
       "      <th>DAY_OF_MONTH</th>\n",
       "      <th>CARRIER</th>\n",
       "      <th>FL_NUM</th>\n",
       "      <th>ORIGIN</th>\n",
       "      <th>DEST</th>\n",
       "      <th>ARR_DELAY_NEW</th>\n",
       "      <th>CANCELLED</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>9E</td>\n",
       "      <td>3316</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>90.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>108.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>11</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>52.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>12</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>15</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>16</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>17</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>143.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>18</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>19</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>21</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>38.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>23</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>24</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>25</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>26</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>28</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>29</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>30</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>31</td>\n",
       "      <td>9E</td>\n",
       "      <td>3333</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>9E</td>\n",
       "      <td>3382</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>9E</td>\n",
       "      <td>3407</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>45.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>9E</td>\n",
       "      <td>3628</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>9E</td>\n",
       "      <td>3628</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>11</td>\n",
       "      <td>9E</td>\n",
       "      <td>3628</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>12</td>\n",
       "      <td>9E</td>\n",
       "      <td>3628</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>15</td>\n",
       "      <td>9E</td>\n",
       "      <td>3628</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>9E</td>\n",
       "      <td>3976</td>\n",
       "      <td>ATL</td>\n",
       "      <td>3682</td>\n",
       "      <td>CHA</td>\n",
       "      <td>3578</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>CRJ</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>18</td>\n",
       "      <td>9E</td>\n",
       "      <td>3628</td>\n",
       "      <td>ATL</td>\n",
       "      <td>CHA</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341340</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>15</td>\n",
       "      <td>WN</td>\n",
       "      <td>1345</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341341</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>23</td>\n",
       "      <td>WN</td>\n",
       "      <td>824</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341342</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>23</td>\n",
       "      <td>WN</td>\n",
       "      <td>1345</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341343</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>24</td>\n",
       "      <td>WN</td>\n",
       "      <td>824</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341344</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>24</td>\n",
       "      <td>WN</td>\n",
       "      <td>1345</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341345</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>28</td>\n",
       "      <td>WN</td>\n",
       "      <td>4381</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341346</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>28</td>\n",
       "      <td>WN</td>\n",
       "      <td>4813</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341347</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>29</td>\n",
       "      <td>WN</td>\n",
       "      <td>824</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341348</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>29</td>\n",
       "      <td>WN</td>\n",
       "      <td>1345</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341349</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>WN</td>\n",
       "      <td>768</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>29.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341350</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>WN</td>\n",
       "      <td>1088</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341351</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>WN</td>\n",
       "      <td>3763</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341352</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>WN</td>\n",
       "      <td>4023</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341353</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>WN</td>\n",
       "      <td>4524</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>38.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341354</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>WN</td>\n",
       "      <td>824</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341355</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>WN</td>\n",
       "      <td>6725</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341356</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>16</td>\n",
       "      <td>WN</td>\n",
       "      <td>824</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341357</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>16</td>\n",
       "      <td>WN</td>\n",
       "      <td>1345</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>25.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341358</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>17</td>\n",
       "      <td>WN</td>\n",
       "      <td>824</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341359</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>17</td>\n",
       "      <td>WN</td>\n",
       "      <td>1345</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>58.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341360</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>25</td>\n",
       "      <td>WN</td>\n",
       "      <td>824</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341361</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>25</td>\n",
       "      <td>WN</td>\n",
       "      <td>1345</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341362</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>WN</td>\n",
       "      <td>768</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341363</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>WN</td>\n",
       "      <td>1088</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341364</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>18</td>\n",
       "      <td>WN</td>\n",
       "      <td>824</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>43.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341365</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>18</td>\n",
       "      <td>WN</td>\n",
       "      <td>1345</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341366</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>21</td>\n",
       "      <td>WN</td>\n",
       "      <td>4381</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341367</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>21</td>\n",
       "      <td>WN</td>\n",
       "      <td>4813</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341368</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>WN</td>\n",
       "      <td>824</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341369</th>\n",
       "      <td>WN</td>\n",
       "      <td>4547</td>\n",
       "      <td>TUS</td>\n",
       "      <td>3636</td>\n",
       "      <td>SAN</td>\n",
       "      <td>3731</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td>73W 73C 733</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>WN</td>\n",
       "      <td>1345</td>\n",
       "      <td>TUS</td>\n",
       "      <td>SAN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>341370 rows × 18 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       airline_iata  airline_id src_iata_icao  source_id target_iata_icao  \\\n",
       "0                9E        3976           ATL       3682              CHA   \n",
       "1                9E        3976           ATL       3682              CHA   \n",
       "2                9E        3976           ATL       3682              CHA   \n",
       "3                9E        3976           ATL       3682              CHA   \n",
       "4                9E        3976           ATL       3682              CHA   \n",
       "5                9E        3976           ATL       3682              CHA   \n",
       "6                9E        3976           ATL       3682              CHA   \n",
       "7                9E        3976           ATL       3682              CHA   \n",
       "8                9E        3976           ATL       3682              CHA   \n",
       "9                9E        3976           ATL       3682              CHA   \n",
       "10               9E        3976           ATL       3682              CHA   \n",
       "11               9E        3976           ATL       3682              CHA   \n",
       "12               9E        3976           ATL       3682              CHA   \n",
       "13               9E        3976           ATL       3682              CHA   \n",
       "14               9E        3976           ATL       3682              CHA   \n",
       "15               9E        3976           ATL       3682              CHA   \n",
       "16               9E        3976           ATL       3682              CHA   \n",
       "17               9E        3976           ATL       3682              CHA   \n",
       "18               9E        3976           ATL       3682              CHA   \n",
       "19               9E        3976           ATL       3682              CHA   \n",
       "20               9E        3976           ATL       3682              CHA   \n",
       "21               9E        3976           ATL       3682              CHA   \n",
       "22               9E        3976           ATL       3682              CHA   \n",
       "23               9E        3976           ATL       3682              CHA   \n",
       "24               9E        3976           ATL       3682              CHA   \n",
       "25               9E        3976           ATL       3682              CHA   \n",
       "26               9E        3976           ATL       3682              CHA   \n",
       "27               9E        3976           ATL       3682              CHA   \n",
       "28               9E        3976           ATL       3682              CHA   \n",
       "29               9E        3976           ATL       3682              CHA   \n",
       "...             ...         ...           ...        ...              ...   \n",
       "341340           WN        4547           TUS       3636              SAN   \n",
       "341341           WN        4547           TUS       3636              SAN   \n",
       "341342           WN        4547           TUS       3636              SAN   \n",
       "341343           WN        4547           TUS       3636              SAN   \n",
       "341344           WN        4547           TUS       3636              SAN   \n",
       "341345           WN        4547           TUS       3636              SAN   \n",
       "341346           WN        4547           TUS       3636              SAN   \n",
       "341347           WN        4547           TUS       3636              SAN   \n",
       "341348           WN        4547           TUS       3636              SAN   \n",
       "341349           WN        4547           TUS       3636              SAN   \n",
       "341350           WN        4547           TUS       3636              SAN   \n",
       "341351           WN        4547           TUS       3636              SAN   \n",
       "341352           WN        4547           TUS       3636              SAN   \n",
       "341353           WN        4547           TUS       3636              SAN   \n",
       "341354           WN        4547           TUS       3636              SAN   \n",
       "341355           WN        4547           TUS       3636              SAN   \n",
       "341356           WN        4547           TUS       3636              SAN   \n",
       "341357           WN        4547           TUS       3636              SAN   \n",
       "341358           WN        4547           TUS       3636              SAN   \n",
       "341359           WN        4547           TUS       3636              SAN   \n",
       "341360           WN        4547           TUS       3636              SAN   \n",
       "341361           WN        4547           TUS       3636              SAN   \n",
       "341362           WN        4547           TUS       3636              SAN   \n",
       "341363           WN        4547           TUS       3636              SAN   \n",
       "341364           WN        4547           TUS       3636              SAN   \n",
       "341365           WN        4547           TUS       3636              SAN   \n",
       "341366           WN        4547           TUS       3636              SAN   \n",
       "341367           WN        4547           TUS       3636              SAN   \n",
       "341368           WN        4547           TUS       3636              SAN   \n",
       "341369           WN        4547           TUS       3636              SAN   \n",
       "\n",
       "        target_id code_share  stops    equipment  YEAR  MONTH  DAY_OF_MONTH  \\\n",
       "0            3578                 0          CRJ  2018      1             2   \n",
       "1            3578                 0          CRJ  2018      1             7   \n",
       "2            3578                 0          CRJ  2018      1             8   \n",
       "3            3578                 0          CRJ  2018      1             9   \n",
       "4            3578                 0          CRJ  2018      1            10   \n",
       "5            3578                 0          CRJ  2018      1            11   \n",
       "6            3578                 0          CRJ  2018      1            12   \n",
       "7            3578                 0          CRJ  2018      1            15   \n",
       "8            3578                 0          CRJ  2018      1            16   \n",
       "9            3578                 0          CRJ  2018      1            17   \n",
       "10           3578                 0          CRJ  2018      1            18   \n",
       "11           3578                 0          CRJ  2018      1            19   \n",
       "12           3578                 0          CRJ  2018      1            21   \n",
       "13           3578                 0          CRJ  2018      1            22   \n",
       "14           3578                 0          CRJ  2018      1            23   \n",
       "15           3578                 0          CRJ  2018      1            24   \n",
       "16           3578                 0          CRJ  2018      1            25   \n",
       "17           3578                 0          CRJ  2018      1            26   \n",
       "18           3578                 0          CRJ  2018      1            28   \n",
       "19           3578                 0          CRJ  2018      1            29   \n",
       "20           3578                 0          CRJ  2018      1            30   \n",
       "21           3578                 0          CRJ  2018      1            31   \n",
       "22           3578                 0          CRJ  2018      1             1   \n",
       "23           3578                 0          CRJ  2018      1             2   \n",
       "24           3578                 0          CRJ  2018      1             7   \n",
       "25           3578                 0          CRJ  2018      1             8   \n",
       "26           3578                 0          CRJ  2018      1            11   \n",
       "27           3578                 0          CRJ  2018      1            12   \n",
       "28           3578                 0          CRJ  2018      1            15   \n",
       "29           3578                 0          CRJ  2018      1            18   \n",
       "...           ...        ...    ...          ...   ...    ...           ...   \n",
       "341340       3731                 0  73W 73C 733  2018      1            15   \n",
       "341341       3731                 0  73W 73C 733  2018      1            23   \n",
       "341342       3731                 0  73W 73C 733  2018      1            23   \n",
       "341343       3731                 0  73W 73C 733  2018      1            24   \n",
       "341344       3731                 0  73W 73C 733  2018      1            24   \n",
       "341345       3731                 0  73W 73C 733  2018      1            28   \n",
       "341346       3731                 0  73W 73C 733  2018      1            28   \n",
       "341347       3731                 0  73W 73C 733  2018      1            29   \n",
       "341348       3731                 0  73W 73C 733  2018      1            29   \n",
       "341349       3731                 0  73W 73C 733  2018      1             1   \n",
       "341350       3731                 0  73W 73C 733  2018      1             1   \n",
       "341351       3731                 0  73W 73C 733  2018      1             7   \n",
       "341352       3731                 0  73W 73C 733  2018      1             7   \n",
       "341353       3731                 0  73W 73C 733  2018      1             7   \n",
       "341354       3731                 0  73W 73C 733  2018      1             8   \n",
       "341355       3731                 0  73W 73C 733  2018      1             8   \n",
       "341356       3731                 0  73W 73C 733  2018      1            16   \n",
       "341357       3731                 0  73W 73C 733  2018      1            16   \n",
       "341358       3731                 0  73W 73C 733  2018      1            17   \n",
       "341359       3731                 0  73W 73C 733  2018      1            17   \n",
       "341360       3731                 0  73W 73C 733  2018      1            25   \n",
       "341361       3731                 0  73W 73C 733  2018      1            25   \n",
       "341362       3731                 0  73W 73C 733  2018      1             4   \n",
       "341363       3731                 0  73W 73C 733  2018      1             4   \n",
       "341364       3731                 0  73W 73C 733  2018      1            18   \n",
       "341365       3731                 0  73W 73C 733  2018      1            18   \n",
       "341366       3731                 0  73W 73C 733  2018      1            21   \n",
       "341367       3731                 0  73W 73C 733  2018      1            21   \n",
       "341368       3731                 0  73W 73C 733  2018      1            22   \n",
       "341369       3731                 0  73W 73C 733  2018      1            22   \n",
       "\n",
       "       CARRIER  FL_NUM ORIGIN DEST  ARR_DELAY_NEW  CANCELLED  \n",
       "0           9E    3316    ATL  CHA            0.0        0.0  \n",
       "1           9E    3333    ATL  CHA           90.0        0.0  \n",
       "2           9E    3333    ATL  CHA          108.0        0.0  \n",
       "3           9E    3333    ATL  CHA            2.0        0.0  \n",
       "4           9E    3333    ATL  CHA            0.0        0.0  \n",
       "5           9E    3333    ATL  CHA           52.0        0.0  \n",
       "6           9E    3333    ATL  CHA            NaN        0.0  \n",
       "7           9E    3333    ATL  CHA            0.0        0.0  \n",
       "8           9E    3333    ATL  CHA            0.0        0.0  \n",
       "9           9E    3333    ATL  CHA          143.0        0.0  \n",
       "10          9E    3333    ATL  CHA            0.0        0.0  \n",
       "11          9E    3333    ATL  CHA            0.0        0.0  \n",
       "12          9E    3333    ATL  CHA            0.0        0.0  \n",
       "13          9E    3333    ATL  CHA           38.0        0.0  \n",
       "14          9E    3333    ATL  CHA            0.0        0.0  \n",
       "15          9E    3333    ATL  CHA            0.0        0.0  \n",
       "16          9E    3333    ATL  CHA            0.0        0.0  \n",
       "17          9E    3333    ATL  CHA            0.0        0.0  \n",
       "18          9E    3333    ATL  CHA            7.0        0.0  \n",
       "19          9E    3333    ATL  CHA            0.0        0.0  \n",
       "20          9E    3333    ATL  CHA            0.0        0.0  \n",
       "21          9E    3333    ATL  CHA            0.0        0.0  \n",
       "22          9E    3382    ATL  CHA            0.0        0.0  \n",
       "23          9E    3407    ATL  CHA           45.0        0.0  \n",
       "24          9E    3628    ATL  CHA            0.0        0.0  \n",
       "25          9E    3628    ATL  CHA            0.0        0.0  \n",
       "26          9E    3628    ATL  CHA            0.0        0.0  \n",
       "27          9E    3628    ATL  CHA            0.0        0.0  \n",
       "28          9E    3628    ATL  CHA            4.0        0.0  \n",
       "29          9E    3628    ATL  CHA            0.0        0.0  \n",
       "...        ...     ...    ...  ...            ...        ...  \n",
       "341340      WN    1345    TUS  SAN            0.0        0.0  \n",
       "341341      WN     824    TUS  SAN            0.0        0.0  \n",
       "341342      WN    1345    TUS  SAN            0.0        0.0  \n",
       "341343      WN     824    TUS  SAN            0.0        0.0  \n",
       "341344      WN    1345    TUS  SAN            0.0        0.0  \n",
       "341345      WN    4381    TUS  SAN            0.0        0.0  \n",
       "341346      WN    4813    TUS  SAN            1.0        0.0  \n",
       "341347      WN     824    TUS  SAN            0.0        0.0  \n",
       "341348      WN    1345    TUS  SAN            0.0        0.0  \n",
       "341349      WN     768    TUS  SAN           29.0        0.0  \n",
       "341350      WN    1088    TUS  SAN            3.0        0.0  \n",
       "341351      WN    3763    TUS  SAN            0.0        0.0  \n",
       "341352      WN    4023    TUS  SAN            0.0        0.0  \n",
       "341353      WN    4524    TUS  SAN           38.0        0.0  \n",
       "341354      WN     824    TUS  SAN            1.0        0.0  \n",
       "341355      WN    6725    TUS  SAN           19.0        0.0  \n",
       "341356      WN     824    TUS  SAN            0.0        0.0  \n",
       "341357      WN    1345    TUS  SAN           25.0        0.0  \n",
       "341358      WN     824    TUS  SAN            0.0        0.0  \n",
       "341359      WN    1345    TUS  SAN           58.0        0.0  \n",
       "341360      WN     824    TUS  SAN            0.0        0.0  \n",
       "341361      WN    1345    TUS  SAN            0.0        0.0  \n",
       "341362      WN     768    TUS  SAN            0.0        0.0  \n",
       "341363      WN    1088    TUS  SAN            0.0        0.0  \n",
       "341364      WN     824    TUS  SAN           43.0        0.0  \n",
       "341365      WN    1345    TUS  SAN            0.0        0.0  \n",
       "341366      WN    4381    TUS  SAN            0.0        0.0  \n",
       "341367      WN    4813    TUS  SAN            0.0        0.0  \n",
       "341368      WN     824    TUS  SAN            0.0        0.0  \n",
       "341369      WN    1345    TUS  SAN            0.0        0.0  \n",
       "\n",
       "[341370 rows x 18 columns]"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# TODO: create joint DataFrame flights_s_df \n",
    "\n",
    "left_lst = list()\n",
    "right_lst = list()\n",
    "for (key, value) in mapping.items():\n",
    "    left_lst.append(key)\n",
    "    right_lst.append(value)\n",
    "\n",
    "flights_s_df = routes_df.merge(flights_df, left_on=left_lst, right_on=right_lst)\n",
    "\n",
    "flights_s_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "10d119e8acf7d5be3378d8c1a75ed68f",
     "grade": true,
     "grade_id": "cell-7a0b49a3abe243b9",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "if len(flights_s_df) != 341370:\n",
    "    raise ValueError(\"unexpected number of entries\")\n",
    "    \n",
    "if flights_s_df.shape[1] != 18:\n",
    "    raise ValueError(\"unexpected number of columns\")\n",
    "\n",
    "### BEGIN HIDDEN TESTS\n",
    "if sum(list(flights_s_df.airline_iata == 'WN')) != 95516:\n",
    "    raise ValueError(\"unexpected number of some airline_iata\")\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "65262166a11828462b05f5516740890a",
     "grade": true,
     "grade_id": "cell-f48df0f51ec58807",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "### BEGIN HIDDEN TESTS\n",
    "if sum(list(flights_s_df.ORIGIN == 'ATL')) != 23986:\n",
    "    raise ValueError(\"unexpected number of some origin\")\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "c481005c7e0c19af81b7531982c5a482",
     "grade": true,
     "grade_id": "cell-f1bcaea6946b06ea",
     "locked": true,
     "points": 1,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "### BEGIN HIDDEN TESTS\n",
    "if sum(list(flights_s_df.DEST == 'SAN')) != 5670:\n",
    "    raise ValueError(\"unexpected number of some destination\")\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "020be07ad763a5c25beea0bfa59bb33e",
     "grade": false,
     "grade_id": "cell-3cf9c41c0b0d300d",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "## 5.2.2 Grouped airline, destination, and flight"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "7f27c3111224368cdf98d5938b534434",
     "grade": false,
     "grade_id": "cell-2b05427cbcd945c6",
     "locked": false,
     "schema_version": 1,
     "solution": true
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>target_id</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>airline_iata</th>\n",
       "      <th>target_iata_icao</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"16\" valign=\"top\">9E</th>\n",
       "      <th>ATL</th>\n",
       "      <td>417</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TYS</th>\n",
       "      <td>133</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MSY</th>\n",
       "      <td>118</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CRW</th>\n",
       "      <td>82</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LGA</th>\n",
       "      <td>52</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LEX</th>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>EVV</th>\n",
       "      <td>47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CHA</th>\n",
       "      <td>40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>JFK</th>\n",
       "      <td>36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CID</th>\n",
       "      <td>30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>XNA</th>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DTW</th>\n",
       "      <td>27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ROA</th>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GSP</th>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GSO</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MSP</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"14\" valign=\"top\">AA</th>\n",
       "      <th>DFW</th>\n",
       "      <td>11166</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CLT</th>\n",
       "      <td>7696</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ORD</th>\n",
       "      <td>5114</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PHX</th>\n",
       "      <td>4765</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MIA</th>\n",
       "      <td>4282</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PHL</th>\n",
       "      <td>3719</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LAX</th>\n",
       "      <td>3007</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>BOS</th>\n",
       "      <td>2058</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DCA</th>\n",
       "      <td>1958</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LGA</th>\n",
       "      <td>1686</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MCO</th>\n",
       "      <td>1493</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>JFK</th>\n",
       "      <td>1338</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LAS</th>\n",
       "      <td>1211</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SFO</th>\n",
       "      <td>1119</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"30\" valign=\"top\">WN</th>\n",
       "      <th>TUS</th>\n",
       "      <td>342</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MHT</th>\n",
       "      <td>335</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ALB</th>\n",
       "      <td>333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>JAX</th>\n",
       "      <td>333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CLE</th>\n",
       "      <td>332</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SDF</th>\n",
       "      <td>330</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SJU</th>\n",
       "      <td>320</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>BOI</th>\n",
       "      <td>268</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GEG</th>\n",
       "      <td>268</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MAF</th>\n",
       "      <td>259</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PBI</th>\n",
       "      <td>241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ORF</th>\n",
       "      <td>231</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MEM</th>\n",
       "      <td>209</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LBB</th>\n",
       "      <td>203</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CHS</th>\n",
       "      <td>190</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CLT</th>\n",
       "      <td>174</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HRL</th>\n",
       "      <td>172</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ROC</th>\n",
       "      <td>154</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AMA</th>\n",
       "      <td>148</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LIT</th>\n",
       "      <td>127</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CRP</th>\n",
       "      <td>116</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GRR</th>\n",
       "      <td>101</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ECP</th>\n",
       "      <td>94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PNS</th>\n",
       "      <td>93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PWM</th>\n",
       "      <td>93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RIC</th>\n",
       "      <td>89</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>IAD</th>\n",
       "      <td>82</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DSM</th>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ICT</th>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>FNT</th>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>720 rows × 1 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                               target_id\n",
       "airline_iata target_iata_icao           \n",
       "9E           ATL                     417\n",
       "             TYS                     133\n",
       "             MSY                     118\n",
       "             CRW                      82\n",
       "             LGA                      52\n",
       "             LEX                      50\n",
       "             EVV                      47\n",
       "             CHA                      40\n",
       "             JFK                      36\n",
       "             CID                      30\n",
       "             XNA                      28\n",
       "             DTW                      27\n",
       "             ROA                      26\n",
       "             GSP                       4\n",
       "             GSO                       3\n",
       "             MSP                       1\n",
       "AA           DFW                   11166\n",
       "             CLT                    7696\n",
       "             ORD                    5114\n",
       "             PHX                    4765\n",
       "             MIA                    4282\n",
       "             PHL                    3719\n",
       "             LAX                    3007\n",
       "             BOS                    2058\n",
       "             DCA                    1958\n",
       "             LGA                    1686\n",
       "             MCO                    1493\n",
       "             JFK                    1338\n",
       "             LAS                    1211\n",
       "             SFO                    1119\n",
       "...                                  ...\n",
       "WN           TUS                     342\n",
       "             MHT                     335\n",
       "             ALB                     333\n",
       "             JAX                     333\n",
       "             CLE                     332\n",
       "             SDF                     330\n",
       "             SJU                     320\n",
       "             BOI                     268\n",
       "             GEG                     268\n",
       "             MAF                     259\n",
       "             PBI                     241\n",
       "             ORF                     231\n",
       "             MEM                     209\n",
       "             LBB                     203\n",
       "             CHS                     190\n",
       "             CLT                     174\n",
       "             HRL                     172\n",
       "             ROC                     154\n",
       "             AMA                     148\n",
       "             LIT                     127\n",
       "             CRP                     116\n",
       "             GRR                     101\n",
       "             ECP                      94\n",
       "             PNS                      93\n",
       "             PWM                      93\n",
       "             RIC                      89\n",
       "             IAD                      82\n",
       "             DSM                      31\n",
       "             ICT                      31\n",
       "             FNT                       7\n",
       "\n",
       "[720 rows x 1 columns]"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# TODO: output for each airline IATA code and destination city IATA code, the number of flights that appear in flights_s_df\n",
    "\n",
    "# YOUR CODE HERE\n",
    "grouped_df = flights_s_df.groupby(['airline_iata'])['target_iata_icao'].value_counts().to_frame('target_id')\n",
    "\n",
    "grouped_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "c9b21bca0c87d49b8c6797810fd74bb4",
     "grade": true,
     "grade_id": "cell-6c13ce23a980f6a1",
     "locked": true,
     "points": 4,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "#if not 'target_iata_icao' in grouped_df.columns:\n",
    "#    raise KeyError('airlines_delayed_cancelled should have a target_iata_icao')\n",
    "    \n",
    "if len(grouped_df) != 720:\n",
    "    raise ValueError(\"unexpected number of entries\")\n",
    "\n",
    "if grouped_df.shape[1] != 1:\n",
    "    raise ValueError(\"unexpected number of fields\")\n",
    "\n",
    "### BEGIN HIDDEN TESTS\n",
    "if not (grouped_df.loc['9E','ATL'] == 417).any() & \\\n",
    "       (grouped_df.loc['AA','ABQ'] == 139).any() & \\\n",
    "       (grouped_df.loc['WN','PIT'] == 710).any():\n",
    "    raise ValueError(\"Incorrect counts\")\n",
    "### END HIDDEN TESTS\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "4050896697f8797ffd10d10fa7f25d5f",
     "grade": false,
     "grade_id": "cell-1a8ffadc2a86838e",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "## Step 5.2.2: Delayed Flights by Airline and Destination\n",
    "\n",
    "Now let’s repeat the above, but only for flights that met a frustrating fate.\n",
    "\n",
    "For each airline IATA code and destination city IATA code, let's compute the number of flights that appear in the `flights_df`, whose arrival was delayed by 20 minutes or more, or which were cancelled (we’ll call this a “bad” flight in 5.2.3).  Assign this to `delayed_cancelled`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>target_id</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>airline_iata</th>\n",
       "      <th>target_iata_icao</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"15\" valign=\"top\">9E</th>\n",
       "      <th>ATL</th>\n",
       "      <td>74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MSY</th>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TYS</th>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LGA</th>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CRW</th>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>EVV</th>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>JFK</th>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LEX</th>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CHA</th>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ROA</th>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CID</th>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DTW</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GSP</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>XNA</th>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MSP</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"15\" valign=\"top\">AA</th>\n",
       "      <th>DFW</th>\n",
       "      <td>1219</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CLT</th>\n",
       "      <td>1014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PHX</th>\n",
       "      <td>876</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ORD</th>\n",
       "      <td>670</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PHL</th>\n",
       "      <td>625</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MIA</th>\n",
       "      <td>597</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>BOS</th>\n",
       "      <td>470</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LGA</th>\n",
       "      <td>367</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LAX</th>\n",
       "      <td>333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DCA</th>\n",
       "      <td>275</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>JFK</th>\n",
       "      <td>258</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MCO</th>\n",
       "      <td>240</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SFO</th>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TPA</th>\n",
       "      <td>162</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LAS</th>\n",
       "      <td>141</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"30\" valign=\"top\">WN</th>\n",
       "      <th>CHS</th>\n",
       "      <td>53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MHT</th>\n",
       "      <td>53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RNO</th>\n",
       "      <td>53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SDF</th>\n",
       "      <td>52</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ALB</th>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CLE</th>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>JAX</th>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TUL</th>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>BHM</th>\n",
       "      <td>47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TUS</th>\n",
       "      <td>45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ORF</th>\n",
       "      <td>44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MEM</th>\n",
       "      <td>34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MAF</th>\n",
       "      <td>33</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CLT</th>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HRL</th>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LBB</th>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AMA</th>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CRP</th>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>BOI</th>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ECP</th>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PNS</th>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ROC</th>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RIC</th>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GEG</th>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PWM</th>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LIT</th>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GRR</th>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>IAD</th>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ICT</th>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DSM</th>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>700 rows × 1 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                               target_id\n",
       "airline_iata target_iata_icao           \n",
       "9E           ATL                      74\n",
       "             MSY                      31\n",
       "             TYS                      18\n",
       "             LGA                      16\n",
       "             CRW                      14\n",
       "             EVV                      12\n",
       "             JFK                      11\n",
       "             LEX                      10\n",
       "             CHA                       7\n",
       "             ROA                       5\n",
       "             CID                       4\n",
       "             DTW                       3\n",
       "             GSP                       3\n",
       "             XNA                       3\n",
       "             MSP                       1\n",
       "AA           DFW                    1219\n",
       "             CLT                    1014\n",
       "             PHX                     876\n",
       "             ORD                     670\n",
       "             PHL                     625\n",
       "             MIA                     597\n",
       "             BOS                     470\n",
       "             LGA                     367\n",
       "             LAX                     333\n",
       "             DCA                     275\n",
       "             JFK                     258\n",
       "             MCO                     240\n",
       "             SFO                     204\n",
       "             TPA                     162\n",
       "             LAS                     141\n",
       "...                                  ...\n",
       "WN           CHS                      53\n",
       "             MHT                      53\n",
       "             RNO                      53\n",
       "             SDF                      52\n",
       "             ALB                      51\n",
       "             CLE                      50\n",
       "             JAX                      50\n",
       "             TUL                      49\n",
       "             BHM                      47\n",
       "             TUS                      45\n",
       "             ORF                      44\n",
       "             MEM                      34\n",
       "             MAF                      33\n",
       "             CLT                      31\n",
       "             HRL                      26\n",
       "             LBB                      19\n",
       "             AMA                      18\n",
       "             CRP                      18\n",
       "             BOI                      17\n",
       "             ECP                      16\n",
       "             PNS                      16\n",
       "             ROC                      15\n",
       "             RIC                      13\n",
       "             GEG                      12\n",
       "             PWM                      12\n",
       "             LIT                      11\n",
       "             GRR                       8\n",
       "             IAD                       7\n",
       "             ICT                       6\n",
       "             DSM                       5\n",
       "\n",
       "[700 rows x 1 columns]"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# TODO: output bad flights\n",
    "\n",
    "# YOUR CODE HERE\n",
    "flights_delayed = flights_s_df.loc[(flights_s_df['ARR_DELAY_NEW'] >= 20.0)] # greater than 20m delayed\n",
    "flights_cancelled = flights_s_df.loc[(flights_s_df['CANCELLED'] == 1)] # cancelled\n",
    "\n",
    "bad = flights_delayed.append(flights_cancelled)\n",
    "\n",
    "delayed_cancelled = bad.groupby(['airline_iata'])['target_iata_icao'].value_counts().to_frame('target_id')\n",
    "\n",
    "delayed_cancelled\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "a3fcb2e04471cc1080cc31d12afe3ae0",
     "grade": true,
     "grade_id": "cell-51d8cca077f2f84c",
     "locked": true,
     "points": 4,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "if not 'target_id' in delayed_cancelled.columns:\n",
    "    raise KeyError('airlines_delayed_cancelled should have a target_id')\n",
    "    \n",
    "if len(delayed_cancelled) != 700:\n",
    "    raise ValueError(\"unexpected number of entries\")\n",
    "\n",
    "if delayed_cancelled.shape[1] != 1:\n",
    "    raise ValueError(\"unexpected number of fields\")\n",
    "\n",
    "### BEGIN HIDDEN TESTS\n",
    "if not (delayed_cancelled.loc['9E','GSP'] == 3).any() & \\\n",
    "       (delayed_cancelled.loc['AA','ALB'] == 8).any() & \\\n",
    "       (delayed_cancelled.loc['WN','ONT'] == 115).any():\n",
    "    raise ValueError(\"Incorrect counts\")\n",
    "### END HIDDEN TESTS\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "0db39c9130e9e06c4c68f3239afbca35",
     "grade": false,
     "grade_id": "cell-91ee2fdd4ed34364",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "## Step 5.2.3: Route Pairs with Multiple Bad Flights\n",
    "\n",
    "Compute in the dataframe `multiple_bad` the number of “bad” flights for each (airline IATA code, destination city IATA code) pair if that pair has more than five “bad” flights. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {
    "collapsed": false,
    "nbgrader": {
     "checksum": "ba9ea24188e0bdad71c7f89ef7a47aaf",
     "grade": false,
     "grade_id": "cell-85238574d875adcf",
     "locked": false,
     "schema_version": 1,
     "solution": true
    },
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>target_id</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>airline_iata</th>\n",
       "      <th>target_iata_icao</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"9\" valign=\"top\">9E</th>\n",
       "      <th>ATL</th>\n",
       "      <td>74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MSY</th>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TYS</th>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LGA</th>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CRW</th>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>EVV</th>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>JFK</th>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LEX</th>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CHA</th>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"21\" valign=\"top\">AA</th>\n",
       "      <th>DFW</th>\n",
       "      <td>1219</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CLT</th>\n",
       "      <td>1014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PHX</th>\n",
       "      <td>876</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ORD</th>\n",
       "      <td>670</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PHL</th>\n",
       "      <td>625</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MIA</th>\n",
       "      <td>597</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>BOS</th>\n",
       "      <td>470</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LGA</th>\n",
       "      <td>367</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LAX</th>\n",
       "      <td>333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DCA</th>\n",
       "      <td>275</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>JFK</th>\n",
       "      <td>258</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MCO</th>\n",
       "      <td>240</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SFO</th>\n",
       "      <td>204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TPA</th>\n",
       "      <td>162</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LAS</th>\n",
       "      <td>141</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>EWR</th>\n",
       "      <td>134</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ATL</th>\n",
       "      <td>127</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RDU</th>\n",
       "      <td>122</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DEN</th>\n",
       "      <td>120</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SEA</th>\n",
       "      <td>110</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>FLL</th>\n",
       "      <td>109</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"30\" valign=\"top\">WN</th>\n",
       "      <th>PBI</th>\n",
       "      <td>54</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CHS</th>\n",
       "      <td>53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MHT</th>\n",
       "      <td>53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RNO</th>\n",
       "      <td>53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SDF</th>\n",
       "      <td>52</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ALB</th>\n",
       "      <td>51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CLE</th>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>JAX</th>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TUL</th>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>BHM</th>\n",
       "      <td>47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TUS</th>\n",
       "      <td>45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ORF</th>\n",
       "      <td>44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MEM</th>\n",
       "      <td>34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MAF</th>\n",
       "      <td>33</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CLT</th>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HRL</th>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LBB</th>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AMA</th>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CRP</th>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>BOI</th>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ECP</th>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PNS</th>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ROC</th>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RIC</th>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GEG</th>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PWM</th>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LIT</th>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GRR</th>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>IAD</th>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ICT</th>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>547 rows × 1 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                               target_id\n",
       "airline_iata target_iata_icao           \n",
       "9E           ATL                      74\n",
       "             MSY                      31\n",
       "             TYS                      18\n",
       "             LGA                      16\n",
       "             CRW                      14\n",
       "             EVV                      12\n",
       "             JFK                      11\n",
       "             LEX                      10\n",
       "             CHA                       7\n",
       "AA           DFW                    1219\n",
       "             CLT                    1014\n",
       "             PHX                     876\n",
       "             ORD                     670\n",
       "             PHL                     625\n",
       "             MIA                     597\n",
       "             BOS                     470\n",
       "             LGA                     367\n",
       "             LAX                     333\n",
       "             DCA                     275\n",
       "             JFK                     258\n",
       "             MCO                     240\n",
       "             SFO                     204\n",
       "             TPA                     162\n",
       "             LAS                     141\n",
       "             EWR                     134\n",
       "             ATL                     127\n",
       "             RDU                     122\n",
       "             DEN                     120\n",
       "             SEA                     110\n",
       "             FLL                     109\n",
       "...                                  ...\n",
       "WN           PBI                      54\n",
       "             CHS                      53\n",
       "             MHT                      53\n",
       "             RNO                      53\n",
       "             SDF                      52\n",
       "             ALB                      51\n",
       "             CLE                      50\n",
       "             JAX                      50\n",
       "             TUL                      49\n",
       "             BHM                      47\n",
       "             TUS                      45\n",
       "             ORF                      44\n",
       "             MEM                      34\n",
       "             MAF                      33\n",
       "             CLT                      31\n",
       "             HRL                      26\n",
       "             LBB                      19\n",
       "             AMA                      18\n",
       "             CRP                      18\n",
       "             BOI                      17\n",
       "             ECP                      16\n",
       "             PNS                      16\n",
       "             ROC                      15\n",
       "             RIC                      13\n",
       "             GEG                      12\n",
       "             PWM                      12\n",
       "             LIT                      11\n",
       "             GRR                       8\n",
       "             IAD                       7\n",
       "             ICT                       6\n",
       "\n",
       "[547 rows x 1 columns]"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# TODO: pairs with more than five bad flights\n",
    "\n",
    "# YOUR CODE HERE\n",
    "multiple_bad = delayed_cancelled[delayed_cancelled['target_id']>5]\n",
    "\n",
    "multiple_bad"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "ae1f889af7d655e3d4b9e957adc1f92f",
     "grade": true,
     "grade_id": "cell-a5cdf9dadcb4f564",
     "locked": true,
     "points": 2,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "if not 'target_id' in multiple_bad.columns:\n",
    "    raise KeyError('airlines_delayed_cancelled should have a target_id')\n",
    "    \n",
    "if len(multiple_bad) != 547:\n",
    "    raise ValueError(\"unexpected number of entries\")\n",
    "\n",
    "if multiple_bad.shape[1] != 1:\n",
    "    raise ValueError(\"unexpected number of fields\")\n",
    "\n",
    "### BEGIN HIDDEN TESTS\n",
    "if not (multiple_bad.loc['9E','EVV'] == 12).any() & \\\n",
    "       (multiple_bad.loc['AA','AUS'] == 99).any() & \\\n",
    "       (multiple_bad.loc['WN','PHL'] == 138).any():\n",
    "    raise ValueError(\"Incorrect counts\")\n",
    "### END HIDDEN TESTS"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "nbgrader": {
     "checksum": "2688d5f0b4fe7950cd66acba5bdfd090",
     "grade": false,
     "grade_id": "cell-2514b6eb4c802258",
     "locked": true,
     "schema_version": 1,
     "solution": false
    }
   },
   "source": [
    "## Step 5.2.4:Multiply Delayed Flights by Airline\n",
    "\n",
    "What if we re-examine the above question, but by airline instead of by city?  Compute that as `airlines_delayed_cancelled`.  \n",
    "\n",
    "It should contain, for each airline IATA code, the number of flights that appear in `flights_s_df`, whose arrival was delayed by 30 minutes or more, or which were cancelled.  **Sort** by number of delays/cancellations in decreasing order.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [],
   "source": [
    "# TODO: delayed flights by airline\n",
    "\n",
    "# YOUR CODE HERE\n",
    "flights_delayed = flights_s_df.loc[(flights_s_df['ARR_DELAY_NEW'] >= 30.0)] # delayed 30m or more\n",
    "flights_cancelled = flights_s_df.loc[(flights_s_df['CANCELLED'] == 1)] # cancelled\n",
    "\n",
    "bad = flights_delayed.append(flights_cancelled)\n",
    "\n",
    "airlines_delayed_cancelled = bad['airline_iata'].value_counts().rename_axis('airline_iata').to_frame('target_id').sort_values('target_id',ascending=False)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {
    "collapsed": true,
    "nbgrader": {
     "checksum": "53b858230c118264c69a4d61633b2ad5",
     "grade": true,
     "grade_id": "cell-5046925db315374f",
     "locked": true,
     "points": 5,
     "schema_version": 1,
     "solution": false
    }
   },
   "outputs": [],
   "source": [
    "if not 'target_id' in airlines_delayed_cancelled.columns:\n",
    "    raise KeyError('airlines_delayed_cancelled should have a target_id')\n",
    "\n",
    "if len(airlines_delayed_cancelled) != 12:\n",
    "    raise ValueError(\"unexpected number of entries\")\n",
    "\n",
    "if airlines_delayed_cancelled.shape[1] != 1:\n",
    "    raise ValueError(\"unexpected number of fields\")\n",
    "\n",
    "### BEGIN HIDDEN TESTS\n",
    "if not (airlines_delayed_cancelled.loc['9E'] == 183).any() & \\\n",
    "       (airlines_delayed_cancelled.loc['G4'] == 538).any() & \\\n",
    "       (airlines_delayed_cancelled.loc['WN'] == 10362).any():    \n",
    "    raise ValueError(\"Incorrect counts\")\n",
    "### END HIDDEN TESTS\n"
   ]
  }
 ],
 "metadata": {
  "anaconda-cloud": {},
  "celltoolbar": "Create Assignment",
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.5.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
